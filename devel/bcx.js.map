{"version":3,"file":"bcx.js","sources":["../src/utilsClub.ts","../src/config.ts","../src/utils.ts","../src/patching.ts","../src/modules/_BaseModule.ts","../src/constants.ts","../src/resources.ts","../src/modules/chatroom.ts","../src/modules/storage.ts","../src/modules/log.ts","../src/modules/authority.ts","../src/modules/curses.ts","../src/characters.ts","../src/modules/messaging.ts","../src/gui/subscreen.ts","../src/gui/authority_roles.ts","../src/gui/authority_dialogMin.ts","../src/gui/authority_dialogSelf.ts","../src/gui/authority_permissions.ts","../src/gui/global_dialogClearData.ts","../src/gui/global_moduleToggling.ts","../src/gui/global.ts","../src/gui/log_config.ts","../src/gui/log.ts","../src/gui/curses_add.ts","../src/gui/curses.ts","../src/modules/miscPatches.ts","../src/gui/misc.ts","../src/gui/mainmenu.ts","../src/gui/welcome.ts","../src/modules/gui.ts","../src/modules/presets.ts","../src/moduleManager.ts","../src/main.ts","../src/modules/wardrobe.ts","../src/modules/console.ts","../src/modules/commands.ts","../src/modules/clubUtils.ts","../src/modules/versionCheck.ts","../src/modules.ts","../src/index.ts"],"sourcesContent":["const GROUP_NAME_OVERRIDES: Record<string, string> = {\n\t\"ItemNeckAccessories\": \"Collar Addon\",\n\t\"ItemNeckRestraints\": \"Collar Restraint\",\n\t\"ItemNipplesPiercings\": \"Nipple Piercing\",\n\t\"ItemHood\": \"Hood\",\n\t\"ItemMisc\": \"Miscellaneous\",\n\t\"ItemDevices\": \"Devices\",\n\t\"ItemHoodAddon\": \"Hood Addon\",\n\t\"ItemAddon\": \"General Addon\",\n\t\"ItemFeet\": \"Upper Leg\",\n\t\"ItemLegs\": \"Lower Leg\",\n\t\"ItemBoots\": \"Feet\",\n\t\"ItemMouth\": \"Mouth (1)\",\n\t\"ItemMouth2\": \"Mouth (2)\",\n\t\"ItemMouth3\": \"Mouth (3)\"\n};\n\nexport let allowMode: boolean = false;\nexport let developmentMode: boolean = false;\n\nexport function setAllowMode(allow: boolean): boolean {\n\tif (allow) {\n\t\tconsole.warn(\"Cheats enabled; please be careful not to break things\");\n\t} else {\n\t\tif (!setDevelopmentMode(false))\n\t\t\treturn false;\n\t\tconsole.info(\"Cheats disabled\");\n\t}\n\tallowMode = allow;\n\treturn true;\n}\n\nexport function setDevelopmentMode(devel: boolean): boolean {\n\tif (devel) {\n\t\tif (!setAllowMode(true)) {\n\t\t\tconsole.info(\"To use developer mode, cheats must be enabled first!\");\n\t\t\treturn false;\n\t\t}\n\t\tAssetGroup.forEach(G => G.Description = G.Name);\n\t\tAsset.forEach(A => A.Description = A.Group.Name + \":\" + A.Name);\n\t\tBackgroundSelectionAll.forEach(B => {\n\t\t\tB.Description = B.Name;\n\t\t\tB.Low = B.Description.toLowerCase();\n\t\t});\n\t\tconsole.warn(\"Developer mode enabled\");\n\t} else {\n\t\tAssetLoadDescription(\"Female3DCG\");\n\t\tBackgroundSelectionAll.forEach(B => {\n\t\t\tB.Description = DialogFindPlayer(B.Name);\n\t\t\tB.Low = B.Description.toLowerCase();\n\t\t});\n\t\tconsole.info(\"Developer mode disabled\");\n\t}\n\tdevelopmentMode = devel;\n\treturn true;\n}\n\nexport function getVisibleGroupName(group: AssetGroup): string {\n\treturn developmentMode ? group.Name : (GROUP_NAME_OVERRIDES[group.Name] ?? group.Description);\n}\n\nexport function InfoBeep(msg: string, timer: number = 3000) {\n\tconsole.log(`BCX msg: ${msg}`);\n\tServerBeep = {\n\t\tTimer: Date.now() + timer,\n\t\tMessage: msg\n\t};\n}\n\nexport function ChatRoomActionMessage(msg: string) {\n\tif (!msg) return;\n\tServerSend(\"ChatRoomChat\", {\n\t\tContent: \"Beep\",\n\t\tType: \"Action\",\n\t\tDictionary: [\n\t\t\t{ Tag: \"Beep\", Text: \"msg\" },\n\t\t\t{ Tag: \"Biep\", Text: \"msg\" },\n\t\t\t{ Tag: \"Sonner\", Text: \"msg\" },\n\t\t\t{ Tag: \"msg\", Text: msg }\n\t\t]\n\t});\n}\n\nexport function ChatRoomSendLocal(msg: string | Node, timeout?: number, sender?: number) {\n\t// Adds the message and scrolls down unless the user has scrolled up\n\tconst div = document.createElement(\"div\");\n\tdiv.setAttribute(\"class\", \"ChatMessage ChatMessageLocalMessage\");\n\tdiv.setAttribute(\"data-time\", ChatRoomCurrentTime());\n\tdiv.setAttribute('data-sender', `${sender ?? Player.MemberNumber ?? 0}`);\n\tdiv.style.background = \"#6e6eff54\";\n\n\tif (typeof msg === 'string')\n\t\tdiv.innerText = msg;\n\telse\n\t\tdiv.appendChild(msg);\n\n\tif (timeout) setTimeout(() => div.remove(), timeout);\n\n\t// Returns the focus on the chat box\n\tconst Refocus = document.activeElement?.id === \"InputChat\";\n\tconst ShouldScrollDown = ElementIsScrolledToEnd(\"TextAreaChatLog\");\n\tconst ChatLog = document.getElementById(\"TextAreaChatLog\");\n\tif (ChatLog != null) {\n\t\tChatLog.appendChild(div);\n\t\tif (ShouldScrollDown) ElementScrollToEnd(\"TextAreaChatLog\");\n\t\tif (Refocus) ElementFocus(\"InputChat\");\n\t}\n}\n\nexport function detectOtherMods() {\n\tconst w = window as any;\n\treturn {\n\t\tNMod: typeof w.ChatRoomDrawFriendList === \"function\",\n\t\tBondageClubTools: ServerSocket.listeners(\"ChatRoomMessage\").some(i => i.toString().includes(\"window.postMessage\"))\n\t};\n}\n\n/**\n * Draws an image on canvas, applying all options\n * @param {string | HTMLImageElement | HTMLCanvasElement} Source - URL of image or image itself\n * @param {number} X - Position of the image on the X axis\n * @param {number} Y - Position of the image on the Y axis\n * @param {object} [options] - any extra options, optional\n * @param {CanvasRenderingContext2D} [options.Canvas] - Canvas on which to draw the image, defaults to `MainCanvas`\n * @param {number} [options.Alpha] - transparency between 0-1\n * @param {[number, number, number, number]} [options.SourcePos] - Area in original image to draw in format `[left, top, width, height]`\n * @param {number} [options.Width] - Width of the drawn image, defaults to width of original image\n * @param {number} [options.Height] - Height of the drawn image, defaults to height of original image\n * @param {boolean} [options.Invert=false] - If image should be flipped vertically\n * @param {boolean} [options.Mirror=false] - If image should be flipped horizontally\n * @param {number} [options.Zoom=1] - Zoom factor\n * @returns {boolean} - whether the image was complete or not\n */\nexport function DrawImageEx(\n\tSource: string | HTMLImageElement | HTMLCanvasElement,\n\tX: number,\n\tY: number,\n\t{\n\t\tCanvas = MainCanvas,\n\t\tAlpha = 1,\n\t\tSourcePos,\n\t\tWidth,\n\t\tHeight,\n\t\tInvert = false,\n\t\tMirror = false,\n\t\tZoom = 1\n\t}: {\n\t\tCanvas?: CanvasRenderingContext2D;\n\t\tAlpha?: number;\n\t\tSourcePos?: [number, number, number, number];\n\t\tWidth?: number;\n\t\tHeight?: number;\n\t\tInvert?: boolean;\n\t\tMirror?: boolean;\n\t\tZoom?: number;\n\t} = {}\n) {\n\tif (typeof Source === \"string\") {\n\t\tSource = DrawGetImage(Source);\n\t\tif (!Source.complete) return false;\n\t\tif (!Source.naturalWidth) return true;\n\t}\n\n\tconst sizeChanged = Width != null || Height != null;\n\tif (Width == null) {\n\t\tWidth = SourcePos ? SourcePos[2] : Source.width;\n\t}\n\tif (Height == null) {\n\t\tHeight = SourcePos ? SourcePos[3] : Source.height;\n\t}\n\n\tCanvas.save();\n\n\tCanvas.globalCompositeOperation = \"source-over\";\n\tCanvas.globalAlpha = Alpha;\n\tCanvas.translate(X, Y);\n\n\tif (Zoom !== 1) {\n\t\tCanvas.scale(Zoom, Zoom);\n\t}\n\n\tif (Invert) {\n\t\tCanvas.transform(1, 0, 0, -1, 0, Height);\n\t}\n\n\tif (Mirror) {\n\t\tCanvas.transform(-1, 0, 0, 1, Width, 0);\n\t}\n\n\tif (SourcePos) {\n\t\tCanvas.drawImage(Source, SourcePos[0], SourcePos[1], SourcePos[2], SourcePos[3], 0, 0, Width, Height);\n\t} else if (sizeChanged) {\n\t\tCanvas.drawImage(Source, 0, 0, Width, Height);\n\t} else {\n\t\tCanvas.drawImage(Source, 0, 0);\n\t}\n\n\tCanvas.restore();\n\treturn true;\n}\n\nexport function isCloth(item: Item | Asset, allowCosplay: boolean = false): boolean {\n\tconst asset = (item as any).Asset ? (item as Item).Asset : item as Asset;\n\treturn asset.Group.Category === \"Appearance\" && asset.Group.AllowNone && asset.Group.Clothing && (allowCosplay || !asset.Group.BodyCosplay);\n}\n\nexport function isBind(item: Item | Asset): boolean {\n\tconst asset = (item as any).Asset ? (item as Item).Asset : item as Asset;\n\tif (asset.Group.Category !== \"Item\" || asset.Group.BodyCosplay) return false;\n\treturn ![\"ItemNeck\", \"ItemNeckAccessories\", \"ItemNeckRestraints\"].includes(asset.Group.Name);\n}\n","export const VERSION = \"0.3.0\";\n\nexport const VERSION_CHECK_BOT: number = 37685;\n\nexport const FUNCTION_HASHES: Record<string, string[]> = {\n\tActivityOrgasmStart: [\"5C3627D7\", \"1F7E8FF9\"],\n\tAppearanceClick: [\"48FA3705\", \"BA17EA90\", \"F0B11F43\"],\n\tAppearanceRun: [\"904E8E84\", \"45C6BA53\", \"6D5EFEAA\"],\n\tAsylumEntranceCanWander: [\"3F5F4041\", \"609FA096\"],\n\tChatRoomCanLeave: [\"5BEE6F9D\", \"77FB6CF8\"],\n\tChatRoomClearAllElements: [\"D1E1F8C3\", \"D9169281\", \"AFB1B3ED\"],\n\tChatRoomCreateElement: [\"4837C2F6\", \"6C4CCF41\", \"35D54383\"],\n\tChatRoomDrawCharacterOverlay: [\"D58A9AD3\"],\n\tChatRoomKeyDown: [\"5FD37EC9\", \"111B6F0C\"],\n\tChatRoomMessage: [\"2C6E4EC3\", \"4340BC41\", \"6026A4B6\"],\n\tChatRoomSendChat: [\"39B06D87\", \"9019F7EF\", \"D64CCA1D\"],\n\tChatRoomSync: [\"B67D8226\"],\n\tCheatFactor: [\"594CFC45\"],\n\tCheatImport: [\"412422CC\", \"26C67608\"],\n\tDialogDrawExpressionMenu: [\"EEFB3D22\"],\n\tDialogDrawItemMenu: [\"7B1D71E9\", \"0199F25B\", \"D832A940\"],\n\tDialogDrawPoseMenu: [\"4B146E82\"],\n\tElementIsScrolledToEnd: [\"D28B0638\"],\n\tExtendedItemDraw: [\"486A52DF\", \"9256549A\", \"45432E84\", \"455F5FDD\"],\n\tInformationSheetClick: [\"E535609B\"],\n\tInformationSheetExit: [\"75521907\"],\n\tInformationSheetRun: [\"58B7879C\", \"A8A56ACA\"],\n\tLoginMistressItems: [\"B58EF410\"],\n\tLoginResponse: [\"16C2C651\", \"FA9EFD03\", \"02E9D246\", \"548405C8\"],\n\tLoginStableItems: [\"EA93FBF7\"],\n\tPrivateRansomStart: [\"0E968EDD\"],\n\tServerAccountBeep: [\"2D918B69\"],\n\tSpeechGarble: [\"1BC8E005\", \"15C3B50B\", \"9D669F73\"],\n\tValidationResolveModifyDiff: [\"C2FE52D3\"]\n};\n\nexport const FUNCTION_HASHES_NMOD: Record<string, string[]> = {\n\tActivityOrgasmStart: [\"1F7E8FF9\"],\n\tAppearanceClick: [\"B895612C\"],\n\tAppearanceRun: [\"791E142F\"],\n\tAsylumEntranceCanWander: [\"609FA096\"],\n\tChatRoomCanLeave: [\"7EDA9A86\"],\n\tChatRoomClearAllElements: [\"904C924D\"],\n\tChatRoomCreateElement: [\"76299AEC\"],\n\tChatRoomDrawFriendList: [\"327DA1B8\"],\n\tChatRoomKeyDown: [\"9C7E973D\"],\n\tChatRoomMessage: [\"477574F9\"],\n\tChatRoomSendChat: [\"385B9E9C\"],\n\tChatRoomSync: [\"2590802E\"],\n\tCheatFactor: [\"594CFC45\"],\n\tCheatImport: [\"1ECB0CC4\"],\n\tDialogDrawExpressionMenu: [\"EEFB3D22\"],\n\tDialogDrawItemMenu: [\"05301080\"],\n\tDialogDrawPoseMenu: [\"4B146E82\"],\n\tElementIsScrolledToEnd: [\"D28B0638\"],\n\tExtendedItemDraw: [\"455F5FDD\"],\n\tInformationSheetClick: [\"E535609B\"],\n\tInformationSheetExit: [\"75521907\"],\n\tInformationSheetRun: [\"19872251\"],\n\tLoginMistressItems: [\"984A6AD9\"],\n\tLoginResponse: [\"67294772\"],\n\tLoginStableItems: [\"C3F50DD1\"],\n\tPrivateRansomStart: [\"0E968EDD\"],\n\tServerAccountBeep: [\"A6DFD3B9\"],\n\tSpeechGarble: [\"9D669F73\"],\n\tValidationResolveModifyDiff: [\"C2FE52D3\"]\n};\n","\nconst encoder = new TextEncoder();\n\n/* eslint-disable no-bitwise */\nexport function crc32(str: string): string {\n\tlet crc = 0 ^ -1;\n\tfor (const b of encoder.encode(str)) {\n\t\tlet c = (crc ^ b) & 0xff;\n\t\tfor (let j = 0; j < 8; j++) {\n\t\t\tc = (c & 1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1);\n\t\t}\n\t\tcrc = (crc >>> 8) ^ c;\n\t}\n\n\treturn ((crc ^ -1) >>> 0).toString(16).padStart(8, \"0\").toUpperCase();\n}\n/* eslint-enable no-bitwise */\n\n/** Utility function to add CSS */\nexport function addStyle(styleString: string): void {\n\tconst style = document.createElement(\"style\");\n\tstyle.textContent = styleString;\n\tdocument.head.append(style);\n}\n\n/**\n * Waits for set amount of time, returning promes\n * @param ms The time in ms to wait for\n */\nexport function wait(ms: number): Promise<void> {\n\treturn new Promise(r => setTimeout(r, ms));\n}\n\n/** Checks if the `obj` is an object (not null, not array) */\nexport function isObject(obj: unknown): obj is Record<string, any> {\n\treturn !!obj && typeof obj === \"object\" && !Array.isArray(obj);\n}\n\nexport function longestCommonPrefix(strings: string[]): string {\n\tif (strings.length === 0) return \"\";\n\n\tstrings = strings.slice().sort();\n\tlet i = 0;\n\twhile (i < strings[0].length && strings[0][i] === strings[strings.length - 1][i]) {\n\t\ti++;\n\t}\n\treturn strings[0].substring(0, i);\n}\n\nexport function arrayUnique<T>(arr: T[]): T[] {\n\tconst seen = new Set<T>();\n\treturn arr.filter(i => !seen.has(i) && seen.add(i));\n}\n\nexport function capitalizeFirstLetter(str: string): string {\n\treturn str.charAt(0).toLocaleUpperCase() + str.slice(1);\n}\n\n/* eslint-disable no-bitwise */\nexport function uuidv4() {\n\treturn \"10000000-1000-4000-8000-100000000000\".replace(/[018]/g, (c: any) =>\n\t\t(c ^ (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))).toString(16)\n\t);\n}\n/* eslint-enable no-bitwise */\n\nexport const clipboardAvailable = Boolean(navigator.clipboard);\n\n/** Clamp number between two values */\nexport function clamp(value: number, min: number, max: number) {\n\treturn Math.min(Math.max(value, min), max);\n}\n","import { FUNCTION_HASHES, FUNCTION_HASHES_NMOD } from \"./config\";\nimport { ModuleCategory } from \"./constants\";\nimport { crc32 } from \"./utils\";\nimport { detectOtherMods } from \"./utilsClub\";\n\ntype PatchHook = (args: any[], next: (args: any[]) => any) => any;\n\ninterface IpatchedFunctionData {\n\toriginal: (...args: any[]) => any;\n\tfinal: (...args: any[]) => any;\n\thooks: {\n\t\thook: PatchHook;\n\t\tpriority: number;\n\t\tmodule: ModuleCategory | null;\n\t}[];\n\tpatches: Record<string, string>;\n}\n\nconst patchedFunctions: Map<string, IpatchedFunctionData> = new Map();\nlet unloaded: boolean = false;\n\n\nfunction makePatchRouter(data: IpatchedFunctionData): (...args: any[]) => any {\n\treturn (...args: any[]) => {\n\t\tif (unloaded) {\n\t\t\tconsole.warn(`BCX: Function router called while unloaded for ${data.original.name}`);\n\t\t\treturn data.original(...args);\n\t\t}\n\t\tconst hooks = data.hooks.slice();\n\t\tlet hookIndex = 0;\n\t\tconst callNextHook = (nextargs: any[]) => {\n\t\t\tif (hookIndex < hooks.length) {\n\t\t\t\thookIndex++;\n\t\t\t\treturn hooks[hookIndex - 1].hook(nextargs, callNextHook);\n\t\t\t} else {\n\t\t\t\treturn data.final(...args);\n\t\t\t}\n\t\t};\n\t\treturn callNextHook(args);\n\t};\n}\n\nfunction initPatchableFunction(target: string): IpatchedFunctionData {\n\tif (unloaded) {\n\t\tthrow new Error(\"Cannot init patchable function after unload\");\n\t}\n\tlet result = patchedFunctions.get(target);\n\tif (!result) {\n\t\tconst original = (window as any)[target] as (...args: any[]) => any;\n\n\t\tconst { NMod } = detectOtherMods();\n\n\t\tconst expectedHashes = (NMod ? FUNCTION_HASHES_NMOD : FUNCTION_HASHES)[target] ?? [];\n\n\t\tif (typeof original !== \"function\") {\n\t\t\tthrow new Error(`BCX: Function ${target} to be patched not found`);\n\t\t}\n\n\t\tconst hash = crc32(original.toString().replaceAll(\"\\r\\n\", \"\\n\"));\n\t\tif (!expectedHashes.includes(hash)) {\n\t\t\tconsole.warn(`BCX: Patched function ${target} has unknown hash ${hash}`);\n\t\t}\n\t\tconsole.debug(`BCX: Initialized ${target} for patching`);\n\n\t\tresult = {\n\t\t\toriginal,\n\t\t\tfinal: original,\n\t\t\thooks: [],\n\t\t\tpatches: {}\n\t\t};\n\t\tpatchedFunctions.set(target, result);\n\t\t(window as any)[target] = makePatchRouter(result);\n\t}\n\treturn result;\n}\n\nfunction applyPatches(info: IpatchedFunctionData) {\n\tif (Object.keys(info.patches).length === 0) {\n\t\tinfo.final = info.original;\n\t\treturn;\n\t}\n\tlet fn_str = info.original.toString();\n\tconst N = `BCX: Patching ${info.original.name}`;\n\tfor (const k of Object.keys(info.patches)) {\n\t\tif (!fn_str.includes(k)) {\n\t\t\tconsole.warn(`${N}: Patch ${k} not applied`);\n\t\t}\n\t\tfn_str = fn_str.replaceAll(k, info.patches[k]);\n\t}\n\t// eslint-disable-next-line no-eval\n\tinfo.final = eval(`(${fn_str})`);\n}\n\nexport function hookFunction(target: string, priority: number, hook: PatchHook, module: ModuleCategory | null = null): void {\n\tconst data = initPatchableFunction(target);\n\n\tif (data.hooks.some(h => h.hook === hook)) {\n\t\tconsole.error(`BCX: Duplicate hook for \"${target}\"`, hook);\n\t\treturn;\n\t}\n\n\tdata.hooks.push({\n\t\thook,\n\t\tpriority,\n\t\tmodule\n\t});\n\tdata.hooks.sort((a, b) => b.priority - a.priority);\n}\n\nexport function removeHooksByModule(target: string, module: ModuleCategory): boolean {\n\tconst data = initPatchableFunction(target);\n\n\tfor (let i = data.hooks.length - 1; i >= 0; i--) {\n\t\tif (data.hooks[i].module === module) {\n\t\t\tdata.hooks.splice(i, 1);\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport function patchFunction(target: string, patches: Record<string, string>): void {\n\tconst data = initPatchableFunction(target);\n\tObject.assign(data.patches, patches);\n\tapplyPatches(data);\n}\n\nexport function unload_patches() {\n\tunloaded = true;\n\tfor (const [k, v] of patchedFunctions.entries()) {\n\t\tv.hooks = [];\n\t\tv.patches = {};\n\t\tv.final = v.original;\n\t\t(window as any)[k] = v.original;\n\t}\n\tpatchedFunctions.clear();\n}\n","import type { Preset } from \"../constants\";\n\nexport abstract class BaseModule {\n\n\tinit() {\n\t\t// Empty\n\t}\n\n\tload(preset: Preset) {\n\t\t// Empty\n\t}\n\n\trun() {\n\t\t// Empty\n\t}\n\n\tunload() {\n\t\t// Empty\n\t}\n\n\treload(preset: Preset) {\n\t\t// Empty\n\t}\n\n\tapplyPreset(preset: Preset) {\n\t\t// Empty\n\t}\n}\n","export enum Preset {\n\tdominant = 0,\n\tswitch = 1,\n\tsubmissive = 2,\n\tslave = 3\n}\n\nexport enum ModuleCategory {\n\tBasic = 0,\n\tAuthority = 1,\n\tLog = 2,\n\tCurses = 3,\n\tMisc = 99\n}\n\nexport const MODULE_NAMES: Record<ModuleCategory, string> = {\n\t[ModuleCategory.Basic]: \"Basic\",\n\t[ModuleCategory.Authority]: \"Authority\",\n\t[ModuleCategory.Log]: \"Behaviour Log\",\n\t[ModuleCategory.Curses]: \"Curses\",\n\t[ModuleCategory.Misc]: \"Miscellaneous\"\n};\n\nexport const MODULE_ICONS: Record<ModuleCategory, string> = {\n\t[ModuleCategory.Basic]: \"Icons/General.png\",\n\t[ModuleCategory.Authority]: \"Icons/Security.png\",\n\t[ModuleCategory.Log]: \"Icons/Title.png\",\n\t[ModuleCategory.Curses]: \"Icons/Struggle.png\",\n\t[ModuleCategory.Misc]: \"Icons/Random.png\"\n};\n\nexport const TOGGLEABLE_MODULES: readonly ModuleCategory[] = [\n\tModuleCategory.Log,\n\tModuleCategory.Curses\n];\n\nexport const enum ModuleInitPhase {\n\tconstruct,\n\tinit,\n\tload,\n\tready,\n\tdestroy\n}\n\nexport enum MiscCheat {\n\tBlockRandomKidnap = 0,\n\tCantLoseMistress = 1\n}\n","export const icon_Emote = `data:image/png;base64,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`;\n\nexport const icon_Typing = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABmJLR0QA/wD/AP+gvaeTAAALWUlEQVRo3tVZe2xT1xn/nXPu9b22Yzt2sGPSeF2CAiXNw0pSKKE0I1SEiRbK1qqq2kVjRRSyqapgdN0kEKUsFaWjaOqqNgI01lJtqtRWK2s3GGIgSFMIlPerJQnUsCyJE8dObMf3cfZHfFMnOBCmPryfdOXH+e75zne+833nexBMAGVlZRgcHEQwGASlFIlEApRSAADnHJzzW85BCBn5NB4AYIwhGAxCFEWYTCZQSkEpBSEEbrcbVqsVJ06cuOX8wngDFRUVmDlzJhKJBLZv347KykoWCoUkQoiFEGIlhDDcBsYTxNiQ5BgnhOiU0iilNOpyueJHjx7VmpqaEAgEsGHDhvHnT/3BGIOmaXjppZewcOFCLFiwANevX0d2dvYsxlhZNBqdJghClaqqc75OjYRCIQiCAEEQDG206rp+2GKxnAFwOhgMfur1ehEIBNDY2Ih169aBEJKeryiKAIB7770Xy5cvBwBMnjy5wuPx/EKSpBgA/l08ZrM5kpubuzI3N7ccAFauXImampr0GjE0MXXqVJjNZpw8eRJFRUW/CgQCTw4NDZXouj58DgUBqqpyAB0AepNz9CWZ3g44AAmAecypYABcAPIBCMauM8YgiuLJvLy8XW1tbZsrKirQ29uLjo6OG49WcXExNE2Dw+Fwtre3b+zp6VnJOU9lcgrAjgMHDlQVFBQsYYz1EULAGIsax+R2BNF1XdB1XUxZA+ecU1VVs4PB4JGKiorDABYBKE85+npOTs7rPp9vbV9fX0hVVVy9evWrWe+55x6Ul5fjvvvuy3K5XG8SQkapt6am5rlIJKIrivI557yLf/MIKYrSEYlE9Llz565KXQshhNtstqa7777bNn36dFRVVQ0LWV1djZycHNx1113s6NGjv+zu7l7DOYckSdA07RSA2e3t7R9KkkQopS4AVnzzkCml2SaTidTX19fZbLaSPXv2VEuS5FVVFaqqVkqSpFZUVByORqOaKIoYMeyqqqrFYwytI5FIaDxDkEgkVADHUjWTl5e3GADmzJkzLL7P58uxWq2HDAIAzdFoNMwzDNFotB/APuPoO53OQ7NmzXIDAJ0/fz4RRbE6FovNZoyBcx7esmXLH8xm83+QYTCbzd2NjY1/5JyHBEFAX1/fbJvNtqChoYHA5/M5JEkyXChfv379e5qmXeWZi7aNGze+baxXFMUvS0pKsuDxeKoIIVwURQ7g9Llz587yDMeFCxc+B3DBEKasrKyY6rpexjmHoih48cUXrdOmTWPIcHi93n8COGoymQAA3d3dD1Fd1x9Ojg+VlJQ4KKVTM10Qh8OxeMeOHbWJRAIAEA6HH6GJRGJ2cnzAYrH8e2wgmaGYPGXKlHYA1wFA07TpVNd1V3IwLstyD/5PkJWVdQ3AIADoum6lQ0NDxpgiimJ0vBej0WgrIWQuIWQVIWRmPB5vuWkwxTlee+21JYSQnxNCVrzxxhsP3ircj8ViRwghc5I8Zkej0SPj0UqSFAaQSGoEoJSO3OTNzc0fp/MSg4ODxwBssdlsHAC32+0cwHOxWOzIeJ6lqanpzwCUlEhBefXVV1/nnAfT0cdisU8BNBo8kp+bBgYGjqejP3PmzA4AZwFwSilHSoDY3tLSsjvNOxqAhx0OBwegJ2n15O86zvkNYYyu6+1r1qwZTA15GGMcwCddXV3PjMNjZnKDRngkhVmYjsf58+ebAJw2ohGaom5FEITBNEeEAGjo7+9PDftJ8vfDY0J9AEBra+sHmzdvviQIX2XSmqYBgK2rq6t0HB714XB4FI9IJAIAtel4pB4tzjloSi7BKaXaOEnQB1lZWUhJoLjNZgOAg0mNjkJ5eXn1smXLvq+q6qg0GkDM4XB8niYN5gB22+32dDxOpOPBGNMMWkII6M1y+CQR6e3tfXxgYOA9u91OAMBut5NIJLKzr69vRbp3TCbTDL/fvy/1P03TsG7dupP5+fkN6VL6cDi8KhwOvzOGx/s9PT0rgRvWeWM9IMXYLx4/fvyd8Yy3t7f3EIAfAdgO4KH+/v5/3SyMUFWVv/DCCw8C2ATg9xs2bHhQVdWbZ1Oh0AEAiwG8DeDR3t7eQ+PRdnR0bALQOmJ/siyPGHtzc/PfbsJH03U9rmmaout6PJ0BpkFc07SEpmkK5zw+AfoJ8zh79uw2AGeSBQouiKI4GI/HrQCyBgYG8m+iQUoIkZI2JUzw3pJS6lYTeWfCPHp6eooAZAOAoihhSggxLh1bJBLJTfr+TEfoypUrFQDuSNpkJ5Vl+a/G7jU3Nwc450cyXYp4PL6zvr7+L0YtLisr60Pk5ORUE0K4IAgcwPGLFy8ez/R85NKlS2eS5SlOCOEej8dPBUG4yBjjSZ/v37dv35cALmewQs4fPHjwFIDiZIW0e9KkSe2oqakh06ZNewYAN5lMHMD5q1evHp6gl/m2oV27du0CgHPJjJZPmTLludLS0mGPUlJS4rVYLOeNuGj69Okt8Xg8lmlSDA0NRe+///7Dxjqzs7OPFxcX3zFSKq2trSUul+snKZcjB/CerutKpgih67oC4N2UkhXPycl5YunSpaS0tBT08uXLSCQSfN68ee/m5+e/knLtL6GUHkqJt74r6Mk+ykFCyCNGkFhZWbm1oaHhfVVV+RdffAE6NDQEzjlOnz4dlyTpFbvd/oFBbDKZfkAIufbYY4+tVxQFAHq+pXtGB9CrKArq6+ufJYRcMplMtUakbrfbd/f09Ly8d+/eaDIh+yrg8/l8kGUZWVlZRR0dHa+EQqFFYzK6UytWrNjU2Nj4uNPprAVgGWcR3dFotFfTNOvtaFLXdVHXdabrullRlL6PPvpo01NPPfUogFHNkOzs7I+9Xu+aeDx+llKKtra2G6PdoqIiSJKERYsWCVu2bPmtqqpLNU1zc85BKUWyT/JrznkFgEfTrCeyf//+t2pra+MAvgdAm2hnDoA9uTnOZI/kDqNvQwiByWTqmTp16p/8fv9vWltbh6LRKLly5QpPWddolJaWorq6GmazGQ6HY7HNZnuTMRYZSSmBVZzzt9IZ486dO1sBnDabzV9bx0qW5UFZlptyc3OXAMDzzz8Pv98/se1Zvnw5bDYbyc7ORmVlpcwYO5Qy+WrO+dupQnz22WeNW7du5QDC4wmRbHRySilnjHFBELggCEaFk1NKuSAIxtiA2Wz+xO12r3O73T8sLi6W3G73sMqHs8Zbd3UppWhqagIAXlhYiGPHjg0RQiJGAsM5H5XkNDU1/f3pp59+JBm82WKxGGw22xnG2O9isVifoigj7TNCCCilYIyNeoLBoCKKIiRJ4gAShJAQY6zL7/d37t27V0m1VZvNlrYRKqQxupHvbW1toJQSAJRzbkwgAvCEw+Gfrl69etm2bdtqCCFmo+zqdDo/dLvdzzLG2hlj6OrqQn9/P6xWK2RZHumnWywWyLIMWZZx4MABXlhYCJ/Phz179gAAXC4XOjs7UVdXh0mTJmHXrl2jSk23DTqMfxjqp5SunTdv3lyn09k+pkoS83g8a41WXkFBAdxuN2RZBqUUkiTBarXCbrfD5XIhNzcX+fn5KCgoMFwq8vLy4PP54Ha7R/XfvxakCgJAt1qtbaIo9o1pIV+ZPHnyjz0eD4wWcsZhjCCjHkrpQE5OznnOOfX7/fB4PCSlXPOtrvOWLQQynHc+yTmfkvq/3W5vt1qtLweDwScsFgvXdR0tLS1j61iZqxHGGLdarftnzJgxEwACgcCI8f0P/fbvRhBBEFSHw/FKSUlJrtPpxAMPPACv15sR67xlZSPpjmWz2Tzgcrl+xhjb3d/fH5s/fz46OjrQ2dn5/9GHKCwsJAUFBWsBTKqrq6N33nknDO+USbilsXu9XjDGmiVJGkgkElzXdQQCgYwT5L/BncGPZ88nrgAAAABJRU5ErkJggg==`;\n\nexport const icon_NewMessage = `data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABGdBTUEAALGOfPtRkwAAACBjSFJN\nAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAADpElEQVR42uyZP0grWRTGz+gk\nyhPEXYSQQmTAJoWCqJ2VqAgmYhBFtxELURHfW7ERbATTprEIJmAEWcbONBKf+KcRG7HQoGEW0ZhC\ngwmmEGIiZvy2eXlkvE40muhG5oMUmTn3nvO75947d85wAOgrqIi+iDQQDUQD0UA0EA3kPeLD4TA5\nnc7voihOSpL0BxHJhZIEQRDuOjs7F8fHx220sLDwg4hQyL/p6Wk7NTU1/ZvJiOO4Tw/0pRiqq6uD\nHM/zN8lk8k8iIqPRSKFQSJE/q9VKExMTVFJSQvF4nMkvAOI47sV5kDqcZrJN7wsAlZaWkizL5HK5\nSBRFha0gCBQMBunx8ZGIKEo8z9+kyNbW1uB0OhnikZERXF5e4qMVDocxOTnJZMRut2N/fz/92o0C\nZGdnBwCwu7sLk8mkaFxZWQmPx/NhEOvr66iqqlLEIAgCNjc3AQB+v18dZGtrSzEaY2NjTHZmZ2cR\nj8fzBnB/fw+bzcb4HRwcxNXV1W+7k5MTdZDt7W2mY5fLxXTa0dEBSZJyDnF+fg6r1cr4m5+fhyzL\nCtusQQDA5/PBYrEoOi8vL4fD4cDd3V1OsuB2u2EwGBQ+WltbcXBw8Gyb4+Pj7EEAIJFIwG63M6PV\n39+PUCj0ZohIJIKhoSGm37m5OcRiMdV2GTOSvkbUtLGxAaPRqHBaU1OTcRDUtLe3h9raWkVfFRUV\n8Hq9L7Z909R6qmAwiL6+PmYUbTZbxlF8KbsWiwWnp6eviiEnIKl5vbKywszrlpYW+Hw+1XaSJMFs\nNjNZcLvdWe2GDEhxcfGbQFLy+/1obm5WBMbzPBYXFxU7jSzLEEURZWVlCtuGhgYcHh5m7ffda+Q5\n3d7eYmZm5tm9//r6GtFoFKOjo8z9qakpRKPRN/nM2dR6Tl6vl3ka19fXo7GxkTklrK6uvstXXkEA\nIBAIYGBgQPWk2t3d/eoF/akgAJBMJrG0tAS9Xq+AcDgceHh4yImPvKwRNR0dHcFsNqOtrU31CZ0r\nED69iP2a94psVFdXRx6PhwCQTqfL7zt7roNnHPD8x1dRCvkTgwIk39nJK8iX+dCTnoVCzgj/qwpB\nREQXFxcUCAQokUgwVY+n1ZLU/6cZVbN/TeUl3Wem9jqdjs7OzpQXTSbTRaEX6AwGw2VRb2/vP4W+\nPrq6urb5np6euUgk8m15efmvWCxWQkSPBRI/p9fr5fb29p/Dw8N/c9rnaQ1EA9FANBANRAPRQP5/\n+m8A4sEE5SZccHcAAAAASUVORK5CYII=`.replaceAll(\"\\n\", \"\");\n\nexport const icon_PurpleHeart = `data:image/png;base64,\n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`.replaceAll(\"\\n\", \"\");\n\nexport const icon_BCX_chatroom = `data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABGdBTUEAALGOfPtRkwAAACBjSFJN\nAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAGr0lEQVR42uyaW2xTdRzHP6c3\nKHQbFoeDTTMmSssGu7WbQgy+mOjU+KAvuohifFC8QRQEQaMIkRi8o0TRqIgaY9CEYJQXFS9kq5vb\nmN2wzsAIw9V1srSlWy9n9aGn8F9ZzyldNxLCPzkP/++/53f+3/6u5/c/Ujwe52IYOi6ScdEQMaRb\nkCRJnC4BrgfmZiBTAsLAEeAnwCesVQHXKXLiGcjxA23AIWAEIJ0rGDLY2DzgfmAZYM2QSBQ4BswE\nPlHwEkXOUkVOJkRCgEOR97Pqr+Px+LiXMuYAHuWh2V6bgALg6ATl3Ka6Xw0ij03w4XHAC+zLgZzv\ngXnp9qtmWnpg8Vmf0TNv3jIkSa9qFZKkZ3jYh8/XIWr19jO2bDBTVFSvaZ96vYnBwS6CwRNJyA4s\nBE6er4/IwKmzJijjcDyFzXY7kYhKGNRBKDTEnj2VBALHz1m32RppaNhFNKriHBLEYqfZvbtGhENA\nMNvw+6s4aWraTDg8yugoyPL4VzQKFsssamufHFegzdZILJb+flkGvR4OH36foSGPeOuPQGe2RPYD\nruTE622hq2s3JpP6TZEIlJevJD+/dAw+d+51lJTcSCymrlG//19crm2p1vFOMgRnQ2QUeFEEWlpe\nZmRkhLFpJjUSgtmch9O5fgy+ePFDGDQCvtEIbW1vEQr1i/CHQOtEM/t+Ra0A/PdfN52d72lqJRqF\nRYtWMGvWAgDM5kLmz79NVRt6PQwO9tLRsSPVN17OVYmyWZz8/vvrhEIBdDp1rUybZsbhWKf4xj3k\n589mdFSlzDBAS8s2wuEhEd4J/JUrIj8A3yYnfv9R2tt3YDRqa2XhwruxWhdht9+rqg2DAbzeLtzu\nj0XYB2zPddH4vOJ0ALS1vYHfP6CpFZPJQkPDZ1it5ciyupM3Nb2ALA+L8OtAf66JuIC9Zww35KW9\n/U1NX5FlKCysRKebrqqNvj4XHs+XInwMeGuyyvgtSmULQEfHTk6dOoler01Gaxw69FxqxfCqUv1O\nCpFOJRQCMDIyyG+/bdMMqVrh9ujRA/T2HhDhDuDdyX6xeg04nZy43R/h8/2tqZW0iWoUXK6tqfB2\nIDLZRDxKllUiUwCXa2tWREwm8Hj20tc35lXjF2DPVL3q7hALyu7uT/F63edlYpIE0WiM5ubNqUvb\npvKd/bhiYop5RGhuflG1bBnPN7q6PsbnOyzC3wHfTHXzYacY4z2eL+jra8pIK5IEwaCf5uYt4+Wq\nKe+i+IA3x5b5W8mkTZaIVPvx+4+J8EGg+UK1g64RJxbL3IzMS5ahqKgeozFPhKuBsgtBpFbpiij/\nch51dRsy0ogsw5w5V1NZuUqE84EnLwSRF5SWTYJV7Rqs1vkZZfFkQVlTs4bp02eL8INin2AqiDQA\nt541qWKqq1erVrfjJcKCgiuorn5iTGoB1k4VEQl4RgQcjnVYLJepvmuk00pV1ePk5V0pwo1A3VQQ\nWaF0HQGYPbuCJUseVu2sqGnFYimgunp16p7WTTYRc6rqnc71mExGsj2diEahouJB8vKuEuE7geWT\nSeRRoDw5KS5ejt3eqNqjykQrM2fm43RuSF3aOFlELgfG2EB9/UZ0OlS1odejmVsiEaioeACr1S7C\nNwG3TAaRtSQ68wCUlt5CaelNqtowGBJl/vCwV7N9ZDKZcDqfTl3alGsiZcCqs7WSgaVLt2jWU+Fw\ngIMH19DdvTuj9pHdfh9FRWMC1lLFX3JGZCNgSU7s9kaKi2tU84bRCD09XxMOD9HevoNQKKipFYMB\namvXjqcVYy6IpJQiFurqNqmSSDShoaPjbQACgeP88cf7GbVar732LkpKbhThKuCeXBB5VvxdZeUj\nFBYuUC1FDAY4efJn+vvPtI1pbX2FYHBItX2UbAs5HOdoZb0S+rMmcjNwR3IyY8YV1NSs1gy3kpTo\nsIgjGDyB2/1BRk29srIGSksbRNgGrMyWyJWpGdbpXE9BQZFqKaLXw8DAn/T0fHXOWmvrK/j9Pk2t\nSBLU1z+TCq8B6rMhcj3gTE6s1nJqah460zRId5nNcOTI58hy+ByBp0//g9v9ATNmqMuQJCgrW4bN\n1ijevgC4Ia05qxCxkjiVTcYVDhxYRSw2ovFv6ujt/U6EQiSO8aYltLKdgYFO4vFRDV8xEQj0jben\ndGEv7WHocqCPiR9ivqQ02yYqZwRYke2p7oYJPvwEUEjijL1/grJ2AQXp9iul+5JA+PJhJXCvshkD\n5/fFwlagR8EXKom1SkmumdTLceUP2EeiMx9Ju99LXwddInKJiOr4fwA/BD9RRZPbhQAAAABJRU5E\nrkJggg==\n`.replaceAll(\"\\n\", \"\");\n\nexport const icon_BCX = `data:image/png;base64,\n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\n`.replaceAll(\"\\n\", \"\");\n\nexport const icon_OwnerList = `data:image/png;base64,\n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\nxBaQJfz/AJiiFen2ESExAAAAAElFTkSuQmCC\n`.replaceAll(\"\\n\", \"\");\n","import { detectOtherMods, DrawImageEx } from \"../utilsClub\";\nimport { VERSION } from \"../config\";\nimport { hiddenMessageHandlers, sendHiddenMessage } from \"./messaging\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { hookFunction, patchFunction } from \"../patching\";\nimport { icon_Emote, icon_PurpleHeart, icon_Typing, icon_BCX_chatroom } from \"../resources\";\nimport { getChatroomCharacter } from \"../characters\";\nimport { modStorage } from \"./storage\";\n\nclass ChatRoomStatusManager {\n\tInputTimeoutMs = 3_000;\n\n\tStatusTypes = {\n\t\tNone: \"None\",\n\t\tTyping: \"Typing\",\n\t\tEmote: \"Emote\",\n\t\tWhisper: \"Whisper\",\n\t\t// NMod\n\t\tAction: \"Action\",\n\t\tAfk: 'Afk'\n\t};\n\n\tprivate InputElement: HTMLTextAreaElement | null = null;\n\n\tprivate InputTimeout: number | null = null;\n\n\tStatus: string;\n\n\tconstructor() {\n\t\tthis.Status = this.StatusTypes.None;\n\t}\n\n\tSetInputElement(elem: HTMLTextAreaElement | null) {\n\t\tif (this.InputElement !== elem) {\n\t\t\tthis.InputElement = elem;\n\t\t\tif (elem !== null) {\n\t\t\t\telem.addEventListener(\"blur\", this.InputEnd.bind(this));\n\t\t\t\telem.addEventListener(\"input\", this.InputChange.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\tSetStatus(type: string, target: number | null = null) {\n\t\tif (!modStorage.typingIndicatorEnable) {\n\t\t\ttype = this.StatusTypes.None;\n\t\t}\n\t\tif (type !== this.Status) {\n\t\t\tif (target !== null && this.Status === this.StatusTypes.Whisper) {\n\t\t\t\tthis.SetStatus(this.StatusTypes.None, null);\n\t\t\t}\n\t\t\tthis.Status = type;\n\t\t\tsendHiddenMessage(\"ChatRoomStatusEvent\", { Type: type, Target: target }, target);\n\t\t\tconst { NMod } = detectOtherMods();\n\t\t\tif (NMod) ServerSend(\"ChatRoomStatusEvent\", { Type: type, Target: target });\n\t\t}\n\t}\n\n\tInputChange() {\n\t\tconst value = this.InputElement?.value;\n\t\tif (typeof value === \"string\" && value.length > 1) {\n\t\t\tlet type = this.StatusTypes.Typing;\n\t\t\tlet target = null;\n\t\t\tif (value.startsWith(\"*\") || value.startsWith(\"/me \") || value.startsWith(\"/emote \") || value.startsWith(\"/action \")) {\n\t\t\t\ttype = this.StatusTypes.Emote;\n\t\t\t} else if (value.startsWith(\"/\") || value.startsWith(\".\")) {\n\t\t\t\treturn this.InputEnd();\n\t\t\t} else if (ChatRoomTargetMemberNumber !== null) {\n\t\t\t\ttype = this.StatusTypes.Whisper;\n\t\t\t\ttarget = ChatRoomTargetMemberNumber;\n\t\t\t}\n\t\t\tif (this.InputTimeout !== null) {\n\t\t\t\tclearTimeout(this.InputTimeout);\n\t\t\t}\n\t\t\tthis.InputTimeout = setTimeout(this.InputEnd.bind(this), this.InputTimeoutMs);\n\t\t\tthis.SetStatus(type, target);\n\t\t} else {\n\t\t\tthis.InputEnd();\n\t\t}\n\t}\n\n\tInputEnd() {\n\t\tif (this.InputTimeout !== null) {\n\t\t\tclearTimeout(this.InputTimeout);\n\t\t\tthis.InputTimeout = null;\n\t\t}\n\t\tthis.SetStatus(this.StatusTypes.None);\n\t}\n\n\tunload() {\n\t\tthis.InputEnd();\n\t}\n}\n\nexport let ChatroomSM: ChatRoomStatusManager;\n\nfunction queryAnnounce() {\n\tannounceSelf(true);\n}\n\nexport class ModuleChatroom extends BaseModule {\n\tinit() {\n\t\tChatroomSM = new ChatRoomStatusManager();\n\t}\n\n\tprivate o_ChatRoomSM: any | null = null;\n\n\tload() {\n\t\tif (typeof modStorage.typingIndicatorEnable !== \"boolean\") {\n\t\t\tmodStorage.typingIndicatorEnable = true;\n\t\t}\n\n\t\thiddenMessageHandlers.set(\"hello\", (sender, message: any) => {\n\t\t\tconst char = getChatroomCharacter(sender);\n\t\t\tif (!char) {\n\t\t\t\tconsole.warn(`BCX: Hello from character not found in room`, sender);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (typeof message?.version !== \"string\") {\n\t\t\t\tconsole.warn(`BCX: Invalid hello`, sender, message);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (char.BCXVersion !== message.version) {\n\t\t\t\tconsole.log(`BCX: ${char.Character.Name} (${char.Character.MemberNumber}) uses BCX version ${message.version}`);\n\t\t\t}\n\t\t\tchar.BCXVersion = message.version;\n\t\t\tif (message.request === true) {\n\t\t\t\tannounceSelf(false);\n\t\t\t}\n\t\t});\n\n\t\thiddenMessageHandlers.set(\"goodbye\", (sender) => {\n\t\t\tconst char = getChatroomCharacter(sender);\n\t\t\tif (char) {\n\t\t\t\tchar.BCXVersion = null;\n\t\t\t}\n\t\t});\n\n\t\thookFunction(\"ChatRoomMessage\", 10, (args, next) => {\n\t\t\tconst data = args[0];\n\n\t\t\tif (data?.Type === \"Action\" && data.Content === \"ServerEnter\") {\n\t\t\t\tannounceSelf(false);\n\t\t\t}\n\n\t\t\treturn next(args);\n\t\t});\n\n\t\tconst { NMod } = detectOtherMods();\n\n\t\tif (NMod) {\n\t\t\thookFunction(\"ChatRoomDrawFriendList\", 0, (args, next) => {\n\t\t\t\tconst [C, Zoom, CharX, CharY] = args as [Character, number, number, number];\n\t\t\t\tconst Char = getChatroomCharacter(C.MemberNumber!);\n\t\t\t\tconst Friend = C.ID === 0 || (Player.FriendList ?? []).includes(C.MemberNumber!);\n\t\t\t\tif (Char?.BCXVersion && ChatRoomHideIconState === 0) {\n\t\t\t\t\tDrawImageEx(Friend ? icon_PurpleHeart : icon_BCX_chatroom, CharX + 375 * Zoom, CharY, {\n\t\t\t\t\t\tWidth: 50 * Zoom,\n\t\t\t\t\t\tHeight: 50 * Zoom,\n\t\t\t\t\t\tAlpha: Friend ? 1 : 0.5\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tnext(args);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tpatchFunction(\"ChatRoomDrawCharacterOverlay\", {\n\t\t\t\t'DrawImageResize(\"Icons/Small/FriendList.png\", CharX + 375 * Zoom, CharY, 50 * Zoom, 50 * Zoom);': \"\"\n\t\t\t});\n\n\t\t\thookFunction(\"ChatRoomDrawCharacterOverlay\", 0, (args, next) => {\n\t\t\t\tnext(args);\n\n\t\t\t\tconst [C, CharX, CharY, Zoom] = args as [Character, number, number, number];\n\t\t\t\tconst Char = getChatroomCharacter(C.MemberNumber!);\n\t\t\t\tconst Friend = C.ID === 0 || (Player.FriendList ?? []).includes(C.MemberNumber!);\n\t\t\t\tif (Char?.BCXVersion && ChatRoomHideIconState === 0) {\n\t\t\t\t\tDrawImageEx(Friend ? icon_PurpleHeart : icon_BCX_chatroom, CharX + 375 * Zoom, CharY, {\n\t\t\t\t\t\tWidth: 50 * Zoom,\n\t\t\t\t\t\tHeight: 50 * Zoom,\n\t\t\t\t\t\tAlpha: Friend ? 1 : 0.5\n\t\t\t\t\t});\n\t\t\t\t} else if (Friend && ChatRoomHideIconState === 0) {\n\t\t\t\t\tDrawImageEx(\"Icons/Small/FriendList.png\", CharX + 375 * Zoom, CharY, {\n\t\t\t\t\t\tWidth: 50 * Zoom,\n\t\t\t\t\t\tHeight: 50 * Zoom\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tswitch (C.ID === 0 ? ChatroomSM.Status : C.Status) {\n\t\t\t\t\tcase ChatroomSM.StatusTypes.Typing:\n\t\t\t\t\t\tDrawImageEx(icon_Typing, CharX + 375 * Zoom, CharY + 50 * Zoom, {\n\t\t\t\t\t\t\tWidth: 50 * Zoom,\n\t\t\t\t\t\t\tHeight: 50 * Zoom\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ChatroomSM.StatusTypes.Whisper:\n\t\t\t\t\t\tDrawImageEx(icon_Typing, CharX + 375 * Zoom, CharY + 50 * Zoom, {\n\t\t\t\t\t\t\tWidth: 50 * Zoom,\n\t\t\t\t\t\t\tHeight: 50 * Zoom,\n\t\t\t\t\t\t\tAlpha: 0.5\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ChatroomSM.StatusTypes.Emote:\n\t\t\t\t\t\tDrawImageEx(icon_Emote, CharX + 375 * Zoom, CharY + 50 * Zoom, {\n\t\t\t\t\t\t\tWidth: 50 * Zoom,\n\t\t\t\t\t\t\tHeight: 50 * Zoom\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\thookFunction(\"ChatRoomCreateElement\", 0, (args, next) => {\n\t\t\t\tnext(args);\n\t\t\t\tChatroomSM.SetInputElement(document.getElementById(\"InputChat\") as HTMLTextAreaElement);\n\t\t\t});\n\t\t}\n\n\t\thookFunction(\"ChatRoomSendChat\", 0, (args, next) => {\n\t\t\tnext(args);\n\t\t\tChatroomSM.InputEnd();\n\t\t});\n\n\t\thookFunction(\"ChatRoomClearAllElements\", 0, (args, next) => {\n\t\t\tnext(args);\n\t\t\tChatroomSM.SetInputElement(null);\n\t\t});\n\n\t\thiddenMessageHandlers.set(\"ChatRoomStatusEvent\", (src, data: any) => {\n\t\t\tfor (const char of ChatRoomCharacter) {\n\t\t\t\tif (char.MemberNumber === src) {\n\t\t\t\t\tchar.Status = data.Target == null || data.Target === Player.MemberNumber ? data.Type : \"None\";\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (NMod) {\n\t\t\tthis.o_ChatRoomSM = (window as any).ChatRoomSM;\n\t\t\t(window as any).ChatRoomSM = ChatroomSM;\n\t\t\tServerSocket.on(\"ChatRoomMessageSync\", queryAnnounce);\n\t\t}\n\t}\n\n\trun() {\n\t\tif (document.getElementById(\"InputChat\") != null) {\n\t\t\tChatroomSM.SetInputElement(document.getElementById(\"InputChat\") as HTMLTextAreaElement);\n\t\t}\n\t\tqueryAnnounce();\n\t}\n\n\tunload() {\n\t\tChatroomSM.unload();\n\t\tif (this.o_ChatRoomSM) {\n\t\t\t(window as any).ChatRoomSM = this.o_ChatRoomSM;\n\t\t}\n\t\tServerSocket.off(\"ChatRoomMessageSync\", queryAnnounce);\n\t\tsendHiddenMessage(\"goodbye\", undefined);\n\t}\n}\n\nexport function announceSelf(request: boolean = false) {\n\tsendHiddenMessage(\"hello\", {\n\t\tversion: VERSION,\n\t\trequest\n\t});\n}\n","import { VERSION_CHECK_BOT } from \"../config\";\nimport { moduleInitPhase } from \"../moduleManager\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { isObject } from \"../utils\";\nimport { announceSelf } from \"./chatroom\";\nimport { sendHiddenBeep } from \"./messaging\";\nimport { ModuleInitPhase } from \"../constants\";\n\nexport let modStorage: Partial<ModStorage> = {};\nlet deletionPending = false;\nexport let firstTimeInit: boolean = false;\n\nexport function finalizeFirstTimeInit() {\n\tfirstTimeInit = false;\n\tmodStorageSync();\n\tconsole.log(\"BCX: First time init finalized\");\n\tannounceSelf(true);\n}\n\nexport function modStorageSync() {\n\tif (moduleInitPhase !== ModuleInitPhase.ready && moduleInitPhase !== ModuleInitPhase.destroy)\n\t\treturn;\n\tif (deletionPending || firstTimeInit)\n\t\treturn;\n\tif (!Player.OnlineSettings) {\n\t\tconsole.error(\"BCX: Player OnlineSettings not defined during storage sync!\");\n\t\treturn;\n\t}\n\t(Player.OnlineSettings as any).BCX = LZString.compressToBase64(JSON.stringify(modStorage));\n\tif (typeof ServerAccountUpdate !== \"undefined\") {\n\t\tServerAccountUpdate.QueueData({ OnlineSettings: Player.OnlineSettings });\n\t} else {\n\t\tconsole.debug(\"BCX: Old sync method\");\n\t\tServerSend(\"AccountUpdate\", { OnlineSettings: Player.OnlineSettings });\n\t}\n}\n\nexport function clearAllData() {\n\tdeletionPending = true;\n\tdelete (Player.OnlineSettings as any).BCX;\n\tif (typeof ServerAccountUpdate !== \"undefined\") {\n\t\tServerAccountUpdate.QueueData({ OnlineSettings: Player.OnlineSettings }, true);\n\t} else {\n\t\tconsole.debug(\"BCX: Old sync method\");\n\t\tServerSend(\"AccountUpdate\", { OnlineSettings: Player.OnlineSettings });\n\t}\n\tsendHiddenBeep(\"clearData\", true, VERSION_CHECK_BOT, true);\n\tsetTimeout(() => {\n\t\twindow.location.reload();\n\t}, 2000);\n}\n\nexport class ModuleStorage extends BaseModule {\n\tinit() {\n\t\tconst saved = (Player.OnlineSettings as any)?.BCX;\n\t\tif (typeof saved === \"string\") {\n\t\t\ttry {\n\t\t\t\tconst storage = JSON.parse(LZString.decompressFromBase64(saved)!);\n\t\t\t\tif (!isObject(storage)) {\n\t\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t\t}\n\t\t\t\tmodStorage = storage;\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"BCX: Error while loading saved data, full reset.\", error);\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.log(\"BCX: First time init\");\n\t\t\tfirstTimeInit = true;\n\t\t}\n\t}\n\n\trun() {\n\t\tmodStorageSync();\n\t}\n}\n","import { ChatroomCharacter, getChatroomCharacter } from \"../characters\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { hookFunction, removeHooksByModule } from \"../patching\";\nimport { isObject } from \"../utils\";\nimport { ChatRoomSendLocal } from \"../utilsClub\";\nimport { AccessLevel, checkPermissionAccess, registerPermission } from \"./authority\";\nimport { notifyOfChange, queryHandlers } from \"./messaging\";\nimport { moduleIsEnabled } from \"./presets\";\nimport { modStorage, modStorageSync } from \"./storage\";\nimport { ModuleCategory, Preset } from \"../constants\";\n\nexport const LOG_ENTRIES_LIMIT = 256;\n\nexport enum LogEntryType {\n\tplaintext = 0,\n\tdeleted = 1\n}\n\nexport enum LogAccessLevel {\n\tnone = 0,\n\tprotected = 1,\n\tnormal = 2,\n\teveryone = 3\n}\n\nexport type LogEntryTypeData = {\n\t/** The data itself */\n\t[LogEntryType.plaintext]: string;\n\t/** Deleted log entries are replaced with this */\n\t[LogEntryType.deleted]: null;\n};\n\n/**\n * Compact format containing following:\n * @property {number} 0 - The time this log was recorded\n * @property {LogAccessLevel} 1 - The required access level to view this log\n * @property {LogEntryType} 2 - The type of the entry\n * @property {LogEntryTypeData} 3 - Extra data defined by the entry type\n */\nexport type LogEntry<Type extends LogEntryType = LogEntryType> = [number, LogAccessLevel, Type, LogEntryTypeData[Type]];\n\nexport type LogConfig = Partial<Record<BCX_LogCategory, LogAccessLevel>>;\n\nexport function logMessage<Type extends LogEntryType>(category: BCX_LogCategory, type: Type, data: LogEntryTypeData[Type]) {\n\tif (!moduleIsEnabled(ModuleCategory.Log))\n\t\treturn;\n\n\tconst access = modStorage.logConfig?.[category];\n\tif (access === undefined) {\n\t\tthrow new Error(`Attempt to log message with unknown category \"${category}\"`);\n\t}\n\tif (access > LogAccessLevel.none) {\n\t\tlogMessageAdd(access, type, data);\n\t}\n}\n\nfunction logMessageAdd<Type extends LogEntryType>(access: LogAccessLevel, type: Type, data: LogEntryTypeData[Type]) {\n\tif (!moduleIsEnabled(ModuleCategory.Log))\n\t\treturn;\n\n\tif (!modStorage.log) {\n\t\tthrow new Error(\"Mod storage log not initialized\");\n\t}\n\tmodStorage.log.unshift([Date.now(), access, type, data]);\n\t// Time must me unique\n\tif (modStorage.log.length >= 2 && modStorage.log[0][0] <= modStorage.log[1][0]) {\n\t\tmodStorage.log[0][0] = modStorage.log[1][0] + 1;\n\t}\n\tmodStorage.log.splice(LOG_ENTRIES_LIMIT);\n\tmodStorageSync();\n\tnotifyOfChange();\n}\n\nexport function logMessageDelete(time: number, character: ChatroomCharacter | null): boolean {\n\tif (!moduleIsEnabled(ModuleCategory.Log))\n\t\treturn false;\n\n\tif (character && !checkPermissionAccess(\"log_delete\", character)) {\n\t\treturn false;\n\t}\n\n\tconst access = modStorage.logConfig?.logDeleted;\n\tif (access === undefined) {\n\t\tthrow new Error(\"logDeleted category not found\");\n\t}\n\tif (!modStorage.log) {\n\t\tthrow new Error(\"Mod storage log not initialized\");\n\t}\n\tfor (let i = 0; i < modStorage.log.length; i++) {\n\t\tconst e = modStorage.log[i];\n\t\tif (e[0] === time) {\n\t\t\tif (access === LogAccessLevel.none) {\n\t\t\t\tmodStorage.log.splice(i, 1);\n\t\t\t} else {\n\t\t\t\te[1] = access;\n\t\t\t\te[2] = LogEntryType.deleted;\n\t\t\t\te[3] = null;\n\t\t\t}\n\t\t\tmodStorageSync();\n\t\t\tnotifyOfChange();\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nexport function logConfigSet(category: BCX_LogCategory, accessLevel: LogAccessLevel, character: ChatroomCharacter | null): boolean {\n\tif (!moduleIsEnabled(ModuleCategory.Log))\n\t\treturn false;\n\n\tif (character && !checkPermissionAccess(\"log_configure\", character)) {\n\t\treturn false;\n\t}\n\n\tif (modStorage.logConfig?.[category] === undefined) {\n\t\treturn false;\n\t}\n\n\tif (![LogAccessLevel.none, LogAccessLevel.normal, LogAccessLevel.protected].includes(accessLevel)) {\n\t\treturn false;\n\t}\n\n\tif (character) {\n\t\tconst msg = `${character} changed log configuration \"${LOG_CONFIG_NAMES[category]}\" ` +\n\t\t\t`from \"${LOG_LEVEL_NAMES[modStorage.logConfig[category]!]}\" to \"${LOG_LEVEL_NAMES[accessLevel]}\"`;\n\t\tlogMessage(\"logConfigChange\", LogEntryType.plaintext, msg);\n\t\tif (!character.isPlayer()) {\n\t\t\tChatRoomSendLocal(msg, undefined, character.MemberNumber);\n\t\t}\n\t}\n\n\tmodStorage.logConfig[category] = accessLevel;\n\tmodStorageSync();\n\tnotifyOfChange();\n\treturn true;\n}\n\nexport function logClear(character: ChatroomCharacter | null): boolean {\n\tif (!moduleIsEnabled(ModuleCategory.Log))\n\t\treturn false;\n\n\tif (character && !checkPermissionAccess(\"log_delete\", character)) {\n\t\treturn false;\n\t}\n\n\tmodStorage.log = [];\n\tlogMessageAdd(LogAccessLevel.everyone, LogEntryType.plaintext, \"The log has been cleared\");\n\n\treturn true;\n}\n\nexport function getVisibleLogEntries(character: ChatroomCharacter): LogEntry[] {\n\tif (!moduleIsEnabled(ModuleCategory.Log))\n\t\treturn [];\n\n\tif (!modStorage.log) {\n\t\tthrow new Error(\"Mod storage log not initialized\");\n\t}\n\n\tconst allow: Record<LogAccessLevel, boolean> = {\n\t\t[LogAccessLevel.none]: character.isPlayer(),\n\t\t[LogAccessLevel.normal]: checkPermissionAccess(\"log_view_normal\", character),\n\t\t[LogAccessLevel.protected]: checkPermissionAccess(\"log_view_protected\", character),\n\t\t[LogAccessLevel.everyone]: true\n\t};\n\treturn modStorage.log.filter(e => allow[e[1]]);\n}\n\nexport function logMessageRender(entry: LogEntry): string {\n\tif (entry[2] === LogEntryType.plaintext) {\n\t\tconst e = entry as LogEntry<LogEntryType.plaintext>;\n\t\treturn e[3];\n\t} else if (entry[2] === LogEntryType.deleted) {\n\t\treturn \"[Log message deleted]\";\n\t}\n\treturn `[ERROR: Unknown entry type ${entry[2]}]`;\n}\n\nconst alreadyPraisedBy: Set<number> = new Set();\n\nexport function logGetAllowedActions(character: ChatroomCharacter): BCX_logAllowedActions {\n\treturn {\n\t\tconfigure: checkPermissionAccess(\"log_configure\", character),\n\t\tdelete: checkPermissionAccess(\"log_delete\", character),\n\t\tleaveMessage: checkPermissionAccess(\"log_leaveMessage\", character) && !!(modStorage.logConfig?.userNote),\n\t\tpraise: checkPermissionAccess(\"log_praise\", character) && !alreadyPraisedBy.has(character.MemberNumber)\n\t};\n}\n\nexport function logGetConfig(): LogConfig {\n\tif (!moduleIsEnabled(ModuleCategory.Log))\n\t\treturn {};\n\n\tif (!modStorage.logConfig) {\n\t\tthrow new Error(\"Mod storage log not initialized\");\n\t}\n\n\treturn { ...modStorage.logConfig };\n}\n\nexport function logPraise(value: -1 | 0 | 1, message: string | null, character: ChatroomCharacter): boolean {\n\tif (!moduleIsEnabled(ModuleCategory.Log))\n\t\treturn false;\n\n\tif (![-1, 0, 1].includes(value)) {\n\t\tthrow new Error(\"Invalid value\");\n\t}\n\n\tif (value === 0 && !message)\n\t\treturn false;\n\n\tconst allowed = logGetAllowedActions(character);\n\n\tif (value !== 0 && !allowed.praise)\n\t\treturn false;\n\tif (message && !allowed.leaveMessage)\n\t\treturn false;\n\n\tif (value !== 0) {\n\t\talreadyPraisedBy.add(character.MemberNumber);\n\t}\n\n\tif (value > 0) {\n\t\tif (message) {\n\t\t\tlogMessage(\"userNote\", LogEntryType.plaintext, `Praised by ${character} with note: ${message}`);\n\t\t} else {\n\t\t\tlogMessage(\"praise\", LogEntryType.plaintext, `Praised by ${character}`);\n\t\t}\n\t} else if (value < 0) {\n\t\tif (message) {\n\t\t\tlogMessage(\"userNote\", LogEntryType.plaintext, `Scolded by ${character} with note: ${message}`);\n\t\t} else {\n\t\t\tlogMessage(\"praise\", LogEntryType.plaintext, `Scolded by ${character}`);\n\t\t}\n\t} else if (message) {\n\t\tlogMessage(\"userNote\", LogEntryType.plaintext, `${character} attached a note: ${message}`);\n\t}\n\n\treturn true;\n}\n\nconst logConfigDefaults: LogConfig = {\n\tlogConfigChange: LogAccessLevel.protected,\n\tlogDeleted: LogAccessLevel.normal,\n\tpraise: LogAccessLevel.normal,\n\tuserNote: LogAccessLevel.protected,\n\tenteredPublicRoom: LogAccessLevel.none,\n\tenteredPrivateRoom: LogAccessLevel.none,\n\thadOrgasm: LogAccessLevel.none,\n\tpermissionChange: LogAccessLevel.protected,\n\tcurseChange: LogAccessLevel.none,\n\tcurseTrigger: LogAccessLevel.none\n};\n\nexport const LOG_CONFIG_NAMES: Record<BCX_LogCategory, string> = {\n\tlogConfigChange: \"Log changes in logging configuration\",\n\tlogDeleted: \"Log deleted log entries\",\n\tpraise: \"Log praising or scolding behavior\",\n\tuserNote: \"Ability to see attached notes\",\n\tenteredPublicRoom: \"Log which public rooms are entered\",\n\tenteredPrivateRoom: \"Log which private rooms are entered\",\n\thadOrgasm: \"Log each single orgasm\",\n\tpermissionChange: \"Log changes in permission settings\",\n\tcurseChange: \"Log each application or removal of curses\",\n\tcurseTrigger: \"Log every time a triggered curse reapplies an item\"\n};\n\nexport const LOG_LEVEL_NAMES: Record<LogAccessLevel, string> = {\n\t[LogAccessLevel.everyone]: \"[ERROR]\",\n\t[LogAccessLevel.none]: \"No\",\n\t[LogAccessLevel.protected]: \"Protected\",\n\t[LogAccessLevel.normal]: \"Yes\"\n};\n\nexport class ModuleLog extends BaseModule {\n\tinit() {\n\t\tregisterPermission(\"log_view_normal\", {\n\t\t\tname: \"Allow to see normal log entries\",\n\t\t\tcategory: ModuleCategory.Log,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.mistress],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.mistress],\n\t\t\t\t[Preset.submissive]: [true, AccessLevel.friend],\n\t\t\t\t[Preset.slave]: [true, AccessLevel.public]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"log_view_protected\", {\n\t\t\tname: \"Allow to see protected log entries\",\n\t\t\tcategory: ModuleCategory.Log,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.lover],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.lover],\n\t\t\t\t[Preset.submissive]: [true, AccessLevel.mistress],\n\t\t\t\t[Preset.slave]: [true, AccessLevel.mistress]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"log_configure\", {\n\t\t\tname: \"Allow to configure what is logged\",\n\t\t\tcategory: ModuleCategory.Log,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.self],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.self],\n\t\t\t\t[Preset.submissive]: [true, AccessLevel.owner],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.owner]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"log_delete\", {\n\t\t\tname: \"Allow deleting log entries\",\n\t\t\tcategory: ModuleCategory.Log,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.self],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.self],\n\t\t\t\t[Preset.submissive]: [true, AccessLevel.owner],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.owner]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"log_praise\", {\n\t\t\tname: \"Allow to praise or scold\",\n\t\t\tcategory: ModuleCategory.Log,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [false, AccessLevel.friend],\n\t\t\t\t[Preset.switch]: [false, AccessLevel.friend],\n\t\t\t\t[Preset.submissive]: [false, AccessLevel.public],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.public]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"log_leaveMessage\", {\n\t\t\tname: \"Allow to attach notes to the body\",\n\t\t\tcategory: ModuleCategory.Log,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [false, AccessLevel.mistress],\n\t\t\t\t[Preset.switch]: [false, AccessLevel.mistress],\n\t\t\t\t[Preset.submissive]: [false, AccessLevel.friend],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.public]\n\t\t\t}\n\t\t});\n\n\t\tqueryHandlers.logData = (sender, resolve) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character) {\n\t\t\t\tresolve(true, getVisibleLogEntries(character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.logDelete = (sender, resolve, data) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character && typeof data === \"number\") {\n\t\t\t\tresolve(true, logMessageDelete(data, character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.logConfigGet = (sender, resolve) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character && checkPermissionAccess(\"log_configure\", character)) {\n\t\t\t\tresolve(true, logGetConfig());\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.logConfigEdit = (sender, resolve, data) => {\n\t\t\tif (!isObject(data) ||\n\t\t\t\ttypeof data.category !== \"string\" ||\n\t\t\t\ttypeof data.target !== \"number\"\n\t\t\t) {\n\t\t\t\tconsole.warn(`BCX: Bad logConfigEdit query from ${sender}`, data);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character) {\n\t\t\t\tresolve(true, logConfigSet(data.category, data.target, character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.logClear = (sender, resolve) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character) {\n\t\t\t\tresolve(true, logClear(character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.logPraise = (sender, resolve, data) => {\n\t\t\tif (!isObject(data) ||\n\t\t\t\t(data.message !== null && typeof data.message !== \"string\") ||\n\t\t\t\t![-1, 0, 1].includes(data.value)\n\t\t\t) {\n\t\t\t\tconsole.warn(`BCX: Bad logPraise query from ${sender}`, data);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character) {\n\t\t\t\tresolve(true, logPraise(data.value, data.message, character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.logGetAllowedActions = (sender, resolve) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character) {\n\t\t\t\tresolve(true, logGetAllowedActions(character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t}\n\n\tload() {\n\t\tif (!moduleIsEnabled(ModuleCategory.Log)) {\n\t\t\tdelete modStorage.log;\n\t\t\tdelete modStorage.logConfig;\n\t\t\tremoveHooksByModule(\"ActivityOrgasmStart\", ModuleCategory.Log);\n\t\t\tremoveHooksByModule(\"ChatRoomSync\", ModuleCategory.Log);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Array.isArray(modStorage.log)) {\n\t\t\tlogClear(null);\n\t\t} else if (!modStorage.log.every(e =>\n\t\t\tArray.isArray(e) &&\n\t\t\te.length === 4 &&\n\t\t\ttypeof e[0] === \"number\" &&\n\t\t\ttypeof e[1] === \"number\" &&\n\t\t\ttypeof e[2] === \"number\"\n\t\t)) {\n\t\t\tconsole.error(\"BCX: Some log entries have invalid format, reseting whole log!\");\n\t\t\tlogClear(null);\n\t\t}\n\n\t\tif (!modStorage.logConfig) {\n\t\t\tmodStorage.logConfig = { ...logConfigDefaults };\n\t\t} else {\n\t\t\tfor (const k of Object.keys(modStorage.logConfig) as BCX_LogCategory[]) {\n\t\t\t\tif (logConfigDefaults[k] === undefined) {\n\t\t\t\t\tconsole.info(`BCX: Removing unknown log config category \"${k}\"`);\n\t\t\t\t\tdelete modStorage.logConfig[k];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const k of Object.keys(logConfigDefaults) as BCX_LogCategory[]) {\n\t\t\t\tif (modStorage.logConfig[k] === undefined) {\n\t\t\t\t\tconsole.info(`BCX: Adding missing log category \"${k}\"`);\n\t\t\t\t\tmodStorage.logConfig[k] = logConfigDefaults[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\thookFunction(\"ActivityOrgasmStart\", 0, (args, next) => {\n\t\t\tconst C = args[0] as Character;\n\t\t\tif (C.ID === 0 && (typeof ActivityOrgasmRuined === \"undefined\" || !ActivityOrgasmRuined)) {\n\t\t\t\tlogMessage(\"hadOrgasm\", LogEntryType.plaintext, `${Player.Name} had an orgasm`);\n\t\t\t}\n\t\t\treturn next(args);\n\t\t}, ModuleCategory.Log);\n\n\t\thookFunction(\"ChatRoomSync\", 0, (args, next) => {\n\t\t\tconst data = args[0];\n\t\t\tif (data.Private) {\n\t\t\t\tlogMessage(\"enteredPrivateRoom\", LogEntryType.plaintext, `${Player.Name} entered private room \"${data.Name}\"`);\n\t\t\t} else {\n\t\t\t\tlogMessage(\"enteredPublicRoom\", LogEntryType.plaintext, `${Player.Name} entered public room \"${data.Name}\"`);\n\t\t\t}\n\t\t\treturn next(args);\n\t\t}, ModuleCategory.Log);\n\t}\n\n\treload() {\n\t\tthis.load();\n\t}\n}\n","import { moduleInitPhase } from \"../moduleManager\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { capitalizeFirstLetter, isObject } from \"../utils\";\nimport { ChatroomCharacter, getChatroomCharacter } from \"../characters\";\nimport { modStorage, modStorageSync } from \"./storage\";\nimport { notifyOfChange, queryHandlers } from \"./messaging\";\nimport { LogEntryType, logMessage } from \"./log\";\nimport { ChatRoomSendLocal } from \"../utilsClub\";\nimport { moduleIsEnabled } from \"./presets\";\nimport { ModuleCategory, ModuleInitPhase, Preset } from \"../constants\";\n\nexport enum AccessLevel {\n\tself = 0,\n\tclubowner = 1,\n\towner = 2,\n\tlover = 3,\n\tmistress = 4,\n\twhitelist = 5,\n\tfriend = 6,\n\tpublic = 7\n}\n\nexport interface PermissionSetup {\n\treadonly name: string;\n\treadonly category: ModuleCategory;\n\treadonly defaults: {\n\t\treadonly [p in Preset]: readonly [boolean, AccessLevel];\n\t}\n}\n\nexport interface PermissionInfo extends PermissionSetup {\n\tself: boolean;\n\tmin: AccessLevel;\n}\n\nexport type PermissionData = Partial<Record<BCX_Permissions, PermissionInfo>>;\n\nconst permissions: Map<BCX_Permissions, PermissionInfo> = new Map();\n\nexport function registerPermission(name: BCX_Permissions, data: PermissionSetup) {\n\tif (moduleInitPhase !== ModuleInitPhase.init) {\n\t\tthrow new Error(\"Permissions can be registered only during init\");\n\t}\n\tif (permissions.has(name)) {\n\t\tthrow new Error(`Permission \"${name}\" already defined!`);\n\t}\n\tfor (const [k, v] of Object.entries(data.defaults)) {\n\t\tif (v[1] === AccessLevel.self && !v[0]) {\n\t\t\tconsole.error(`BCX: register permission \"${name}\": default for ${k} has invalid self value`);\n\t\t}\n\t}\n\tpermissions.set(name, {\n\t\t...data,\n\t\tself: data.defaults[Preset.switch][0],\n\t\tmin: data.defaults[Preset.switch][1]\n\t});\n}\n\nexport function getCharacterAccessLevel(character: ChatroomCharacter): AccessLevel {\n\tif (character.isPlayer()) return AccessLevel.self;\n\tif (character.MemberNumber !== null) {\n\t\tif (Player.IsOwnedByMemberNumber(character.MemberNumber)) return AccessLevel.clubowner;\n\t\tif (modStorage.owners?.includes(character.MemberNumber)) return AccessLevel.owner;\n\t\tif (Player.IsLoverOfMemberNumber(character.MemberNumber)) return AccessLevel.lover;\n\t\tif (modStorage.mistresses?.includes(character.MemberNumber)) return AccessLevel.mistress;\n\t\tif (Player.WhiteList.includes(character.MemberNumber)) return AccessLevel.whitelist;\n\t\tif (Player.FriendList?.includes(character.MemberNumber)) return AccessLevel.friend;\n\t}\n\treturn AccessLevel.public;\n}\n\nexport function checkPermissionAccess(permission: BCX_Permissions, character: ChatroomCharacter): boolean {\n\tconst permData = permissions.get(permission);\n\tif (!permData) {\n\t\tconsole.error(new Error(`Check for unknown permission \"${permission}\"`));\n\t\treturn false;\n\t}\n\tif (!character.hasAccessToPlayer())\n\t\treturn false;\n\tif (!moduleIsEnabled(permData.category))\n\t\treturn false;\n\treturn checkPermisionAccesData(permData, getCharacterAccessLevel(character));\n}\n\nexport function checkPermisionAccesData(permData: PermissionInfo, accessLevel: AccessLevel): boolean {\n\tif (accessLevel === AccessLevel.self) {\n\t\treturn permData.self || permData.min === AccessLevel.self;\n\t}\n\treturn accessLevel <= permData.min;\n}\n\nfunction permissionsMakeBundle(): PermissionsBundle {\n\tconst res: PermissionsBundle = {};\n\tfor (const [k, v] of permissions.entries()) {\n\t\tif (!moduleIsEnabled(v.category))\n\t\t\tcontinue;\n\t\tres[k] = [v.self, v.min];\n\t}\n\treturn res;\n}\n\nexport function getPermissionDataFromBundle(bundle: PermissionsBundle): PermissionData {\n\tconst res: PermissionData = {};\n\tfor (const [k, v] of permissions.entries()) {\n\t\tif (bundle[k]) {\n\t\t\tres[k] = {\n\t\t\t\t...v,\n\t\t\t\tself: bundle[k][0],\n\t\t\t\tmin: bundle[k][1]\n\t\t\t};\n\t\t}\n\t}\n\n\treturn res;\n}\n\nexport function setPermissionSelfAccess(permission: BCX_Permissions, self: boolean, characterToCheck: ChatroomCharacter | null): boolean {\n\tconst permData = permissions.get(permission);\n\tif (!permData) {\n\t\tthrow new Error(`Attempt to edit unknown permission \"${permission}\"`);\n\t}\n\n\tif (!moduleIsEnabled(permData.category))\n\t\treturn false;\n\n\tself = self || permData.min === AccessLevel.self;\n\n\tif (permData.self === self) return true;\n\n\tif (characterToCheck) {\n\t\tif (!checkPermissionAccess(self ? \"authority_grant_self\" : \"authority_revoke_self\", characterToCheck) ||\n\t\t\t!characterToCheck.isPlayer() && !checkPermissionAccess(permission, characterToCheck)\n\t\t) {\n\t\t\tconsole.warn(`BCX: Unauthorized self permission edit attempt for \"${permission}\" by ${characterToCheck}`);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (characterToCheck) {\n\t\tconst msg = `${characterToCheck} ` +\n\t\t\t(self ? `gave ${characterToCheck.isPlayer() ? \"herself\" : Player.Name}` : `removed ${characterToCheck?.isPlayer() ? \"her\" : Player.Name + \"'s\"}`) +\n\t\t\t` control over permission \"${permData.name}\"`;\n\t\tlogMessage(\"permissionChange\", LogEntryType.plaintext, msg);\n\t\tif (!characterToCheck.isPlayer()) {\n\t\t\tChatRoomSendLocal(msg, undefined, characterToCheck.MemberNumber);\n\t\t}\n\t}\n\n\tpermData.self = self;\n\tpermissionsSync();\n\tnotifyOfChange();\n\n\treturn true;\n}\n\nexport function setPermissionMinAccess(permission: BCX_Permissions, min: AccessLevel, characterToCheck: ChatroomCharacter | null): boolean {\n\tconst permData = permissions.get(permission);\n\tif (!permData) {\n\t\tthrow new Error(`Attempt to edit unknown permission \"${permission}\"`);\n\t}\n\n\tif (!moduleIsEnabled(permData.category))\n\t\treturn false;\n\n\tif (permData.min === min) return true;\n\n\tif (characterToCheck) {\n\t\tconst allowed =\n\t\t\t// Exception: Player can always lower permissions \"Self\"->\"Owner\"\n\t\t\t(characterToCheck.isPlayer() && permData.min < min && min <= AccessLevel.owner) ||\n\t\t\t(\n\t\t\t\t// Character must have access to \"allow minimal access modification\"\n\t\t\t\tcheckPermissionAccess(\"authority_edit_min\", characterToCheck) &&\n\t\t\t\t(\n\t\t\t\t\t// Character must have access to target rule\n\t\t\t\t\tcheckPermissionAccess(permission, characterToCheck) ||\n\t\t\t\t\t// Exception: Player bypasses this check when lowering \"minimal access\"\n\t\t\t\t\tcharacterToCheck.isPlayer() && min >= permData.min\n\t\t\t\t) &&\n\t\t\t\t(\n\t\t\t\t\t// Not player must have access to target level\n\t\t\t\t\t!characterToCheck.isPlayer() ||\n\t\t\t\t\tgetCharacterAccessLevel(characterToCheck) <= min\n\t\t\t\t)\n\t\t\t);\n\t\tif (!allowed) {\n\t\t\tconsole.warn(`BCX: Unauthorized min permission edit attempt for \"${permission}\" by ${characterToCheck}`);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (characterToCheck) {\n\t\tconst msg = `${characterToCheck} changed permission \"${permData.name}\" from ` +\n\t\t\t`\"${getPermissionMinDisplayText(permData.min, characterToCheck)}\" to \"${getPermissionMinDisplayText(min, characterToCheck)}\"`;\n\t\tlogMessage(\"permissionChange\", LogEntryType.plaintext, msg);\n\t\tif (!characterToCheck.isPlayer()) {\n\t\t\tChatRoomSendLocal(msg, undefined, characterToCheck.MemberNumber);\n\t\t}\n\t}\n\n\tpermData.min = min;\n\tif (min === AccessLevel.self) {\n\t\tpermData.self = true;\n\t}\n\tpermissionsSync();\n\tnotifyOfChange();\n\n\treturn true;\n}\n\nfunction permissionsSync() {\n\tmodStorage.permissions = permissionsMakeBundle();\n\tmodStorageSync();\n}\n\nexport function getPlayerPermissionSettings(): PermissionData {\n\tconst res: PermissionData = {};\n\tfor (const [k, v] of permissions.entries()) {\n\t\tif (!moduleIsEnabled(v.category))\n\t\t\tcontinue;\n\t\tres[k] = { ...v };\n\t}\n\treturn res;\n}\n\nexport function getPermissionMinDisplayText(minAccess: AccessLevel, character?: ChatroomCharacter): string {\n\tif (minAccess === AccessLevel.self) {\n\t\treturn character ? character.Name : \"Self\";\n\t}\n\treturn capitalizeFirstLetter(AccessLevel[minAccess]);\n}\n\nexport function getPlayerRoleData(character: ChatroomCharacter): PermissionRoleBundle {\n\tconst loadNames = (memberNumber: number): [number, string] => [memberNumber, Player.FriendNames?.get(memberNumber) ?? \"\"];\n\n\treturn {\n\t\tmistresses: (modStorage.mistresses ?? []).map(loadNames),\n\t\towners: (modStorage.owners ?? []).map(loadNames),\n\t\tallowAddMistress: checkPermissionAccess(\"authority_mistress_add\", character),\n\t\tallowRemoveMistress: checkPermissionAccess(\"authority_mistress_remove\", character),\n\t\tallowAddOwner: checkPermissionAccess(\"authority_owner_add\", character),\n\t\tallowRemoveOwner: checkPermissionAccess(\"authority_owner_remove\", character)\n\t};\n}\n\nexport function editRole(role: \"owner\" | \"mistress\", action: \"add\" | \"remove\", target: number, character: ChatroomCharacter | null): boolean {\n\tif (target === Player.MemberNumber)\n\t\treturn false;\n\n\tif (!modStorage.owners || !modStorage.mistresses) {\n\t\tthrow new Error(\"Not initialized\");\n\t}\n\n\tif (character) {\n\t\tlet permissionToCheck: BCX_Permissions = \"authority_mistress_add\";\n\t\tif (role === \"mistress\" && action === \"remove\")\n\t\t\tpermissionToCheck = \"authority_mistress_remove\";\n\t\telse if (role === \"owner\" && action === \"add\")\n\t\t\tpermissionToCheck = \"authority_owner_add\";\n\t\telse if (role === \"owner\" && action === \"remove\")\n\t\t\tpermissionToCheck = \"authority_owner_remove\";\n\n\t\tif (!checkPermissionAccess(permissionToCheck, character) && (action !== \"remove\" || target !== character.MemberNumber))\n\t\t\treturn false;\n\n\t\tif (\n\t\t\trole === \"mistress\" && action === \"add\" && modStorage.owners.includes(target) && !checkPermissionAccess(\"authority_owner_remove\", character)\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (\n\t\trole === \"owner\" && action === \"remove\" && !modStorage.owners.includes(target) ||\n\t\trole === \"mistress\" && action === \"remove\" && !modStorage.mistresses.includes(target)\n\t) {\n\t\treturn true;\n\t}\n\n\tconst ownerIndex = modStorage.owners.indexOf(target);\n\tif (ownerIndex >= 0) {\n\t\tmodStorage.owners.splice(ownerIndex, 1);\n\t}\n\n\tconst mistressIndex = modStorage.mistresses.indexOf(target);\n\tif (mistressIndex >= 0) {\n\t\tmodStorage.mistresses.splice(mistressIndex, 1);\n\t}\n\n\tif (action === \"add\") {\n\t\tif (role === \"owner\") {\n\t\t\tmodStorage.owners.push(target);\n\t\t} else if (role === \"mistress\") {\n\t\t\tmodStorage.mistresses.push(target);\n\t\t}\n\t}\n\n\tmodStorageSync();\n\tnotifyOfChange();\n\treturn true;\n}\n\nexport class ModuleAuthority extends BaseModule {\n\tinit() {\n\t\tregisterPermission(\"authority_grant_self\", {\n\t\t\tname: \"Allow granting self access\",\n\t\t\tcategory: ModuleCategory.Authority,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.self],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.self],\n\t\t\t\t[Preset.submissive]: [false, AccessLevel.owner],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.owner]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"authority_revoke_self\", {\n\t\t\tname: \"Allow forbidding self access\",\n\t\t\tcategory: ModuleCategory.Authority,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.self],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.self],\n\t\t\t\t[Preset.submissive]: [true, AccessLevel.self],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.owner]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"authority_edit_min\", {\n\t\t\tname: \"Allow minimal access modification\",\n\t\t\tcategory: ModuleCategory.Authority,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.self],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.self],\n\t\t\t\t[Preset.submissive]: [true, AccessLevel.self],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.owner]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"authority_mistress_add\", {\n\t\t\tname: \"Allow granting Mistress status\",\n\t\t\tcategory: ModuleCategory.Authority,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.self],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.self],\n\t\t\t\t[Preset.submissive]: [true, AccessLevel.lover],\n\t\t\t\t[Preset.slave]: [true, AccessLevel.mistress]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"authority_mistress_remove\", {\n\t\t\tname: \"Allow revoking Mistress status\",\n\t\t\tcategory: ModuleCategory.Authority,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.self],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.self],\n\t\t\t\t[Preset.submissive]: [false, AccessLevel.lover],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.lover]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"authority_owner_add\", {\n\t\t\tname: \"Allow granting Owner status\",\n\t\t\tcategory: ModuleCategory.Authority,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.self],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.self],\n\t\t\t\t[Preset.submissive]: [true, AccessLevel.clubowner],\n\t\t\t\t[Preset.slave]: [true, AccessLevel.owner]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"authority_owner_remove\", {\n\t\t\tname: \"Allow revoking Owner status\",\n\t\t\tcategory: ModuleCategory.Authority,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.self],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.self],\n\t\t\t\t[Preset.submissive]: [false, AccessLevel.clubowner],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.clubowner]\n\t\t\t}\n\t\t});\n\n\t\tqueryHandlers.permissions = (sender, resolve) => {\n\t\t\tresolve(true, permissionsMakeBundle());\n\t\t};\n\t\tqueryHandlers.permissionAccess = (sender, resolve, data) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character && typeof data === \"string\") {\n\t\t\t\tresolve(true, checkPermissionAccess(data, character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.myAccessLevel = (sender, resolve) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character) {\n\t\t\t\tresolve(true, getCharacterAccessLevel(character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.editPermission = (sender, resolve, data) => {\n\t\t\tif (!isObject(data) ||\n\t\t\t\ttypeof data.permission !== \"string\" ||\n\t\t\t\t(data.edit !== \"min\" && data.edit !== \"self\") ||\n\t\t\t\t(data.edit === \"min\" && typeof data.target !== \"number\") ||\n\t\t\t\t(data.edit === \"self\" && typeof data.target !== \"boolean\")\n\t\t\t) {\n\t\t\t\tconsole.warn(`BCX: Bad editPermission query from ${sender}`, data);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (!character) {\n\t\t\t\tconsole.warn(`BCX: editPermission query from ${sender}; not found in room`, data);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\n\t\t\tif (!permissions.has(data.permission)) {\n\t\t\t\tconsole.warn(`BCX: editPermission query from ${sender}; unknown permission`, data);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\n\t\t\tif (data.edit === \"self\") {\n\t\t\t\tif (typeof data.target !== \"boolean\") {\n\t\t\t\t\tthrow new Error(\"Assertion failed\");\n\t\t\t\t}\n\t\t\t\treturn resolve(true, setPermissionSelfAccess(data.permission, data.target, character));\n\t\t\t} else {\n\t\t\t\tif (typeof data.target !== \"number\") {\n\t\t\t\t\tthrow new Error(\"Assertion failed\");\n\t\t\t\t}\n\t\t\t\tif (AccessLevel[data.target] === undefined) {\n\t\t\t\t\tconsole.warn(`BCX: editPermission query from ${sender}; unknown access level`, data);\n\t\t\t\t\treturn resolve(true, false);\n\t\t\t\t}\n\t\t\t\treturn resolve(true, setPermissionMinAccess(data.permission, data.target, character));\n\t\t\t}\n\t\t};\n\n\t\tqueryHandlers.rolesData = (sender, resolve) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (!character) {\n\t\t\t\tconsole.warn(`BCX: rolesData query from ${sender}; not found in room`);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\n\t\t\tconst accessLevel = getCharacterAccessLevel(character);\n\t\t\tif (accessLevel > AccessLevel.mistress) {\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\n\t\t\tresolve(true, getPlayerRoleData(character));\n\t\t};\n\n\t\tqueryHandlers.editRole = (sender, resolve, data) => {\n\t\t\tif (!isObject(data) ||\n\t\t\t\tdata.type !== \"owner\" && data.type !== \"mistress\" ||\n\t\t\t\tdata.action !== \"add\" && data.action !== \"remove\" ||\n\t\t\t\ttypeof data.target !== \"number\"\n\t\t\t) {\n\t\t\t\tconsole.warn(`BCX: Bad editRole query from ${sender}`, data);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (!character) {\n\t\t\t\tconsole.warn(`BCX: editRole query from ${sender}; not found in room`, data);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\n\t\t\tresolve(true, editRole(data.type, data.action, data.target, character));\n\t\t};\n\t}\n\n\tprivate setDefultPermissionsForPreset(preset: Preset) {\n\t\tfor (const permission of permissions.values()) {\n\t\t\tpermission.self = permission.defaults[preset][0];\n\t\t\tpermission.min = permission.defaults[preset][1];\n\t\t}\n\t}\n\n\tapplyPreset(preset: Preset) {\n\t\tthis.setDefultPermissionsForPreset(preset);\n\t\tmodStorage.permissions = permissionsMakeBundle();\n\t}\n\n\tload(preset: Preset) {\n\t\tthis.setDefultPermissionsForPreset(preset);\n\n\t\tif (isObject(modStorage.permissions)) {\n\t\t\tfor (const [k, v] of Object.entries(modStorage.permissions)) {\n\t\t\t\tconst perm = permissions.get(k as BCX_Permissions);\n\t\t\t\tif (!Array.isArray(v) || typeof v[0] !== \"boolean\" || typeof v[1] !== \"number\") {\n\t\t\t\t\tconsole.warn(`BCX: Storage: bad permission ${k}`);\n\t\t\t\t} else if (AccessLevel[v[1]] === undefined) {\n\t\t\t\t\tconsole.warn(`BCX: Storage: bad permission ${k} level ${v[1]}`);\n\t\t\t\t} else if (perm === undefined) {\n\t\t\t\t\tconsole.warn(`BCX: Storage: unknown permission ${k}`);\n\t\t\t\t} else {\n\t\t\t\t\tperm.self = v[0];\n\t\t\t\t\tperm.min = v[1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmodStorage.permissions = permissionsMakeBundle();\n\n\t\tconst seen = new Set<number>();\n\t\tconst test = (i: number): boolean => {\n\t\t\tif (typeof i !== \"number\" || i === Player.MemberNumber || seen.has(i))\n\t\t\t\treturn false;\n\t\t\tseen.add(i);\n\t\t\treturn true;\n\t\t};\n\t\tif (!Array.isArray(modStorage.owners)) {\n\t\t\tmodStorage.owners = [];\n\t\t} else {\n\t\t\tmodStorage.owners = modStorage.owners.filter(test);\n\t\t}\n\t\tif (!Array.isArray(modStorage.mistresses)) {\n\t\t\tmodStorage.mistresses = [];\n\t\t} else {\n\t\t\tmodStorage.mistresses = modStorage.mistresses.filter(test);\n\t\t}\n\t}\n\n\treload(preset: Preset) {\n\t\tthis.load(preset);\n\t}\n}\n","import { ChatroomCharacter, getChatroomCharacter } from \"../characters\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { arrayUnique, isObject } from \"../utils\";\nimport { ChatRoomActionMessage, ChatRoomSendLocal, getVisibleGroupName } from \"../utilsClub\";\nimport { AccessLevel, checkPermissionAccess, registerPermission } from \"./authority\";\nimport { notifyOfChange, queryHandlers } from \"./messaging\";\nimport { modStorage, modStorageSync } from \"./storage\";\nimport { LogEntryType, logMessage } from \"./log\";\nimport { moduleIsEnabled } from \"./presets\";\nimport { ModuleCategory, Preset } from \"../constants\";\nimport { hookFunction } from \"../patching\";\n\nconst CURSES_CHECK_INTERVAL = 2000;\nconst CURSES_ANTILOOP_RESET_INTERVAL = 60_000;\nconst CURSES_ANTILOOP_THRESHOLD = 10;\nconst CURSES_ANTILOOP_SUSPEND_TIME = 600_000;\n\nconst CURSE_IGNORED_PROPERTIES = ValidationModifiableProperties.slice();\nconst CURSE_IGNORED_EFFECTS = [\"Lock\"];\n\nexport function curseItem(Group: string, curseProperty: boolean | null, character: ChatroomCharacter | null): boolean {\n\tif (!moduleIsEnabled(ModuleCategory.Curses))\n\t\treturn false;\n\n\tconst group = AssetGroup.find(g => g.Name === Group);\n\n\tif (!group || (typeof curseProperty !== \"boolean\" && curseProperty !== null) || !modStorage.cursedItems) {\n\t\tconsole.error(`BCX: Attempt to curse with invalid data`, Group, curseProperty);\n\t\treturn false;\n\t}\n\n\tif (group.Category === \"Appearance\" && !group.Clothing) {\n\t\tconsole.warn(`BCX: Attempt to curse body`, Group);\n\t\treturn false;\n\t}\n\n\tif (character) {\n\t\tconst existingCurse = modStorage.cursedItems[Group];\n\t\tif (existingCurse) {\n\t\t\tif (curseProperty === null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!checkPermissionAccess(curseProperty ? \"curses_curse\" : \"curses_lift\", character)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else if (!checkPermissionAccess(\"curses_curse\", character)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tconst currentItem = InventoryGet(Player, Group);\n\n\tif (currentItem) {\n\n\t\tif (curseProperty === null) {\n\t\t\tconst Asset = currentItem.Asset;\n\t\t\tif (Asset.Extended && Asset.Archetype === \"typed\") {\n\t\t\t\tcurseProperty = true;\n\t\t\t} else {\n\t\t\t\tcurseProperty = false;\n\t\t\t}\n\t\t}\n\n\t\tconst newCurse: CursedItemInfo = modStorage.cursedItems[Group] = {\n\t\t\tName: currentItem.Asset.Name,\n\t\t\tcurseProperty\n\t\t};\n\t\tif (currentItem.Color && currentItem.Color !== \"Default\") {\n\t\t\tnewCurse.Color = JSON.parse(JSON.stringify(currentItem.Color));\n\t\t}\n\t\tif (currentItem.Difficulty) {\n\t\t\tnewCurse.Difficulty = currentItem.Difficulty;\n\t\t}\n\t\tif (currentItem.Property && Object.keys(currentItem.Property).filter(i => !CURSE_IGNORED_PROPERTIES.includes(i)).length !== 0) {\n\t\t\tnewCurse.Property = JSON.parse(JSON.stringify(currentItem.Property));\n\t\t\tif (newCurse.Property) {\n\t\t\t\tfor (const key of CURSE_IGNORED_PROPERTIES) {\n\t\t\t\t\tdelete newCurse.Property[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (character) {\n\t\t\tlogMessage(\"curseChange\", LogEntryType.plaintext, `${character} cursed ${Player.Name}'s ${currentItem.Asset.Description}`);\n\t\t\tif (!character.isPlayer()) {\n\t\t\t\tChatRoomSendLocal(`${character} cursed the ${currentItem.Asset.Description} on you`);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tmodStorage.cursedItems[Group] = null;\n\t\tif (character) {\n\t\t\tlogMessage(\"curseChange\", LogEntryType.plaintext, `${character} cursed ${Player.Name}'s body part to stay exposed (${getVisibleGroupName(group)})`);\n\t\t\tif (!character.isPlayer()) {\n\t\t\t\tChatRoomSendLocal(`${character} put a curse on you, forcing part of your body to stay exposed (${getVisibleGroupName(group)})`);\n\t\t\t}\n\t\t}\n\t}\n\n\tmodStorageSync();\n\tnotifyOfChange();\n\treturn true;\n}\n\nexport function curseLift(Group: string, character: ChatroomCharacter | null): boolean {\n\tif (!moduleIsEnabled(ModuleCategory.Curses))\n\t\treturn false;\n\n\tif (character && !checkPermissionAccess(\"curses_lift\", character))\n\t\treturn false;\n\n\tif (modStorage.cursedItems && modStorage.cursedItems[Group] !== undefined) {\n\t\tconst group = AssetGroup.find(g => g.Name === Group);\n\t\tif (character && group) {\n\t\t\tconst itemName = modStorage.cursedItems[Group] && AssetGet(Player.AssetFamily, Group, modStorage.cursedItems[Group]!.Name)?.Description;\n\t\t\tif (itemName) {\n\t\t\t\tlogMessage(\"curseChange\", LogEntryType.plaintext, `${character} lifted the curse on ${Player.Name}'s ${itemName}`);\n\t\t\t\tif (!character.isPlayer()) {\n\t\t\t\t\tChatRoomSendLocal(`${character} lifted the curse on your ${itemName}`);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlogMessage(\"curseChange\", LogEntryType.plaintext, `${character} lifted the curse on ${Player.Name}'s body part (${getVisibleGroupName(group)})`);\n\t\t\t\tif (!character.isPlayer()) {\n\t\t\t\t\tChatRoomSendLocal(`${character} lifted the curse on part of your body (${getVisibleGroupName(group)})`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdelete modStorage.cursedItems[Group];\n\t\tmodStorageSync();\n\t\tnotifyOfChange();\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function curseGetInfo(character: ChatroomCharacter): BCX_curseInfo {\n\tconst res: BCX_curseInfo = {\n\t\tallowCurse: checkPermissionAccess(\"curses_curse\", character),\n\t\tallowLift: checkPermissionAccess(\"curses_lift\", character),\n\t\tcurses: {}\n\t};\n\n\tfor (const [group, info] of Object.entries(modStorage.cursedItems ?? {})) {\n\t\tres.curses[group] = info === null ? null : {\n\t\t\tName: info.Name,\n\t\t\tcurseProperties: info.curseProperty\n\t\t};\n\t}\n\n\treturn res;\n}\n\nexport class ModuleCurses extends BaseModule {\n\tprivate timer: number | null = null;\n\tprivate resetTimer: number | null = null;\n\tprivate triggerCounts: Map<string, number> = new Map();\n\tprivate suspendedUntil: number | null = null;\n\n\tinit() {\n\t\tregisterPermission(\"curses_curse\", {\n\t\t\tname: \"Allow cursing objects or the body\",\n\t\t\tcategory: ModuleCategory.Curses,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.lover],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.lover],\n\t\t\t\t[Preset.submissive]: [false, AccessLevel.mistress],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.mistress]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"curses_lift\", {\n\t\t\tname: \"Allow lifting curses\",\n\t\t\tcategory: ModuleCategory.Curses,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.lover],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.lover],\n\t\t\t\t[Preset.submissive]: [false, AccessLevel.mistress],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.mistress]\n\t\t\t}\n\t\t});\n\t\tregisterPermission(\"curses_color\", {\n\t\t\tname: \"Allow changing colors of cursed objects\",\n\t\t\tcategory: ModuleCategory.Curses,\n\t\t\tdefaults: {\n\t\t\t\t[Preset.dominant]: [true, AccessLevel.lover],\n\t\t\t\t[Preset.switch]: [true, AccessLevel.lover],\n\t\t\t\t[Preset.submissive]: [true, AccessLevel.mistress],\n\t\t\t\t[Preset.slave]: [false, AccessLevel.mistress]\n\t\t\t}\n\t\t});\n\n\t\tqueryHandlers.curseGetInfo = (sender, resolve) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character) {\n\t\t\t\tresolve(true, curseGetInfo(character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.curseItem = (sender, resolve, data) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character && isObject(data) && typeof data.Group === \"string\" && (typeof data.curseProperties === \"boolean\" || data.curseProperties === null)) {\n\t\t\t\tresolve(true, curseItem(data.Group, data.curseProperties, character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t\tqueryHandlers.curseLift = (sender, resolve, data) => {\n\t\t\tconst character = getChatroomCharacter(sender);\n\t\t\tif (character && typeof data === \"string\") {\n\t\t\t\tresolve(true, curseLift(data, character));\n\t\t\t} else {\n\t\t\t\tresolve(false);\n\t\t\t}\n\t\t};\n\t}\n\n\tload() {\n\t\tif (!moduleIsEnabled(ModuleCategory.Curses)) {\n\t\t\tdelete modStorage.cursedItems;\n\t\t\treturn;\n\t\t}\n\n\t\thookFunction(\"ValidationResolveModifyDiff\", 0, (args, next) => {\n\t\t\tconst params = args[2] as AppearanceUpdateParameters;\n\t\t\tconst result = next(args) as ItemDiffResolution;\n\n\t\t\tif (params.C.ID === 0 && result.item) {\n\t\t\t\tconst curse = modStorage.cursedItems?.[result.item.Asset.Group.Name];\n\t\t\t\tconst character = getChatroomCharacter(params.sourceMemberNumber);\n\t\t\t\tif (curse &&\n\t\t\t\t\t!CommonColorsEqual(curse.Color ?? \"Default\", result.item.Color ?? \"Default\") &&\n\t\t\t\t\tcharacter &&\n\t\t\t\t\tcheckPermissionAccess(\"curses_color\", character)\n\t\t\t\t) {\n\t\t\t\t\tif (result.item.Color && result.item.Color !== \"Default\") {\n\t\t\t\t\t\tcurse.Color = JSON.parse(JSON.stringify(result.item.Color));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete curse.Color;\n\t\t\t\t\t}\n\t\t\t\t\tmodStorageSync();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}, ModuleCategory.Curses);\n\n\t\tif (!isObject(modStorage.cursedItems)) {\n\t\t\tmodStorage.cursedItems = {};\n\t\t} else {\n\t\t\tfor (const [group, info] of Object.entries(modStorage.cursedItems)) {\n\t\t\t\tif (!AssetGroup.some(g => g.Name === group)) {\n\t\t\t\t\tconsole.warn(`BCX: Unknown cursed group ${group}, removing it`, info);\n\t\t\t\t\tdelete modStorage.cursedItems[group];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (info === null)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (!isObject(info) ||\n\t\t\t\t\ttypeof info.Name !== \"string\" ||\n\t\t\t\t\ttypeof info.curseProperty !== \"boolean\"\n\t\t\t\t) {\n\t\t\t\t\tconsole.error(`BCX: Bad data for cursed item in group ${group}, removing it`, info);\n\t\t\t\t\tdelete modStorage.cursedItems[group];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (AssetGet(\"Female3DCG\", group, info.Name) == null) {\n\t\t\t\t\tconsole.warn(`BCX: Unknown cursed item ${group}:${info.Name}, removing it`, info);\n\t\t\t\t\tdelete modStorage.cursedItems[group];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trun() {\n\t\tif (!moduleIsEnabled(ModuleCategory.Curses))\n\t\t\treturn;\n\n\t\tthis.timer = setInterval(() => this.cursesTick(), CURSES_CHECK_INTERVAL);\n\t\tthis.resetTimer = setInterval(() => {\n\t\t\tthis.triggerCounts.clear();\n\t\t}, CURSES_ANTILOOP_RESET_INTERVAL);\n\t}\n\n\tunload() {\n\t\tif (this.timer !== null) {\n\t\t\tclearInterval(this.timer);\n\t\t\tthis.timer = null;\n\t\t}\n\t\tif (this.resetTimer !== null) {\n\t\t\tclearInterval(this.resetTimer);\n\t\t\tthis.resetTimer = null;\n\t\t}\n\t}\n\n\treload() {\n\t\tthis.unload();\n\t\tthis.load();\n\t\tthis.run();\n\t}\n\n\tprivate cursesTick() {\n\t\tif (!ServerIsConnected || !modStorage.cursedItems)\n\t\t\treturn;\n\n\t\tif (this.suspendedUntil !== null) {\n\t\t\tif (Date.now() >= this.suspendedUntil) {\n\t\t\t\tthis.suspendedUntil = null;\n\t\t\t\tthis.triggerCounts.clear();\n\t\t\t\tChatRoomActionMessage(`The dormant curse on ${Player.Name}'s body wakes up again.`);\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst lastState = JSON.stringify(modStorage.cursedItems);\n\n\t\tfor (const [group, curse] of Object.entries(modStorage.cursedItems)) {\n\n\t\t\tif (curse === null) {\n\t\t\t\tconst current = InventoryGet(Player, group);\n\t\t\t\tif (current) {\n\t\t\t\t\tInventoryRemove(Player, group, false);\n\t\t\t\t\tCharacterRefresh(Player, true);\n\t\t\t\t\tChatRoomCharacterUpdate(Player);\n\t\t\t\t\tChatRoomActionMessage(`${Player.Name}'s body seems to be cursed and the ${current.Asset.Description} just falls off her body`);\n\t\t\t\t\tlogMessage(\"curseTrigger\", LogEntryType.plaintext, `The curse on ${Player.Name}'s body prevented a ${current.Asset.Description} from being added to it`);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\n\t\t\tconst asset = AssetGet(\"Female3DCG\", group, curse.Name);\n\t\t\tif (!asset) {\n\t\t\t\tconsole.error(`BCX: Asset not found for curse ${group}:${curse.Name}`, curse);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet changeType: \"\" | \"add\" | \"swap\" | \"update\" | \"color\" = \"\";\n\t\t\tconst CHANGE_TEXTS: Record<string, string> = {\n\t\t\t\tadd: `The curse on ${Player.Name}'s ${asset.Description} wakes up and the item reappears`,\n\t\t\t\tswap: `The curse on ${Player.Name}'s ${asset.Description} wakes up, not allowing the item to be replaced by another item`,\n\t\t\t\tupdate: `The curse on ${Player.Name}'s ${asset.Description} wakes up and undos all changes to the item`,\n\t\t\t\tcolor: `The curse on ${Player.Name}'s ${asset.Description} wakes up, changing the color of the item back`\n\t\t\t};\n\t\t\tconst CHANGE_LOGS: Record<string, string> = {\n\t\t\t\tadd: `The curse on ${Player.Name}'s ${asset.Description} made the item reappear`,\n\t\t\t\tswap: `The curse on ${Player.Name}'s ${asset.Description} prevented replacing the item`,\n\t\t\t\tupdate: `The curse on ${Player.Name}'s ${asset.Description} reverted all changes to the item`,\n\t\t\t\tcolor: `The curse on ${Player.Name}'s ${asset.Description} reverted the color of the item`\n\t\t\t};\n\n\t\t\tlet currentItem = InventoryGet(Player, group);\n\n\t\t\tif (currentItem && currentItem.Asset.Name !== curse.Name) {\n\t\t\t\tInventoryRemove(Player, group, false);\n\t\t\t\tchangeType = \"swap\";\n\t\t\t\tcurrentItem = null;\n\t\t\t}\n\n\t\t\tif (!currentItem) {\n\t\t\t\tcurrentItem = {\n\t\t\t\t\tAsset: asset,\n\t\t\t\t\tColor: curse.Color != null ? JSON.parse(JSON.stringify(curse.Color)) : \"Default\",\n\t\t\t\t\tProperty: curse.Property != null ? JSON.parse(JSON.stringify(curse.Property)) : {},\n\t\t\t\t\tDifficulty: curse.Difficulty != null ? curse.Difficulty : 0\n\t\t\t\t};\n\t\t\t\tPlayer.Appearance.push(currentItem);\n\t\t\t\tif (!changeType) changeType = \"add\";\n\t\t\t}\n\n\t\t\tconst itemProperty = currentItem.Property = (currentItem.Property ?? {});\n\t\t\tlet curseProperty = curse.Property ?? {};\n\n\t\t\tif (curse.curseProperty) {\n\t\t\t\tfor (const key of arrayUnique(Object.keys(curseProperty).concat(Object.keys(itemProperty)))) {\n\t\t\t\t\tif (key === \"Effect\")\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (CURSE_IGNORED_PROPERTIES.includes(key)) {\n\t\t\t\t\t\tif (curseProperty[key] !== undefined) {\n\t\t\t\t\t\t\tdelete curseProperty[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (curseProperty[key] === undefined) {\n\t\t\t\t\t\tif (itemProperty[key] !== undefined) {\n\t\t\t\t\t\t\tdelete itemProperty[key];\n\t\t\t\t\t\t\tif (!changeType) changeType = \"update\";\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (typeof curseProperty[key] !== typeof itemProperty[key] ||\n\t\t\t\t\t\tJSON.stringify(curseProperty[key]) !== JSON.stringify(itemProperty[key])\n\t\t\t\t\t) {\n\t\t\t\t\t\titemProperty[key] = JSON.parse(JSON.stringify(curseProperty[key]));\n\t\t\t\t\t\tif (!changeType) changeType = \"update\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst itemIgnoredEffects = Array.isArray(itemProperty.Effect) ? itemProperty.Effect.filter(i => CURSE_IGNORED_EFFECTS.includes(i)) : [];\n\t\t\t\tconst itemEffects = Array.isArray(itemProperty.Effect) ? itemProperty.Effect.filter(i => !CURSE_IGNORED_EFFECTS.includes(i)) : [];\n\t\t\t\tconst curseEffects = Array.isArray(curseProperty.Effect) ? curseProperty.Effect.filter(i => !CURSE_IGNORED_EFFECTS.includes(i)) : [];\n\t\t\t\tif (!CommonArraysEqual(itemEffects, curseEffects)) {\n\t\t\t\t\titemProperty.Effect = curseEffects.concat(itemIgnoredEffects);\n\t\t\t\t} else if (Array.isArray(itemProperty.Effect) && itemProperty.Effect.length > 0) {\n\t\t\t\t\tcurseProperty.Effect = itemProperty.Effect.slice();\n\t\t\t\t} else {\n\t\t\t\t\tdelete curseProperty.Effect;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcurseProperty = JSON.parse(JSON.stringify(itemProperty));\n\t\t\t}\n\n\t\t\tif (Object.keys(curseProperty).length === 0) {\n\t\t\t\tdelete curse.Property;\n\t\t\t} else {\n\t\t\t\tcurse.Property = curseProperty;\n\t\t\t}\n\n\t\t\tif (!CommonColorsEqual(curse.Color ?? \"Default\", currentItem.Color ?? \"Default\")) {\n\t\t\t\tif (curse.Color === undefined || curse.Color === \"Default\") {\n\t\t\t\t\tdelete currentItem.Color;\n\t\t\t\t} else {\n\t\t\t\t\tcurrentItem.Color = JSON.parse(JSON.stringify(curse.Color));\n\t\t\t\t}\n\t\t\t\tif (!changeType) changeType = \"color\";\n\t\t\t}\n\n\t\t\tif (changeType) {\n\t\t\t\tCharacterRefresh(Player, true);\n\t\t\t\tChatRoomCharacterUpdate(Player);\n\t\t\t\tif (CHANGE_TEXTS[changeType]) {\n\t\t\t\t\tChatRoomActionMessage(CHANGE_TEXTS[changeType]);\n\t\t\t\t\tlogMessage(\"curseTrigger\", LogEntryType.plaintext, CHANGE_LOGS[changeType]);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error(`BCX: No chat message for curse action ${changeType}`);\n\t\t\t\t}\n\n\t\t\t\tconst counter = (this.triggerCounts.get(group) ?? 0) + 1;\n\t\t\t\tthis.triggerCounts.set(group, counter);\n\n\t\t\t\tif (counter >= CURSES_ANTILOOP_THRESHOLD) {\n\t\t\t\t\tChatRoomActionMessage(\"Protection triggered: Curses have been disabled for 10 minutes. Please refrain from triggering curses so rapidly, as it creates strain on the server and may lead to unwanted side effects! If you believe this message was triggered by a bug, please report it to BCX Discord.\");\n\t\t\t\t\tthis.suspendedUntil = Date.now() + CURSES_ANTILOOP_SUSPEND_TIME;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (JSON.stringify(modStorage.cursedItems) !== lastState) {\n\t\t\tmodStorageSync();\n\t\t}\n\t}\n}\n","import { VERSION } from \"./config\";\nimport { ModuleCategory, TOGGLEABLE_MODULES } from \"./constants\";\nimport { AccessLevel, checkPermissionAccess, editRole, getPermissionDataFromBundle, getPlayerPermissionSettings, getPlayerRoleData, PermissionData, setPermissionMinAccess, setPermissionSelfAccess } from \"./modules/authority\";\nimport { curseGetInfo, curseItem, curseLift } from \"./modules/curses\";\nimport { getVisibleLogEntries, LogAccessLevel, logClear, LogConfig, logConfigSet, LogEntry, logGetAllowedActions, logGetConfig, logMessageDelete, logPraise } from \"./modules/log\";\nimport { sendQuery } from \"./modules/messaging\";\nimport { getDisabledModules } from \"./modules/presets\";\nimport { modStorage } from \"./modules/storage\";\nimport { isObject } from \"./utils\";\n\nexport class ChatroomCharacter {\n\tisPlayer(): this is PlayerCharacter {\n\t\treturn false;\n\t}\n\n\tBCXVersion: string | null = null;\n\tCharacter: Character;\n\n\tget MemberNumber(): number {\n\t\tif (typeof this.Character.MemberNumber !== \"number\") {\n\t\t\tthrow new Error(\"Character without MemberNumber\");\n\t\t}\n\t\treturn this.Character.MemberNumber;\n\t}\n\n\tget Name(): string {\n\t\treturn this.Character.Name;\n\t}\n\n\ttoString(): string {\n\t\treturn `${this.Name} (${this.MemberNumber})`;\n\t}\n\n\tconstructor(character: Character) {\n\t\tthis.Character = character;\n\t\tif (character.ID === 0) {\n\t\t\tthis.BCXVersion = VERSION;\n\t\t}\n\t\tconsole.debug(`BCX: Loaded character ${character.Name} (${character.MemberNumber})`);\n\t}\n\n\tgetDisabledModules(): Promise<ModuleCategory[]> {\n\t\treturn sendQuery(\"disabledModules\", undefined, this.MemberNumber).then(data => {\n\t\t\tif (!Array.isArray(data)) {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\n\t\t\treturn data.filter(i => TOGGLEABLE_MODULES.includes(i));\n\t\t});\n\t}\n\n\tgetPermissions(): Promise<PermissionData> {\n\t\treturn sendQuery(\"permissions\", undefined, this.MemberNumber).then(data => {\n\t\t\tif (!isObject(data) ||\n\t\t\t\tObject.values(data).some(v =>\n\t\t\t\t\t!Array.isArray(v) ||\n\t\t\t\t\ttypeof v[0] !== \"boolean\" ||\n\t\t\t\t\ttypeof v[1] !== \"number\" ||\n\t\t\t\t\tAccessLevel[v[1]] === undefined\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\n\t\t\treturn getPermissionDataFromBundle(data);\n\t\t});\n\t}\n\n\tgetPermissionAccess(permission: BCX_Permissions): Promise<boolean> {\n\t\treturn sendQuery(\"permissionAccess\", permission, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t}).catch(err => {\n\t\t\tconsole.error(`BCX: Error while querying permission \"${permission}\" access for ${this}`, err);\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tgetMyAccessLevel(): Promise<AccessLevel> {\n\t\treturn sendQuery(\"myAccessLevel\", undefined, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"number\" || AccessLevel[data] === undefined) {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tsetPermission(permission: BCX_Permissions, type: \"self\", target: boolean): Promise<boolean>\n\tsetPermission(permission: BCX_Permissions, type: \"min\", target: AccessLevel): Promise<boolean>\n\tsetPermission(permission: BCX_Permissions, type: \"self\" | \"min\", target: boolean | AccessLevel): Promise<boolean> {\n\t\treturn sendQuery(\"editPermission\", {\n\t\t\tpermission,\n\t\t\tedit: type,\n\t\t\ttarget\n\t\t}, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tgetRolesData(): Promise<PermissionRoleBundle> {\n\t\treturn sendQuery(\"rolesData\", undefined, this.MemberNumber).then(data => {\n\t\t\tif (!isObject(data) ||\n\t\t\t\t!Array.isArray(data.mistresses) ||\n\t\t\t\t!data.mistresses.every(i => Array.isArray(i) && i.length === 2 && typeof i[0] === \"number\" && typeof i[1] === \"string\") ||\n\t\t\t\t!Array.isArray(data.owners) ||\n\t\t\t\t!data.owners.every(i => Array.isArray(i) && i.length === 2 && typeof i[0] === \"number\" && typeof i[1] === \"string\") ||\n\t\t\t\ttypeof data.allowAddMistress !== \"boolean\" ||\n\t\t\t\ttypeof data.allowRemoveMistress !== \"boolean\" ||\n\t\t\t\ttypeof data.allowAddOwner !== \"boolean\" ||\n\t\t\t\ttypeof data.allowRemoveOwner !== \"boolean\"\n\t\t\t) {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\teditRole(role: \"owner\" | \"mistress\", action: \"add\" | \"remove\", target: number): Promise<boolean> {\n\t\treturn sendQuery(\"editRole\", {\n\t\t\ttype: role,\n\t\t\taction,\n\t\t\ttarget\n\t\t}, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tgetLogEntries(): Promise<LogEntry[]> {\n\t\treturn sendQuery(\"logData\", undefined, this.MemberNumber).then(data => {\n\t\t\tif (\n\t\t\t\t!Array.isArray(data) ||\n\t\t\t\t!data.every(e =>\n\t\t\t\t\tArray.isArray(e) &&\n\t\t\t\t\te.length === 4 &&\n\t\t\t\t\ttypeof e[0] === \"number\" &&\n\t\t\t\t\ttypeof e[1] === \"number\" &&\n\t\t\t\t\ttypeof e[2] === \"number\"\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tlogMessageDelete(time: number): Promise<boolean> {\n\t\treturn sendQuery(\"logDelete\", time, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tgetLogConfig(): Promise<LogConfig> {\n\t\treturn sendQuery(\"logConfigGet\", undefined, this.MemberNumber).then(data => {\n\t\t\tif (!isObject(data) ||\n\t\t\t\tObject.values(data).some(v => typeof v !== \"number\")\n\t\t\t) {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\tfor (const k of Object.keys(data) as BCX_LogCategory[]) {\n\t\t\t\tif (data[k] == null || modStorage.logConfig?.[k] === undefined || LogAccessLevel[data[k]!] === undefined) {\n\t\t\t\t\tdelete data[k];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tsetLogConfig(category: BCX_LogCategory, target: LogAccessLevel): Promise<boolean> {\n\t\treturn sendQuery(\"logConfigEdit\", {\n\t\t\tcategory,\n\t\t\ttarget\n\t\t}, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tlogClear(): Promise<boolean> {\n\t\treturn sendQuery(\"logClear\", undefined, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tlogPraise(value: -1 | 0 | 1, message: string | null): Promise<boolean> {\n\t\treturn sendQuery(\"logPraise\", {\n\t\t\tmessage,\n\t\t\tvalue\n\t\t}, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tlogGetAllowedActions(): Promise<BCX_logAllowedActions> {\n\t\treturn sendQuery(\"logGetAllowedActions\", undefined, this.MemberNumber).then(data => {\n\t\t\tif (!isObject(data) ||\n\t\t\t\ttypeof data.delete !== \"boolean\" ||\n\t\t\t\ttypeof data.configure !== \"boolean\" ||\n\t\t\t\ttypeof data.praise !== \"boolean\" ||\n\t\t\t\ttypeof data.leaveMessage !== \"boolean\"\n\t\t\t) {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tcurseGetInfo(): Promise<BCX_curseInfo> {\n\t\treturn sendQuery(\"curseGetInfo\", undefined, this.MemberNumber).then(data => {\n\t\t\tif (!isObject(data) ||\n\t\t\t\ttypeof data.allowCurse !== \"boolean\" ||\n\t\t\t\ttypeof data.allowLift !== \"boolean\" ||\n\t\t\t\t!isObject(data.curses) ||\n\t\t\t\tObject.values(data.curses).some(v =>\n\t\t\t\t\tv !== null &&\n\t\t\t\t\t(\n\t\t\t\t\t\t!isObject(v) ||\n\t\t\t\t\t\ttypeof v.Name !== \"string\" ||\n\t\t\t\t\t\ttypeof v.curseProperties !== \"boolean\"\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tcurseItem(Group: string, curseProperties: boolean | null): Promise<boolean> {\n\t\treturn sendQuery(\"curseItem\", { Group, curseProperties }, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tcurseLift(Group: string): Promise<boolean> {\n\t\treturn sendQuery(\"curseLift\", Group, this.MemberNumber).then(data => {\n\t\t\tif (typeof data !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Bad data\");\n\t\t\t}\n\t\t\treturn data;\n\t\t});\n\t}\n\n\thasAccessToPlayer(): boolean {\n\t\treturn ServerChatRoomGetAllowItem(this.Character, Player);\n\t}\n\n\tplayerHasAccessToCharacter(): boolean {\n\t\treturn ServerChatRoomGetAllowItem(Player, this.Character);\n\t}\n}\n\nexport class PlayerCharacter extends ChatroomCharacter {\n\t/** HACK: Otherwise TS wrongly assumes PlayerCharacter to be identical to ChatroomCharacter */\n\tpublic readonly playerObject = true;\n\n\toverride isPlayer(): this is PlayerCharacter {\n\t\treturn true;\n\t}\n\n\toverride getDisabledModules(): Promise<ModuleCategory[]> {\n\t\treturn Promise.resolve(getDisabledModules());\n\t}\n\n\toverride getPermissions(): Promise<PermissionData> {\n\t\treturn Promise.resolve(getPlayerPermissionSettings());\n\t}\n\n\toverride getPermissionAccess(permission: BCX_Permissions): Promise<boolean> {\n\t\treturn Promise.resolve(checkPermissionAccess(permission, this));\n\t}\n\n\toverride getMyAccessLevel(): Promise<AccessLevel.self> {\n\t\treturn Promise.resolve(AccessLevel.self);\n\t}\n\n\toverride setPermission(permission: BCX_Permissions, type: \"self\", target: boolean): Promise<boolean>\n\toverride setPermission(permission: BCX_Permissions, type: \"min\", target: AccessLevel): Promise<boolean>\n\toverride setPermission(permission: BCX_Permissions, type: \"self\" | \"min\", target: boolean | AccessLevel): Promise<boolean> {\n\t\tif (type === \"self\") {\n\t\t\tif (typeof target !== \"boolean\") {\n\t\t\t\tthrow new Error(\"Invalid target value for self permission edit\");\n\t\t\t}\n\t\t\treturn Promise.resolve(setPermissionSelfAccess(permission, target, this));\n\t\t} else {\n\t\t\tif (typeof target !== \"number\") {\n\t\t\t\tthrow new Error(\"Invalid target value for min permission edit\");\n\t\t\t}\n\t\t\treturn Promise.resolve(setPermissionMinAccess(permission, target, this));\n\t\t}\n\t}\n\n\toverride getRolesData(): Promise<PermissionRoleBundle> {\n\t\treturn Promise.resolve(getPlayerRoleData(this));\n\t}\n\n\toverride editRole(role: \"owner\" | \"mistress\", action: \"add\" | \"remove\", target: number): Promise<boolean> {\n\t\treturn Promise.resolve(editRole(role, action, target, this));\n\t}\n\n\toverride getLogEntries(): Promise<LogEntry[]> {\n\t\treturn Promise.resolve(getVisibleLogEntries(this));\n\t}\n\n\toverride logMessageDelete(time: number): Promise<boolean> {\n\t\treturn Promise.resolve(logMessageDelete(time, this));\n\t}\n\n\toverride getLogConfig(): Promise<LogConfig> {\n\t\treturn Promise.resolve(logGetConfig());\n\t}\n\n\toverride setLogConfig(category: BCX_LogCategory, target: LogAccessLevel): Promise<boolean> {\n\t\treturn Promise.resolve(logConfigSet(category, target, this));\n\t}\n\n\toverride logClear(): Promise<boolean> {\n\t\treturn Promise.resolve(logClear(this));\n\t}\n\n\toverride logPraise(value: -1 | 0 | 1, message: string | null): Promise<boolean> {\n\t\treturn Promise.resolve(logPraise(value, message, this));\n\t}\n\n\toverride logGetAllowedActions(): Promise<BCX_logAllowedActions> {\n\t\treturn Promise.resolve(logGetAllowedActions(this));\n\t}\n\n\toverride curseGetInfo(): Promise<BCX_curseInfo> {\n\t\treturn Promise.resolve(curseGetInfo(this));\n\t}\n\n\toverride curseItem(Group: string, curseProperties: boolean): Promise<boolean> {\n\t\treturn Promise.resolve(curseItem(Group, curseProperties, this));\n\t}\n\n\toverride curseLift(Group: string): Promise<boolean> {\n\t\treturn Promise.resolve(curseLift(Group, this));\n\t}\n}\n\nconst currentRoomCharacters: ChatroomCharacter[] = [];\n\nfunction cleanOldCharacters(): void {\n\tfor (let i = currentRoomCharacters.length - 1; i >= 0; i--) {\n\t\tif (!currentRoomCharacters[i].isPlayer() && !ChatRoomCharacter.includes(currentRoomCharacters[i].Character)) {\n\t\t\tcurrentRoomCharacters.splice(i, 1);\n\t\t}\n\t}\n}\n\nexport function getChatroomCharacter(memberNumber: number): ChatroomCharacter | null {\n\tif (typeof memberNumber !== \"number\")\n\t\treturn null;\n\tcleanOldCharacters();\n\tlet character = currentRoomCharacters.find(c => c.Character.MemberNumber === memberNumber);\n\tif (!character) {\n\t\tif (Player.MemberNumber === memberNumber) {\n\t\t\tcharacter = new PlayerCharacter(Player);\n\t\t} else {\n\t\t\tconst BCCharacter = ChatRoomCharacter.find(c => c.MemberNumber === memberNumber);\n\t\t\tif (!BCCharacter) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tcharacter = new ChatroomCharacter(BCCharacter);\n\t\t}\n\t\tcurrentRoomCharacters.push(character);\n\t}\n\treturn character;\n}\n\nexport function getAllCharactersInRoom(): ChatroomCharacter[] {\n\treturn ChatRoomCharacter.map(c => getChatroomCharacter(c.MemberNumber!)).filter(Boolean) as ChatroomCharacter[];\n}\n\nexport function getPlayerCharacter(): PlayerCharacter {\n\tlet character = currentRoomCharacters.find(c => c.Character === Player) as PlayerCharacter | undefined;\n\tif (!character) {\n\t\tcharacter = new PlayerCharacter(Player);\n\t\tcurrentRoomCharacters.push(character);\n\t}\n\treturn character;\n}\n","import { getChatroomCharacter, getPlayerCharacter } from \"../characters\";\nimport { moduleInitPhase } from \"../moduleManager\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { hookFunction } from \"../patching\";\nimport { isObject, uuidv4 } from \"../utils\";\nimport { firstTimeInit } from \"./storage\";\nimport { ModuleInitPhase } from \"../constants\";\n\nexport const hiddenMessageHandlers: Map<keyof BCX_messages, (sender: number, message: any) => void> = new Map();\nexport const hiddenBeepHandlers: Map<keyof BCX_beeps, (sender: number, message: any) => void> = new Map();\n\nexport type queryResolveFunction<T extends keyof BCX_queries> = {\n\t(ok: true, data: BCX_queries[T][1]): void;\n\t(ok: false, error?: any): void;\n};\n\nexport const queryHandlers: {\n\t[K in keyof BCX_queries]?: (sender: number, resolve: queryResolveFunction<K>, data: BCX_queries[K][0]) => void;\n} = {};\n\nexport const changeHandlers: ((source: number) => void)[] = [];\n\nexport function sendHiddenMessage<T extends keyof BCX_messages>(type: T, message: BCX_messages[T], Target: number | null = null) {\n\tif (!ServerPlayerIsInChatRoom() || firstTimeInit)\n\t\treturn;\n\tServerSend(\"ChatRoomChat\", {\n\t\tContent: \"BCXMsg\",\n\t\tType: \"Hidden\",\n\t\tTarget,\n\t\tDictionary: { type, message }\n\t});\n}\n\nexport function sendHiddenBeep<T extends keyof BCX_beeps>(type: T, message: BCX_beeps[T], target: number, asLeashBeep: boolean = false) {\n\tServerSend(\"AccountBeep\", {\n\t\tMemberNumber: target,\n\t\tBeepType: asLeashBeep ? \"Leash\" : \"BCX\",\n\t\tMessage: {\n\t\t\tBCX: { type, message }\n\t\t}\n\t});\n}\n\ninterface IPendingQuery {\n\ttarget: number;\n\tresolve: (data: any) => void;\n\treject: (data: any) => void;\n\ttimeout: number;\n}\n\nconst pendingQueries: Map<string, IPendingQuery> = new Map();\n\nexport function sendQuery<T extends keyof BCX_queries>(type: T, data: BCX_queries[T][0], target: number, timeout: number = 10_000): Promise<BCX_queries[T][1]> {\n\tif (firstTimeInit) {\n\t\treturn Promise.reject(\"Unavailable during init\");\n\t}\n\n\treturn new Promise((resolve, reject) => {\n\t\tconst id = uuidv4();\n\t\tconst info: IPendingQuery = {\n\t\t\ttarget,\n\t\t\tresolve,\n\t\t\treject,\n\t\t\ttimeout: setTimeout(() => {\n\t\t\t\tconsole.warn(\"BCX: Query timed out\", target, type);\n\t\t\t\tpendingQueries.delete(id);\n\t\t\t\treject(\"Timed out\");\n\t\t\t}, timeout)\n\t\t};\n\t\tpendingQueries.set(id, info);\n\n\t\tsendHiddenMessage(\"query\", {\n\t\t\tid,\n\t\t\tquery: type,\n\t\t\tdata\n\t\t}, target);\n\n\t});\n}\n\nhiddenMessageHandlers.set(\"query\", (sender, message: BCX_message_query) => {\n\tif (!isObject(message) ||\n\t\ttypeof message.id !== \"string\" ||\n\t\ttypeof message.query !== \"string\"\n\t) {\n\t\tconsole.warn(`BCX: Invalid query`, sender, message);\n\t\treturn;\n\t}\n\n\tconst character = getChatroomCharacter(sender);\n\tif (character && !character.hasAccessToPlayer()) {\n\t\treturn sendHiddenMessage(\"queryAnswer\", {\n\t\t\tid: message.id,\n\t\t\tok: false\n\t\t});\n\t}\n\n\tconst handler = queryHandlers[message.query] as (sender: number, resolve: queryResolveFunction<keyof BCX_queries>, data: any) => void;\n\tif (!handler) {\n\t\tconsole.warn(\"BCX: Query no handler\", sender, message);\n\t\treturn sendHiddenMessage(\"queryAnswer\", {\n\t\t\tid: message.id,\n\t\t\tok: false\n\t\t});\n\t}\n\n\thandler(sender, (ok, data) => {\n\t\tsendHiddenMessage(\"queryAnswer\", {\n\t\t\tid: message.id,\n\t\t\tok,\n\t\t\tdata\n\t\t}, sender);\n\t}, message.data);\n});\n\nhiddenMessageHandlers.set(\"queryAnswer\", (sender, message: BCX_message_queryAnswer) => {\n\tif (!isObject(message) ||\n\t\ttypeof message.id !== \"string\" ||\n\t\ttypeof message.ok !== \"boolean\"\n\t) {\n\t\tconsole.warn(`BCX: Invalid queryAnswer`, sender, message);\n\t\treturn;\n\t}\n\n\tconst info = pendingQueries.get(message.id);\n\tif (!info) {\n\t\tconsole.warn(`BCX: Response to unknown query`, sender, message);\n\t\treturn;\n\t}\n\n\tif (info.target !== info.target) {\n\t\tconsole.warn(`BCX: Response to query not from target`, sender, message, info);\n\t\treturn;\n\t}\n\n\tclearTimeout(info.timeout);\n\tpendingQueries.delete(message.id);\n\n\tif (message.ok) {\n\t\tinfo.resolve(message.data);\n\t} else {\n\t\tinfo.reject(message.data);\n\t}\n});\n\nhiddenMessageHandlers.set(\"somethingChanged\", (sender) => {\n\tchangeHandlers.forEach(h => h(sender));\n});\n\nexport function notifyOfChange(): void {\n\tif (moduleInitPhase !== ModuleInitPhase.ready)\n\t\treturn;\n\tsendHiddenMessage(\"somethingChanged\", undefined);\n\tconst player = getPlayerCharacter().MemberNumber;\n\tchangeHandlers.forEach(h => h(player));\n}\n\nexport class ModuleMessaging extends BaseModule {\n\tload() {\n\t\thookFunction(\"ChatRoomMessage\", 10, (args, next) => {\n\t\t\tconst data = args[0];\n\n\t\t\tif (data?.Type === \"Hidden\" && data.Content === \"BCXMsg\" && typeof data.Sender === \"number\") {\n\t\t\t\tif (data.Sender === Player.MemberNumber || firstTimeInit)\n\t\t\t\t\treturn;\n\t\t\t\tif (!isObject(data.Dictionary)) {\n\t\t\t\t\tconsole.warn(\"BCX: Hidden message no Dictionary\", data);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst { type, message } = data.Dictionary;\n\t\t\t\tif (typeof type === \"string\") {\n\t\t\t\t\tconst handler = hiddenMessageHandlers.get(type as keyof BCX_messages);\n\t\t\t\t\tif (handler === undefined) {\n\t\t\t\t\t\tconsole.warn(\"BCX: Hidden message no handler\", data.Sender, type, message);\n\t\t\t\t\t} else {\n\t\t\t\t\t\thandler(data.Sender, message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treturn next(args);\n\t\t});\n\n\t\thookFunction(\"ServerAccountBeep\", 10, (args, next) => {\n\t\t\tconst data = args[0];\n\n\t\t\tif (typeof data?.BeepType === \"string\" && [\"Leash\", \"BCX\"].includes(data.BeepType) && isObject(data.Message?.BCX)) {\n\t\t\t\tconst { type, message } = data.Message.BCX;\n\t\t\t\tif (typeof type === \"string\") {\n\t\t\t\t\tconst handler = hiddenBeepHandlers.get(type as keyof BCX_beeps);\n\t\t\t\t\tif (handler === undefined) {\n\t\t\t\t\t\tconsole.warn(\"BCX: Hidden beep no handler\", data.MemberNumber, type, message);\n\t\t\t\t\t} else {\n\t\t\t\t\t\thandler(data.MemberNumber, message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\treturn next(args);\n\t\t\t}\n\t\t});\n\t}\n\n\tunload() {\n\t\thiddenBeepHandlers.clear();\n\t\thiddenMessageHandlers.clear();\n\t}\n}\n","import { getCurrentSubscreen, setSubscreen } from \"../modules/gui\";\n\nexport abstract class GuiSubscreen {\n\tget active(): boolean {\n\t\treturn getCurrentSubscreen() === this;\n\t}\n\n\tLoad() {\n\t\t// Empty\n\t}\n\n\tRun() {\n\t\t// Empty\n\t}\n\n\tClick() {\n\t\t// Empty\n\t}\n\n\tExit() {\n\t\tsetSubscreen(null);\n\t}\n\n\tUnload() {\n\t\t// Empty\n\t}\n\n\tonChange(source: number) {\n\t\t// Empty\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { AccessLevel } from \"../modules/authority\";\nimport { capitalizeFirstLetter } from \"../utils\";\nimport { GuiMainMenu } from \"./mainmenu\";\nimport { GuiAuthorityPermissions } from \"./authority_permissions\";\nimport { setSubscreen } from \"../modules/gui\";\n\nconst PER_PAGE_COUNT = 6;\n\ntype RoleListItem = {\n\ttype: \"Owner\" | \"Mistress\";\n\tmemberNumber: number;\n\tname: string | null;\n};\n\nexport class GuiAuthorityRoles extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\n\tprivate roleData: PermissionRoleBundle | null = null;\n\tprivate roleList: RoleListItem[] = [];\n\tprivate failed: boolean = false;\n\tprivate page: number = 0;\n\n\tprivate hoveringTextList: string[] = [];\n\n\tconstructor(character: ChatroomCharacter) {\n\t\tsuper();\n\t\tthis.character = character;\n\n\t\tthis.hoveringTextList =\n\t\tcharacter.isPlayer() ? [\n\t\t\t`You - either top or bottom of the hierarchy`,\n\t\t\t`Your owner, visible on your character profile`,\n\t\t\t`Any character, added to the list on the left as \"Owner\"`,\n\t\t\t`Any of your lovers, visible on your character profile`,\n\t\t\t`Any character, added to the list on the left as \"Mistress\"`,\n\t\t\t`Anyone you have white-listed`,\n\t\t\t`Anyone you have friend-listed`,\n\t\t\t`Anyone, who can use items on you`\n\t\t] : [\n\t\t\t`This player - either top or bottom of the hierarchy`,\n\t\t\t`This player's owner, visible on their character profile`,\n\t\t\t`Any character, added to the list on the left as \"Owner\"`,\n\t\t\t`Any lover of this player, visible on their profile`,\n\t\t\t`Any character, added to the list on the left as \"Mistress\"`,\n\t\t\t`Anyone this player has white-listed`,\n\t\t\t`Anyone this player has friend-listed`,\n\t\t\t`Anyone, who can use items on this player`\n\t\t];\n\t}\n\n\tLoad() {\n\t\tthis.requestData();\n\t}\n\n\tonChange(sender: number) {\n\t\tif (sender === this.character.MemberNumber) {\n\t\t\tthis.requestData();\n\t\t}\n\t}\n\n\tprivate requestData() {\n\t\tthis.roleData = null;\n\t\tthis.rebuildList();\n\t\tPromise.all([this.character.getRolesData()]).then(res => {\n\t\t\tthis.roleData = res[0];\n\t\t\tthis.rebuildList();\n\t\t}, err => {\n\t\t\tconsole.error(`BCX: Failed to get role info for ${this.character}`, err);\n\t\t\tthis.failed = true;\n\t\t});\n\t}\n\n\tprivate rebuildList() {\n\t\tif (!this.active) return;\n\n\t\tthis.roleList = [];\n\n\t\tlet Input = document.getElementById(\"BCX_RoleAdd\") as HTMLInputElement | undefined;\n\n\t\tif (!this.roleData) {\n\t\t\tif (Input) {\n\t\t\t\tInput.remove();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst showInput = this.roleData.allowAddMistress || this.roleData.allowAddOwner;\n\n\t\tif (!showInput && Input) {\n\t\t\tInput.remove();\n\t\t} else if (showInput && !Input) {\n\t\t\tInput = ElementCreateInput(\"BCX_RoleAdd\", \"text\", \"\", \"6\");\n\t\t}\n\n\t\tthis.roleList = this.roleData.owners.map((i): RoleListItem => ({\n\t\t\ttype: \"Owner\",\n\t\t\tmemberNumber: i[0],\n\t\t\tname: Player.FriendNames?.get(i[0]) || i[1] || null\n\t\t}));\n\t\tthis.roleList.push(...this.roleData.mistresses.map((i): RoleListItem => ({\n\t\t\ttype: \"Mistress\",\n\t\t\tmemberNumber: i[0],\n\t\t\tname: Player.FriendNames?.get(i[0]) || i[1] || null\n\t\t})));\n\n\t\tconst totalPages = Math.ceil(this.roleList.length / PER_PAGE_COUNT);\n\t\tif (this.page < 0) {\n\t\t\tthis.page = Math.max(totalPages - 1, 0);\n\t\t} else if (this.page >= totalPages) {\n\t\t\tthis.page = 0;\n\t\t}\n\t}\n\n\tRun() {\n\n\t\tDrawText(\"Hierarchy of roles:\", 1336, 95, \"Black\");\n\n\t\t// hierarchy background\n\t\tMainCanvas.beginPath();\n\t\tMainCanvas.moveTo(1450, 134);\n\t\tMainCanvas.lineTo(1450 + 150, 134);\n\t\tMainCanvas.lineTo(1450 + 80, 740);\n\t\tMainCanvas.lineTo(1450 + 70, 740);\n\t\tMainCanvas.lineTo(1450, 134);\n\t\tMainCanvas.fillStyle = \"Black\";\n\t\tMainCanvas.fill();\n\n\t\tif (this.roleData) {\n\n\t\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\t\tif (i >= this.roleList.length) break;\n\t\t\t\tconst e = this.roleList[i];\n\n\t\t\t\tconst Y = 210 + off * 95;\n\n\t\t\t\t// Owner/Mistress list\n\t\t\t\tMainCanvas.beginPath();\n\t\t\t\tMainCanvas.rect(130, Y, 900, 64);\n\t\t\t\tMainCanvas.stroke();\n\t\t\t\tconst msg = `${e.type} ${e.name === null ? \"[unknown name]\" : e.name} (${e.memberNumber})`;\n\t\t\t\tDrawTextFit(msg, 140, Y + 34, 590, \"Black\");\n\n\t\t\t\tif ((e.type === \"Owner\" ? this.roleData.allowRemoveOwner : this.roleData.allowRemoveMistress) || e.memberNumber === Player.MemberNumber ) {\n\t\t\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\t\t\tDrawButton(1090, Y, 64, 64, \"X\", \"White\");\n\t\t\t\t\tMainCanvas.textAlign = \"left\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst Input = document.getElementById(\"BCX_RoleAdd\") as HTMLInputElement | undefined;\n\t\t\tif (Input) {\n\t\t\t\tDrawText(\"Member Number:\", 130, 847, \"Black\");\n\t\t\t\tElementPosition(\"BCX_RoleAdd\", 580, 842, 300, 64);\n\t\t\t}\n\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tif (this.roleData.allowAddOwner) {\n\t\t\t\tDrawButton(760, 815, 210, 64, \"Add owner\", \"white\");\n\t\t\t}\n\n\t\t\tif (this.roleData.allowAddMistress) {\n\t\t\t\tDrawButton(1008, 815, 210, 64, \"Add mistress\", \"white\");\n\t\t\t}\n\n\t\t\t// Pagination\n\t\t\tconst totalPages = Math.ceil(this.roleList.length / PER_PAGE_COUNT);\n\t\t\tDrawBackNextButton(1317, 800, 300, 90, `Page ${this.page + 1} / ${totalPages}`, \"White\", \"\", () => \"\", () => \"\");\n\t\t} else if (this.failed) {\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawText(`Failed to get role data from ${this.character.Name}. Maybe you have no access?`, 800, 480, \"Black\");\n\t\t} else {\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawText(\"Loading...\", 800, 480, \"Black\");\n\t\t}\n\n\t\t// hierarchy roles\n\t\tMainCanvas.textAlign = \"center\";\n\t\tDrawButton(1420, 130, 208, 54, this.character.Name, \"White\", undefined, this.hoveringTextList[0]);\n\t\tfor (let i = 1; i < 8; i++) {\n\t\t\tDrawButton(1430, 130 + 80 * i, 188, 54, capitalizeFirstLetter(AccessLevel[i]), \"White\", undefined, this.hoveringTextList[i]);\n\t\t}\n\n\t\tMainCanvas.textAlign = \"left\";\n\t\tDrawText(`- Authority: Role Management for ${this.character.Name} -`, 125, 125, \"Black\", \"Gray\");\n\t\tMainCanvas.textAlign = \"center\";\n\t\tDrawButton(1815, 75, 90, 90, \"\", \"White\", \"Icons/Exit.png\", \"BCX main menu\");\n\t\tDrawButton(1815, 190, 90, 90, \"\", \"White\", \"Icons/West.png\", \"Previous screen\");\n\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\t\tif (MouseIn(1815, 190, 90, 90)) return this.Back();\n\n\t\tif (this.roleData) {\n\n\t\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\t\tif (i >= this.roleList.length) break;\n\t\t\t\tconst e = this.roleList[i];\n\n\t\t\t\tconst Y = 210 + off * 95;\n\n\t\t\t\tif (((e.type === \"Owner\" ? this.roleData.allowRemoveOwner : this.roleData.allowRemoveMistress) || e.memberNumber === Player.MemberNumber ) && MouseIn(1090, Y, 64, 64)) {\n\t\t\t\t\tthis.character.editRole(e.type === \"Owner\" ? \"owner\" : \"mistress\", \"remove\", e.memberNumber);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst Input = document.getElementById(\"BCX_RoleAdd\") as HTMLInputElement | undefined;\n\t\t\tconst inputText = Input?.value ?? \"\";\n\t\t\tconst inputNumber = /^[0-9]+$/.test(inputText) ? Number.parseInt(inputText, 10) : null;\n\n\t\t\tif (this.roleData.allowAddOwner && Input && inputNumber !== null && MouseIn(760, 815, 210, 64)) {\n\t\t\t\tInput.value = \"\";\n\t\t\t\tthis.character.editRole(\"owner\", \"add\", inputNumber);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.roleData.allowAddMistress && Input && inputNumber !== null && MouseIn(1008, 815, 210, 64)) {\n\t\t\t\tInput.value = \"\";\n\t\t\t\tthis.character.editRole(\"mistress\", \"add\", inputNumber);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Pagination\n\t\t\tconst totalPages = Math.ceil(this.roleList.length / PER_PAGE_COUNT);\n\t\t\tif (MouseIn(1317, 800, 150, 90)) {\n\t\t\t\tthis.page--;\n\t\t\t\tif (this.page < 0) {\n\t\t\t\t\tthis.page = Math.max(totalPages - 1, 0);\n\t\t\t\t}\n\t\t\t} else if (MouseIn(1467, 800, 150, 90)) {\n\t\t\t\tthis.page++;\n\t\t\t\tif (this.page >= totalPages) {\n\t\t\t\t\tthis.page = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\n\tExit() {\n\t\tsetSubscreen(new GuiMainMenu(this.character));\n\t}\n\n\tBack() {\n\t\tsetSubscreen(new GuiAuthorityPermissions(this.character));\n\t}\n\n\tUnload() {\n\t\tElementRemove(\"BCX_RoleAdd\");\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { AccessLevel, getPermissionMinDisplayText, PermissionInfo } from \"../modules/authority\";\nimport { capitalizeFirstLetter } from \"../utils\";\nimport { setSubscreen } from \"../modules/gui\";\n\n\nexport class GuiAuthorityDialogMin extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\treadonly permission: BCX_Permissions;\n\tprivate permissionData: PermissionInfo;\n\tprivate myAccessLevel: AccessLevel;\n\tprivate noAccess: boolean;\n\n\tprivate selectedLevel: AccessLevel;\n\n\tpublic back: GuiSubscreen;\n\n\tconstructor(character: ChatroomCharacter, permission: BCX_Permissions, data: PermissionInfo, myAccesLevel: AccessLevel, noAccess: boolean, back: GuiSubscreen) {\n\t\tsuper();\n\t\tthis.character = character;\n\t\tthis.permission = permission;\n\t\tthis.permissionData = data;\n\t\tthis.back = back;\n\t\tthis.myAccessLevel = myAccesLevel;\n\t\tthis.noAccess = noAccess;\n\n\t\tthis.selectedLevel = data.min;\n\t}\n\n\tRun() {\n\n\t\tDrawTextFit(`- Authority: Changing minimum access to permission \"${this.permissionData.name}\" -`, 125, 125, 1850, \"Black\", \"Gray\");\n\t\tMainCanvas.textAlign = \"center\";\n\n\n\t\tDrawText(\"Please select the new lowest role that should still have this permission.\", 1000, 255, \"Black\");\n\t\tDrawTextFit(`Info: Currently set role: ${this.permissionData.min === AccessLevel.self ?\n\t\t\tthis.character.Name : capitalizeFirstLetter(AccessLevel[this.permissionData.min])} → ` +\n\t\t\t`Newly selected role: ${this.selectedLevel === AccessLevel.self ?\n\t\t\t\tthis.character.Name : capitalizeFirstLetter(AccessLevel[this.selectedLevel])}`, 1000, 320, 1850, \"Black\");\n\t\tDrawText(\"All roles to the left of the selected one will also automatically get access.\", 1000, 385, \"Black\");\n\n\t\tif (this.myAccessLevel === AccessLevel.self) {\n\t\t\tconst available = (this.permissionData.min <= AccessLevel.self) || !this.noAccess;\n\t\t\tDrawButton(1000-110, 460, 220, 72, getPermissionMinDisplayText(AccessLevel.self, this.character), this.selectedLevel === AccessLevel.self ? \"Cyan\" : available ? \"White\" : \"#ddd\", undefined, undefined, !available);\n\t\t}\n\n\t\tfor (let i = 1; i < 8; i++) {\n\t\t\tconst current = this.selectedLevel === i;\n\t\t\tconst available =\n\t\t\t\t(this.myAccessLevel === AccessLevel.self && this.permissionData.min <= i && i <= AccessLevel.owner) ||\n\t\t\t\t!this.noAccess && this.myAccessLevel <= i;\n\t\t\tDrawButton(-15 + 230 * i, 577, 190, 72, getPermissionMinDisplayText(i, this.character), current ? \"Cyan\" : available ? \"White\" : \"#ddd\", undefined, undefined, !available);\n\t\t\tif (i < 7)\n\t\t\t\tDrawText(\">\", 196 + 230 * i, 577 + 36, \"Black\");\n\t\t}\n\n\t\tif (this.character.isPlayer() && this.permission === \"authority_revoke_self\" && this.selectedLevel !== AccessLevel.self) {\n\t\t\tDrawText(`WARNING: If you confirm, all permitted roles can remove your access to this and all other permissions!`, 1000, 730, \"Red\", \"Gray\");\n\t\t}\n\n\t\tDrawButton(700, 800, 200, 80, \"Confirm\", \"White\");\n\n\t\tDrawButton(1120, 800, 200, 80, \"Cancel\", \"White\");\n\t}\n\n\tClick() {\n\t\tif (MouseIn(700, 800, 200, 80)) return this.Confirm();\n\t\tif (MouseIn(1120, 800, 200, 80)) return this.Exit();\n\n\t\tif (MouseIn(1000-110, 460, 220, 72) && this.myAccessLevel === AccessLevel.self) {\n\t\t\tconst available = (this.permissionData.min <= AccessLevel.self) || !this.noAccess;\n\t\t\tif (available) {\n\t\t\t\tthis.selectedLevel = AccessLevel.self;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 1; i < 8; i++) {\n\t\t\tconst current = this.selectedLevel === i;\n\t\t\tconst available =\n\t\t\t\t(this.myAccessLevel === AccessLevel.self && this.permissionData.min <= i && i <= AccessLevel.owner) ||\n\t\t\t\t!this.noAccess && this.myAccessLevel <= i;\n\t\t\tif (MouseIn(-15 + 230 * i, 577, 190, 72) && !current && available) {\n\t\t\t\tthis.selectedLevel = i;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tConfirm() {\n\t\tthis.character.setPermission(this.permission, \"min\", this.selectedLevel);\n\t}\n\n\tExit() {\n\t\tsetSubscreen(this.back);\n\t}\n\n\tonChange() {\n\t\t// When something changes, we bail from change dialog, because it might no longer be valid\n\t\tthis.Exit();\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { PermissionInfo } from \"../modules/authority\";\nimport { setSubscreen } from \"../modules/gui\";\n\nexport class GuiAuthorityDialogSelf extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\treadonly permission: BCX_Permissions;\n\tprivate permissionData: PermissionInfo;\n\n\tpublic back: GuiSubscreen;\n\n\tconstructor(character: ChatroomCharacter, permission: BCX_Permissions, data: PermissionInfo, back: GuiSubscreen) {\n\t\tsuper();\n\t\tthis.character = character;\n\t\tthis.permission = permission;\n\t\tthis.permissionData = data;\n\t\tthis.back = back;\n\t}\n\n\tRun() {\n\n\t\tDrawTextFit(`- Authority: Removing self access to permission \"${this.permissionData.name}\" -`, 125, 125, 1850, \"Black\", \"Gray\");\n\t\tMainCanvas.textAlign = \"center\";\n\n\t\tDrawText(\"- Warning -\", 1000, 375, \"Black\", \"Black\");\n\t\tDrawText(\"If you confirm, you won't be able to change your access to this permission back yourself.\", 1000, 525, \"Black\");\n\n\t\tDrawButton(700, 720, 200, 80, \"Confirm\", \"White\");\n\n\t\tDrawButton(1120, 720, 200, 80, \"Cancel\", \"White\");\n\t}\n\n\tClick() {\n\t\tif (MouseIn(700, 720, 200, 80)) return this.Confirm();\n\t\tif (MouseIn(1120, 720, 200, 80)) return this.Exit();\n\n\t}\n\n\tConfirm() {\n\t\tthis.character.setPermission(this.permission, \"self\", false);\n\t}\n\n\tExit() {\n\t\tsetSubscreen(this.back);\n\t}\n\n\tonChange() {\n\t\t// When something changes, we bail from change dialog, because it might no longer be valid\n\t\tthis.Exit();\n\t}\n}\n","import { ChatroomCharacter, getPlayerCharacter } from \"../characters\";\nimport { ModuleCategory, MODULE_ICONS, MODULE_NAMES } from \"../constants\";\nimport { AccessLevel, checkPermisionAccesData, checkPermissionAccess, getPermissionMinDisplayText, PermissionData, PermissionInfo } from \"../modules/authority\";\nimport { icon_OwnerList } from \"../resources\";\nimport { DrawImageEx } from \"../utilsClub\";\nimport { GuiMainMenu } from \"./mainmenu\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { GuiAuthorityRoles } from \"./authority_roles\";\nimport { GuiAuthorityDialogMin } from \"./authority_dialogMin\";\nimport { GuiAuthorityDialogSelf } from \"./authority_dialogSelf\";\nimport { setSubscreen } from \"../modules/gui\";\n\ntype PermListItem = (\n\t{\n\t\tseparator: false;\n\t\tpermission: BCX_Permissions;\n\t\tpermissionInfo: PermissionInfo;\n\t\teditSelf: boolean;\n\t\teditMin: boolean;\n\t} | {\n\t\tseparator: true;\n\t\tname: string;\n\t}\n);\n\nconst PER_PAGE_COUNT = 6;\n\nexport class GuiAuthorityPermissions extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\tprivate permissionData: PermissionData | null = null;\n\tprivate myAccessLevel: AccessLevel = AccessLevel.public;\n\tprivate failed: boolean = false;\n\tprivate permList: PermListItem[] = [];\n\tprivate page: number = 0;\n\n\tconstructor(character: ChatroomCharacter) {\n\t\tsuper();\n\t\tthis.character = character;\n\t\tif (this.character.isPlayer()) {\n\t\t\tthis.myAccessLevel = AccessLevel.self;\n\t\t}\n\t}\n\n\tLoad() {\n\t\tthis.requestData();\n\t}\n\n\tonChange(sender: number) {\n\t\tif (sender === this.character.MemberNumber) {\n\t\t\tthis.requestData();\n\t\t}\n\t}\n\n\tprivate requestData() {\n\t\tthis.permissionData = null;\n\t\tthis.rebuildList();\n\t\tPromise.all([this.character.getPermissions(), this.character.getMyAccessLevel()]).then(res => {\n\t\t\tthis.permissionData = res[0];\n\t\t\tthis.myAccessLevel = res[1];\n\t\t\tthis.rebuildList();\n\t\t}, err => {\n\t\t\tconsole.error(`BCX: Failed to get permission info for ${this.character}`, err);\n\t\t\tthis.failed = true;\n\t\t});\n\t}\n\n\tprivate rebuildList() {\n\t\tif (!this.active) return;\n\n\t\tconst categories: Map<ModuleCategory, PermissionData> = new Map();\n\t\tthis.permList = [];\n\t\tlet Input = document.getElementById(\"BCX_PermissionsFilter\") as HTMLInputElement | undefined;\n\t\tif (this.permissionData === null) {\n\t\t\tif (Input) {\n\t\t\t\tInput.remove();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Input) {\n\t\t\tInput = ElementCreateInput(\"BCX_PermissionsFilter\", \"text\", \"\", \"30\");\n\t\t\tInput.addEventListener(\"input\", ev => {\n\t\t\t\tthis.rebuildList();\n\t\t\t});\n\t\t}\n\n\t\tconst filter = Input.value.trim().toLocaleLowerCase().split(\" \");\n\n\t\tconst access_grantSelf = this.permissionData.authority_grant_self ?\n\t\t\tcheckPermisionAccesData(this.permissionData.authority_grant_self, this.myAccessLevel) :\n\t\t\tfalse;\n\t\tconst access_revokeSelf = this.permissionData.authority_revoke_self ?\n\t\t\tcheckPermisionAccesData(this.permissionData.authority_revoke_self, this.myAccessLevel) :\n\t\t\tfalse;\n\t\tconst access_editMin = this.permissionData.authority_edit_min ?\n\t\t\tcheckPermisionAccesData(this.permissionData.authority_edit_min, this.myAccessLevel) :\n\t\t\tfalse;\n\t\tconst isPlayer = this.myAccessLevel === AccessLevel.self;\n\n\t\tfor (const [k, v] of Object.entries(this.permissionData)) {\n\t\t\tlet permdata = categories.get(v.category);\n\t\t\tif (filter.some(i =>\n\t\t\t\t!MODULE_NAMES[v.category].toLocaleLowerCase().includes(i) &&\n\t\t\t\t!v.name.toLocaleLowerCase().includes(i) &&\n\t\t\t\t!k.toLocaleLowerCase().includes(i)\n\t\t\t)) continue;\n\t\t\tif (!permdata) {\n\t\t\t\tcategories.set(v.category, permdata = {});\n\t\t\t}\n\t\t\tpermdata[k as BCX_Permissions] = v;\n\t\t}\n\t\tfor (const [category, data] of Array.from(categories.entries()).sort((a, b) => a[0] - b[0])) {\n\t\t\tthis.permList.push({\n\t\t\t\tseparator: true,\n\t\t\t\tname: MODULE_NAMES[category]\n\t\t\t});\n\t\t\tfor (const [k, v] of Object.entries(data).sort((a, b) => a[1].name.localeCompare(b[1].name))) {\n\t\t\t\tconst access = checkPermisionAccesData(v, this.myAccessLevel);\n\t\t\t\tthis.permList.push({\n\t\t\t\t\tseparator: false,\n\t\t\t\t\tpermission: k as BCX_Permissions,\n\t\t\t\t\tpermissionInfo: v,\n\t\t\t\t\teditSelf:\n\t\t\t\t\t\t// character must have access to \"allow granting/forbidding self access\"\n\t\t\t\t\t\t(v.self ? access_revokeSelf : access_grantSelf) &&\n\t\t\t\t\t\t// Not player must have access to target rule\n\t\t\t\t\t\t(isPlayer || access) &&\n\t\t\t\t\t\t// \"minimal access\" set to \"Self\" forces \"self access\" to \"Yes\"\n\t\t\t\t\t\t(!v.self || v.min !== AccessLevel.self),\n\t\t\t\t\teditMin:\n\t\t\t\t\t\t// Exception: Player can always lower permissions \"Self\"->\"Owner\"\n\t\t\t\t\t\t(isPlayer && v.min < AccessLevel.owner) ||\n\t\t\t\t\t\t// Character must have access to \"allow minimal access modification\" &&\n\t\t\t\t\t\t// Character must have access to target rule\n\t\t\t\t\t\t(access_editMin && access)\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst totalPages = Math.ceil(this.permList.length / PER_PAGE_COUNT);\n\t\tif (this.page < 0) {\n\t\t\tthis.page = Math.max(totalPages - 1, 0);\n\t\t} else if (this.page >= totalPages) {\n\t\t\tthis.page = 0;\n\t\t}\n\t}\n\n\tRun() {\n\t\tif (this.permissionData !== null) {\n\n\t\t\tDrawTextFit(this.character.Name, 1111, 190, 189, \"Black\");\n\t\t\tDrawText(\"is permitted\", 1111, 235, \"Black\");\n\t\t\tDrawText(\"Lowest permitted role\", 1370, 235, \"Black\");\n\t\t\tMainCanvas.beginPath();\n\t\t\tMainCanvas.moveTo(1335, 230);\n\t\t\tMainCanvas.lineTo(1335, 230 + 610);\n\t\t\tMainCanvas.stroke();\n\n\t\t\t// filter\n\t\t\tDrawText(\"Filter:\", 130, 215, \"Black\");\n\t\t\tElementPosition(\"BCX_PermissionsFilter\", 550, 210, 600, 64);\n\n\t\t\t//reset button\n\t\t\tif ((document.getElementById(\"BCX_PermissionsFilter\") as HTMLInputElement | undefined)?.value) {\n\t\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\t\tDrawButton(870, 182, 64, 64, \"X\", \"White\");\n\t\t\t}\n\n\t\t\tMainCanvas.textAlign = \"left\";\n\t\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\t\tif (i >= this.permList.length) break;\n\t\t\t\tconst e = this.permList[i];\n\n\t\t\t\tconst Y = 275 + off * 100;\n\n\t\t\t\tif (e.separator) {\n\t\t\t\t\t// idea to highlight the section separator\n\t\t\t\t\tMainCanvas.beginPath();\n\t\t\t\t\tMainCanvas.rect(125, Y, 1173, 64);\n\t\t\t\t\tMainCanvas.fillStyle = \"#eeeeee\";\n\t\t\t\t\tMainCanvas.fill();\n\t\t\t\t\tDrawText(`${e.name} module permissions`, 140, Y + 34, \"Black\");\n\t\t\t\t} else {\n\t\t\t\t\tDrawImageEx(MODULE_ICONS[e.permissionInfo.category], 125, Y, {\n\t\t\t\t\t\tHeight: 64,\n\t\t\t\t\t\tWidth: 64\n\t\t\t\t\t});\n\t\t\t\t\t// Permission name\n\t\t\t\t\tDrawButton(200, Y, 1000, 64, \"\", \"White\");\n\t\t\t\t\tDrawTextFit(e.permissionInfo.name, 210, Y + 34, 990, \"Black\");\n\t\t\t\t\t// Self checkbox\n\t\t\t\t\tDrawButton(1235, Y, 64, 64, \"\", e.editSelf ? \"White\" : \"#ddd\", e.permissionInfo.self ? \"Icons/Checked.png\" : \"\", undefined, !e.editSelf);\n\t\t\t\t\t// Min access\n\t\t\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\t\t\tDrawButton(1370, Y, 170, 64, getPermissionMinDisplayText(e.permissionInfo.min, this.character), e.editMin ? \"White\" : \"#ddd\", undefined, undefined, !e.editMin);\n\t\t\t\t\tMainCanvas.textAlign = \"left\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Pagination\n\t\t\tconst totalPages = Math.max(1, Math.ceil(this.permList.length / PER_PAGE_COUNT));\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawBackNextButton(1605, 800, 300, 90, `${DialogFindPlayer(\"Page\")} ${this.page + 1} / ${totalPages}`, \"White\", \"\", () => \"\", () => \"\");\n\t\t} else if (this.failed) {\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawText(`Failed to get permission data from ${this.character.Name}. Maybe you have no access?`, 1000, 480, \"Black\");\n\t\t} else {\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawText(\"Loading...\", 1000, 480, \"Black\");\n\t\t}\n\n\t\tMainCanvas.textAlign = \"left\";\n\n\t\tDrawText(`- Authority: Permission Settings for ${this.character.Name} -`, 125, 125, \"Black\", \"Gray\");\n\t\tMainCanvas.textAlign = \"center\";\n\t\tDrawButton(1815, 75, 90, 90, \"\", \"White\", \"Icons/Exit.png\", \"BCX main menu\");\n\t\tDrawButton(1815, 190, 90, 90, \"\", \"White\", icon_OwnerList, \"Role management\");\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\n\t\t// Owner list\n\t\tif (MouseIn(1815, 190, 90, 90)) return setSubscreen(new GuiAuthorityRoles(this.character));\n\n\t\tif (this.permissionData !== null) {\n\n\t\t\t//reset button\n\t\t\tconst elem = document.getElementById(\"BCX_PermissionsFilter\") as HTMLInputElement | undefined;\n\t\t\tif (MouseIn(870, 182, 64, 64) && elem) {\n\t\t\t\telem.value = \"\";\n\t\t\t\tthis.rebuildList();\n\t\t\t}\n\n\t\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\t\tif (i >= this.permList.length) break;\n\t\t\t\tconst e = this.permList[i];\n\n\t\t\t\tconst Y = 275 + off * 100;\n\n\t\t\t\tif (!e.separator) {\n\t\t\t\t\t// Permission name\n\t\t\t\t\tif (MouseIn(200, Y, 1000, 64)) {\n\t\t\t\t\t\t// TODO\n\t\t\t\t\t}\n\t\t\t\t\t// Self checkbox\n\t\t\t\t\tif (MouseIn(1235, Y, 64, 64) && e.editSelf) {\n\t\t\t\t\t\tif (e.permissionInfo.self &&\n\t\t\t\t\t\t\tthis.character.isPlayer() &&\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\te.permission === \"authority_grant_self\" ||\n\t\t\t\t\t\t\t\t!checkPermissionAccess(\"authority_grant_self\", getPlayerCharacter())\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// If Player couldn't switch back on, show warning instead\n\t\t\t\t\t\t\tsetSubscreen(new GuiAuthorityDialogSelf(this.character, e.permission, e.permissionInfo, this));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.character.setPermission(e.permission, \"self\", !e.permissionInfo.self);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// Min access\n\t\t\t\t\tif (MouseIn(1370, Y, 170, 64) && e.editMin) {\n\t\t\t\t\t\tconst access_editMin = this.permissionData.authority_edit_min ?\n\t\t\t\t\t\t\tcheckPermisionAccesData(this.permissionData.authority_edit_min, this.myAccessLevel) :\n\t\t\t\t\t\t\tfalse;\n\t\t\t\t\t\tsetSubscreen(new GuiAuthorityDialogMin(\n\t\t\t\t\t\t\tthis.character,\n\t\t\t\t\t\t\te.permission,\n\t\t\t\t\t\t\te.permissionInfo,\n\t\t\t\t\t\t\tthis.myAccessLevel,\n\t\t\t\t\t\t\t!access_editMin || !checkPermisionAccesData(e.permissionInfo, this.myAccessLevel),\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Pagination\n\t\t\tconst totalPages = Math.ceil(this.permList.length / PER_PAGE_COUNT);\n\t\t\tif (MouseIn(1605, 800, 150, 90)) {\n\t\t\t\tthis.page--;\n\t\t\t\tif (this.page < 0) {\n\t\t\t\t\tthis.page = Math.max(totalPages - 1, 0);\n\t\t\t\t}\n\t\t\t} else if (MouseIn(1755, 800, 150, 90)) {\n\t\t\t\tthis.page++;\n\t\t\t\tif (this.page >= totalPages) {\n\t\t\t\t\tthis.page = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tExit() {\n\t\tsetSubscreen(new GuiMainMenu(this.character));\n\t}\n\n\tUnload() {\n\t\tElementRemove(\"BCX_PermissionsFilter\");\n\t}\n}\n","import { setSubscreen } from \"../modules/gui\";\nimport { clearAllData } from \"../modules/storage\";\nimport { GuiSubscreen } from \"./subscreen\";\n\nexport class GuiGlobalDialogClearData extends GuiSubscreen {\n\n\tpublic back: GuiSubscreen;\n\n\tprivate allowedConfirmTime: number | null = 0;\n\n\tconstructor(back: GuiSubscreen) {\n\t\tsuper();\n\t\tthis.back = back;\n\t}\n\n\tLoad() {\n\t\tthis.allowedConfirmTime = Date.now() + 10_000;\n\t}\n\n\tRun() {\n\t\tMainCanvas.textAlign = \"center\";\n\n\t\tDrawText(`- Permanent deletion of ALL Bondage Club Extended data -`, 1000, 125, \"Black\");\n\n\t\tDrawText(\"- Warning -\", 1000, 225, \"Black\", \"Black\");\n\t\tDrawText(\"If you confirm, all BCX data (including settings, curses, logs, ...) will be permanently deleted!\", 1000, 325, \"Black\");\n\n\t\tDrawText(\"As part of the deletion process, the window will reload, logging you out of your account.\", 1000, 500, \"Gray\");\n\t\tDrawText(\"You will be able to use BCX again, but none of your current data will be coming back!\", 1000, 550, \"Gray\");\n\n\t\tDrawText(\"This action cannot be undone!\", 1000, 625, \"Red\", \"Black\");\n\n\t\tif (this.allowedConfirmTime === null) {\n\t\t\tDrawText(\"Deleting...\", 1000, 720, \"Black\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst now = Date.now();\n\t\tif (now < this.allowedConfirmTime) {\n\t\t\tDrawButton(300, 720, 200, 80, `Confirm (${Math.floor((this.allowedConfirmTime - now) / 1000)})`, \"#ddd\", undefined, undefined, true);\n\t\t} else {\n\t\t\tDrawButton(300, 720, 200, 80, \"Confirm\", \"White\");\n\t\t}\n\n\t\tDrawButton(1520, 720, 200, 80, \"Cancel\", \"White\");\n\t}\n\n\tClick() {\n\t\tif (this.allowedConfirmTime === null) return;\n\n\t\tif (MouseIn(1520, 720, 200, 80)) return this.Exit();\n\n\t\tif (MouseIn(300, 720, 200, 80) && Date.now() >= this.allowedConfirmTime) return this.Confirm();\n\t}\n\n\tConfirm() {\n\t\tthis.allowedConfirmTime = null;\n\t\tclearAllData();\n\t}\n\n\tExit() {\n\t\tif (this.allowedConfirmTime === null) return;\n\t\tsetSubscreen(this.back);\n\t}\n}\n","import { setSubscreen } from \"../modules/gui\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { ModuleCategory, MODULE_ICONS, MODULE_NAMES, TOGGLEABLE_MODULES } from \"../constants\";\nimport { DrawImageEx } from \"../utilsClub\";\nimport { moduleIsEnabled, setDisabledModules } from \"../modules/presets\";\nimport { GuiGlobal } from \"./global\";\nimport { getPlayerCharacter } from \"../characters\";\n\nexport class GuiGlobalModuleToggling extends GuiSubscreen {\n\n\tprivate enabledModules = new Set<ModuleCategory>();\n\tprivate changed: boolean = false;\n\n\tLoad() {\n\t\tthis.enabledModules.clear();\n\t\tfor (const m of TOGGLEABLE_MODULES.filter(i => moduleIsEnabled(i))) {\n\t\t\tthis.enabledModules.add(m);\n\t\t}\n\t\tthis.changed = false;\n\t}\n\n\tRun() {\n\t\tMainCanvas.textAlign = \"left\";\n\t\tDrawText(`- Global: Enable/Disable BCX's modules -`, 125, 125, \"Black\", \"Gray\");\n\t\tDrawText(`Warning: Disabling a module will reset all its settings and stored data!`, 125, 180, \"FireBrick\");\n\n\t\tfor (let i = 0; i < TOGGLEABLE_MODULES.length; i++) {\n\t\t\tconst module = TOGGLEABLE_MODULES[i];\n\t\t\tconst PX = Math.floor(i / 5);\n\t\t\tconst PY = i % 5;\n\n\t\t\tDrawCheckbox(150 + 500 * PX, 240 + 110 * PY, 64, 64, \"\", this.enabledModules.has(module));\n\t\t\tDrawImageEx(MODULE_ICONS[module], 280 + 500 * PX, 240 + 110 * PY, {\n\t\t\t\tHeight: 64,\n\t\t\t\tWidth: 64\n\t\t\t});\n\t\t\tDrawText(MODULE_NAMES[module], 370 + 500 * PX, 240 + 32 + 110 * PY, \"Black\");\n\t\t}\n\n\t\tMainCanvas.textAlign = \"center\";\n\n\t\tDrawButton(300, 800, 200, 80, \"Confirm\", this.changed ? \"White\" : \"#ddd\", undefined, undefined, !this.changed);\n\n\t\tDrawButton(1520, 800, 200, 80, \"Cancel\", \"White\");\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\n\t\tfor (let i = 0; i < TOGGLEABLE_MODULES.length; i++) {\n\t\t\tconst module = TOGGLEABLE_MODULES[i];\n\t\t\tconst PX = Math.floor(i / 5);\n\t\t\tconst PY = i % 5;\n\n\t\t\tif (MouseIn(150 + 500 * PX, 240 + 110 * PY, 64, 64)) {\n\t\t\t\tif (this.enabledModules.has(module)) {\n\t\t\t\t\tthis.enabledModules.delete(module);\n\t\t\t\t} else {\n\t\t\t\t\tthis.enabledModules.add(module);\n\t\t\t\t}\n\t\t\t\tthis.changed = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (MouseIn(300, 800, 200, 80) && this.changed) {\n\t\t\tif (setDisabledModules(TOGGLEABLE_MODULES.filter(i => !this.enabledModules.has(i)))) {\n\t\t\t\tthis.Exit();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (MouseIn(1520, 800, 200, 80)) {\n\t\t\treturn this.Exit();\n\t\t}\n\t}\n\n\tExit() {\n\t\tsetSubscreen(new GuiGlobal(getPlayerCharacter()));\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { setSubscreen } from \"../modules/gui\";\nimport { GuiGlobalDialogClearData } from \"./global_dialogClearData\";\nimport { GuiMainMenu } from \"./mainmenu\";\nimport { GuiGlobalModuleToggling } from \"./global_moduleToggling\";\nimport { GuiSubscreen } from \"./subscreen\";\n\nexport class GuiGlobal extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\n\tconstructor(character: ChatroomCharacter) {\n\t\tsuper();\n\t\tthis.character = character;\n\t}\n\n\n\tRun() {\n\t\tMainCanvas.textAlign = \"left\";\n\t\tDrawText(`- Global: Configuration for ${this.character.Name} -`, 125, 125, \"Black\", \"Gray\");\n\n\t\tMainCanvas.textAlign = \"center\";\n\t\tDrawButton(1815, 75, 90, 90, \"\", \"White\", \"Icons/Exit.png\", \"BCX main menu\");\n\n\t\tif (!this.character.isPlayer()) {\n\t\t\tDrawText(`Global configuration is not possible on others`, 1000, 500, \"Black\");\n\t\t\treturn;\n\t\t}\n\n\t\tDrawButton(120, 200, 400, 90, \"Manage BCX modules\", \"White\", \"\", \"Enable/Disable individual modules\");\n\n\t\tDrawButton(1605, 800, 300, 90, \"Clear all BCX data\", \"#FF3232\", \"\", \"Emergency reset of BCX\");\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\n\t\tif (!this.character.isPlayer())\n\t\t\treturn;\n\n\t\tif (MouseIn(120, 200, 400, 90)) {\n\t\t\tsetSubscreen(new GuiGlobalModuleToggling());\n\t\t\treturn;\n\t\t}\n\n\t\tif (MouseIn(1605, 800, 300, 90)) {\n\t\t\tsetSubscreen(new GuiGlobalDialogClearData(this));\n\t\t\treturn;\n\t\t}\n\t}\n\n\tExit() {\n\t\tsetSubscreen(new GuiMainMenu(this.character));\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { GuiMainMenu } from \"./mainmenu\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { LogAccessLevel, LogConfig, LOG_CONFIG_NAMES, LOG_LEVEL_NAMES } from \"../modules/log\";\nimport { GuiLog } from \"./log\";\nimport { setSubscreen } from \"../modules/gui\";\n\ntype ConfigListItem = (\n\t{\n\t\tcategory: BCX_LogCategory;\n\t\taccess: LogAccessLevel;\n\t\tname: string;\n\t}\n);\n\nconst PER_PAGE_COUNT = 6;\n\nexport class GuiLogConfig extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\tprivate config: LogConfig | null = null;\n\tprivate failed: boolean = false;\n\tprivate configList: ConfigListItem[] = [];\n\tprivate allowDelete: boolean = false;\n\tprivate allowConfigure: boolean = false;\n\tprivate page: number = 0;\n\n\tconstructor(character: ChatroomCharacter) {\n\t\tsuper();\n\t\tthis.character = character;\n\t}\n\n\tLoad() {\n\t\tthis.requestData();\n\t}\n\n\tonChange(sender: number) {\n\t\tif (sender === this.character.MemberNumber) {\n\t\t\tthis.requestData();\n\t\t}\n\t}\n\n\tprivate requestData() {\n\t\tthis.config = null;\n\t\tthis.rebuildList();\n\t\tPromise.all([\n\t\t\tthis.character.getLogConfig(),\n\t\t\tthis.character.getPermissionAccess(\"log_delete\"),\n\t\t\tthis.character.getPermissionAccess(\"log_configure\")\n\t\t]).then(res => {\n\t\t\tthis.config = res[0];\n\t\t\tthis.allowDelete = res[1];\n\t\t\tthis.allowConfigure = res[2];\n\t\t\tthis.rebuildList();\n\t\t}, err => {\n\t\t\tconsole.error(`BCX: Failed to get log config for ${this.character}`, err);\n\t\t\tthis.failed = true;\n\t\t});\n\t}\n\n\tprivate rebuildList() {\n\t\tif (!this.active) return;\n\n\t\tthis.configList = [];\n\t\tlet Input = document.getElementById(\"BCX_LogConfigFilter\") as HTMLInputElement | undefined;\n\t\tif (this.config === null) {\n\t\t\tif (Input) {\n\t\t\t\tInput.remove();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Input) {\n\t\t\tInput = ElementCreateInput(\"BCX_LogConfigFilter\", \"text\", \"\", \"30\");\n\t\t\tInput.addEventListener(\"input\", ev => {\n\t\t\t\tthis.rebuildList();\n\t\t\t});\n\t\t}\n\n\t\tconst filter = Input.value.trim().toLocaleLowerCase().split(\" \");\n\n\t\tfor (const [k, v] of Object.entries(this.config) as [BCX_LogCategory, LogAccessLevel][]) {\n\t\t\tif (LOG_CONFIG_NAMES[k] !== undefined &&\n\t\t\t\tLOG_LEVEL_NAMES[v] !== undefined &&\n\t\t\t\tfilter.every(i =>\n\t\t\t\t\tLOG_CONFIG_NAMES[k].toLocaleLowerCase().includes(i) ||\n\t\t\t\t\tk.toLocaleLowerCase().includes(i)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tthis.configList.push({\n\t\t\t\t\tcategory: k,\n\t\t\t\t\taccess: v,\n\t\t\t\t\tname: LOG_CONFIG_NAMES[k]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tthis.configList.sort((a, b) => a.name.localeCompare(b.name));\n\n\t\tconst totalPages = Math.ceil(this.configList.length / PER_PAGE_COUNT);\n\t\tif (this.page < 0) {\n\t\t\tthis.page = Math.max(totalPages - 1, 0);\n\t\t} else if (this.page >= totalPages) {\n\t\t\tthis.page = 0;\n\t\t}\n\t}\n\n\tRun() {\n\t\tif (this.config !== null) {\n\n\t\t\t// filter\n\t\t\tDrawText(\"Filter:\", 130, 215, \"Black\");\n\t\t\tElementPosition(\"BCX_LogConfigFilter\", 550, 210, 600, 64);\n\n\t\t\t//reset button\n\t\t\tif ((document.getElementById(\"BCX_LogConfigFilter\") as HTMLInputElement | undefined)?.value) {\n\t\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\t\tDrawButton(870, 182, 64, 64, \"X\", \"White\");\n\t\t\t}\n\n\t\t\tMainCanvas.textAlign = \"left\";\n\t\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\t\tif (i >= this.configList.length) break;\n\t\t\t\tconst e = this.configList[i];\n\n\t\t\t\tconst Y = 290 + off * 100;\n\n\t\t\t\t// Config name\n\t\t\t\tDrawButton(130, Y, 1070, 64, \"\", \"White\");\n\t\t\t\tDrawTextFit(e.name, 140, Y + 34, 1060, \"Black\");\n\t\t\t\t// Config access\n\t\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\t\tif (this.allowConfigure) {\n\t\t\t\t\tDrawBackNextButton(1270, Y, 170, 64, LOG_LEVEL_NAMES[e.access], \"White\", \"\",\n\t\t\t\t\t\t() => (e.access > 0 ? LOG_LEVEL_NAMES[(e.access - 1) as LogAccessLevel] : \"\"),\n\t\t\t\t\t\t() => (e.access < 2 ? LOG_LEVEL_NAMES[(e.access + 1) as LogAccessLevel] : \"\")\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tDrawButton(1270, Y, 170, 64, LOG_LEVEL_NAMES[e.access], \"#ccc\", undefined, undefined, true);\n\t\t\t\t}\n\t\t\t\tMainCanvas.textAlign = \"left\";\n\t\t\t}\n\n\t\t\t// Pagination\n\t\t\tconst totalPages = Math.max(1, Math.ceil(this.configList.length / PER_PAGE_COUNT));\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawBackNextButton(1605, 800, 300, 90, `${DialogFindPlayer(\"Page\")} ${this.page + 1} / ${totalPages}`, \"White\", \"\", () => \"\", () => \"\");\n\t\t} else if (this.failed) {\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawText(`Failed to get log config data from ${this.character.Name}. Maybe you have no access?`, 1000, 480, \"Black\");\n\t\t} else {\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawText(\"Loading...\", 1000, 480, \"Black\");\n\t\t}\n\n\t\tMainCanvas.textAlign = \"left\";\n\n\t\tDrawText(`- Behaviour Log: Configuration for ${this.character.Name} -`, 125, 125, \"Black\", \"Gray\");\n\t\tMainCanvas.textAlign = \"center\";\n\t\tif (this.allowDelete) {\n\t\t\tDrawButton(1525, 690, 380, 64, \"Delete all log entries\", \"White\");\n\t\t}\n\n\t\tDrawButton(1815, 75, 90, 90, \"\", \"White\", \"Icons/Exit.png\", \"BCX main menu\");\n\t\tDrawButton(1815, 190, 90, 90, \"\", \"White\", \"Icons/West.png\", \"Previous screen\");\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\n\t\tif (MouseIn(1815, 190, 90, 90)) return setSubscreen(new GuiLog(this.character));\n\n\t\tif (this.config !== null) {\n\n\t\t\t//reset button\n\t\t\tconst elem = document.getElementById(\"BCX_LogConfigFilter\") as HTMLInputElement | undefined;\n\t\t\tif (MouseIn(870, 182, 64, 64) && elem) {\n\t\t\t\telem.value = \"\";\n\t\t\t\tthis.rebuildList();\n\t\t\t}\n\n\t\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\t\tif (i >= this.configList.length) break;\n\t\t\t\tconst e = this.configList[i];\n\n\t\t\t\tconst Y = 290 + off * 100;\n\n\t\t\t\tif (e.access > 0 && MouseIn(1270, Y, 85, 64) && this.allowConfigure) {\n\t\t\t\t\tthis.character.setLogConfig(e.category, (e.access - 1) as LogAccessLevel);\n\t\t\t\t\treturn;\n\t\t\t\t} else if (e.access < 2 && MouseIn(1355, Y, 85, 64) && this.allowConfigure) {\n\t\t\t\t\tthis.character.setLogConfig(e.category, (e.access + 1) as LogAccessLevel);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Clear log button\n\t\t\tif (MouseIn(1525, 690, 380, 64) && this.allowDelete) {\n\t\t\t\tthis.character.logClear().then(() => {\n\t\t\t\t\tsetSubscreen(new GuiLog(this.character));\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Pagination\n\t\t\tconst totalPages = Math.ceil(this.configList.length / PER_PAGE_COUNT);\n\t\t\tif (MouseIn(1605, 800, 150, 90)) {\n\t\t\t\tthis.page--;\n\t\t\t\tif (this.page < 0) {\n\t\t\t\t\tthis.page = Math.max(totalPages - 1, 0);\n\t\t\t\t}\n\t\t\t} else if (MouseIn(1755, 800, 150, 90)) {\n\t\t\t\tthis.page++;\n\t\t\t\tif (this.page >= totalPages) {\n\t\t\t\t\tthis.page = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tExit() {\n\t\tsetSubscreen(new GuiMainMenu(this.character));\n\t}\n\n\tUnload() {\n\t\tElementRemove(\"BCX_LogConfigFilter\");\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { GuiMainMenu } from \"./mainmenu\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { LogAccessLevel, LogEntry, logMessageRender } from \"../modules/log\";\nimport { GuiLogConfig } from \"./log_config\";\nimport { DrawImageEx } from \"../utilsClub\";\nimport { setSubscreen } from \"../modules/gui\";\n\nconst PER_PAGE_COUNT = 5;\n\nexport class GuiLog extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\tprivate failed: boolean = false;\n\tprivate logData: LogEntry[] | null = null;\n\tprivate logEntries: LogEntry[] = [];\n\tprivate allowDeletion: boolean = false;\n\tprivate allowConfiguration: boolean = false;\n\tprivate allowPraise: boolean = false;\n\tprivate allowLeaveMessage: boolean = false;\n\tprivate page: number = 0;\n\n\tconstructor(character: ChatroomCharacter) {\n\t\tsuper();\n\t\tthis.character = character;\n\t}\n\n\tLoad() {\n\t\tthis.requestData();\n\t}\n\n\tonChange(sender: number) {\n\t\tif (sender === this.character.MemberNumber) {\n\t\t\tthis.requestData();\n\t\t}\n\t}\n\n\tprivate requestData() {\n\t\tthis.logData = null;\n\t\tthis.refreshScreen();\n\t\tPromise.all([\n\t\t\tthis.character.getLogEntries(),\n\t\t\tthis.character.logGetAllowedActions()\n\t\t]).then(res => {\n\t\t\tthis.logData = res[0];\n\t\t\tthis.allowDeletion = res[1].delete;\n\t\t\tthis.allowConfiguration = res[1].configure || this.character.isPlayer();\n\t\t\tthis.allowPraise = res[1].praise;\n\t\t\tthis.allowLeaveMessage = res[1].leaveMessage;\n\t\t\tthis.refreshScreen();\n\t\t}, err => {\n\t\t\tconsole.error(`BCX: Failed to get log data for ${this.character}`, err);\n\t\t\tthis.failed = true;\n\t\t});\n\t}\n\n\tprivate refreshScreen() {\n\t\tif (!this.active) return;\n\n\t\tthis.logEntries = [];\n\n\t\tlet LogFilter = document.getElementById(\"BCX_LogFilter\") as HTMLInputElement | undefined;\n\t\tlet NoteField = document.getElementById(\"BCX_NoteField\") as HTMLInputElement | undefined;\n\n\t\tif (this.logData === null) {\n\t\t\tif (LogFilter) {\n\t\t\t\tLogFilter.remove();\n\t\t\t}\n\t\t\tif (NoteField) {\n\t\t\t\tNoteField.remove();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (!LogFilter) {\n\t\t\tLogFilter = ElementCreateInput(\"BCX_LogFilter\", \"text\", \"\", \"30\");\n\t\t\tLogFilter.addEventListener(\"input\", ev => {\n\t\t\t\tthis.refreshScreen();\n\t\t\t});\n\t\t}\n\n\t\tif (!this.allowLeaveMessage && NoteField) {\n\t\t\tNoteField.remove();\n\t\t} else if (this.allowLeaveMessage && !NoteField) {\n\t\t\tNoteField = ElementCreateInput(\"BCX_NoteField\", \"text\", \"\", \"30\");\n\t\t}\n\n\t\tconst filter = LogFilter.value.trim().toLocaleLowerCase().split(\" \");\n\n\t\tthis.logEntries = this.logData.filter(e => {\n\t\t\tconst msg = logMessageRender(e).toLocaleLowerCase();\n\t\t\treturn filter.every(f => msg.includes(f));\n\t\t});\n\n\t\tconst totalPages = Math.ceil(this.logEntries.length / PER_PAGE_COUNT);\n\t\tif (this.page < 0) {\n\t\t\tthis.page = Math.max(totalPages - 1, 0);\n\t\t} else if (this.page >= totalPages) {\n\t\t\tthis.page = 0;\n\t\t}\n\t}\n\n\tRun() {\n\t\tif (this.logData !== null) {\n\n\t\t\t// filter\n\t\t\tDrawText(\"Filter:\", 130, 215, \"Black\");\n\t\t\tElementPosition(\"BCX_LogFilter\", 550, 210, 600, 64);\n\n\t\t\t//reset button\n\t\t\tif ((document.getElementById(\"BCX_LogFilter\") as HTMLInputElement | undefined)?.value) {\n\t\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\t\tDrawButton(870, 182, 64, 64, \"X\", \"White\");\n\t\t\t}\n\n\t\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\t\tif (i >= this.logEntries.length) break;\n\t\t\t\tconst e = this.logEntries[i];\n\n\t\t\t\tconst Y = 290 + off * 95;\n\n\t\t\t\t// Log message\n\t\t\t\tDrawImageEx(e[1] === LogAccessLevel.protected ? \"Icons/Security.png\" : \"Icons/Public.png\", 125, Y, {\n\t\t\t\t\tHeight: 64,\n\t\t\t\t\tWidth: 64\n\t\t\t\t});\n\n\t\t\t\tMainCanvas.textAlign = \"left\";\n\t\t\t\tDrawButton(200, Y, 1030, 64, \"\", \"White\");\n\t\t\t\tconst msg = logMessageRender(e);\n\t\t\t\tDrawTextFit(msg, 210, Y + 34, 1020, msg.startsWith(\"[\") ? \"Gray\" : \"Black\");\n\t\t\t\tMainCanvas.beginPath();\n\t\t\t\tMainCanvas.rect(1270, Y, 320, 64);\n\t\t\t\tMainCanvas.stroke();\n\t\t\t\tDrawTextFit(new Date(e[0]).toLocaleString(), 1290, Y + 34, 300, \"Black\", \"\");\n\n\t\t\t\tif (this.allowDeletion) {\n\t\t\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\t\t\tDrawButton(1630, Y, 64, 64, \"X\", \"White\", \"\", \"Delete log entry\");\n\t\t\t\t}\n\n\t\t\t\tif (MouseIn(125, Y, 64, 64)) {\n\t\t\t\t\tDrawButtonHover(125, Y, 64, 64, e[1] === LogAccessLevel.protected ? \"Protected visibility\" : \"Normal visibility\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Message field\n\t\t\tif (this.allowLeaveMessage) {\n\t\t\t\tMainCanvas.textAlign = \"left\";\n\t\t\t\tDrawText(\"Attach\", 130, 831, \"Black\");\n\t\t\t\tDrawText(\"note:\", 130, 869, \"Black\");\n\t\t\t\tElementPosition(\"BCX_NoteField\", 580, 842, 660, 64);\n\t\t\t}\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\t// Praise button\n\t\t\tif (this.allowPraise) {\n\t\t\t\tDrawButton(950, 815, 150, 64, \"Praise\", \"White\");\n\t\t\t}\n\t\t\t// Leave message button\n\t\t\tif (this.allowLeaveMessage) {\n\t\t\t\tDrawButton(1150, 815, 200, 64, \"Only note\", \"White\");\n\t\t\t}\n\t\t\t// Scold button\n\t\t\tif (this.allowPraise) {\n\t\t\t\tDrawButton(1400, 815, 150, 64, \"Scold\", \"White\");\n\t\t\t}\n\n\t\t\t// Pagination\n\t\t\tconst totalPages = Math.max(1, Math.ceil(this.logEntries.length / PER_PAGE_COUNT));\n\t\t\tDrawBackNextButton(1605, 800, 300, 90, `${DialogFindPlayer(\"Page\")} ${this.page + 1} / ${totalPages}`, \"White\", \"\", () => \"\", () => \"\");\n\t\t} else if (this.failed) {\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawText(`Failed to get log data from ${this.character.Name}. Maybe you have no access?`, 1000, 480, \"Black\");\n\t\t} else {\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawText(\"Loading...\", 1000, 480, \"Black\");\n\t\t}\n\n\t\tMainCanvas.textAlign = \"left\";\n\t\tDrawText(`- Behaviour Log: About ${this.character.Name} -`, 125, 125, \"Black\", \"Gray\");\n\t\tMainCanvas.textAlign = \"center\";\n\t\tDrawButton(1815, 75, 90, 90, \"\", \"White\", \"Icons/Exit.png\", \"BCX main menu\");\n\t\tDrawButton(1815, 190, 90, 90, \"\", this.allowConfiguration ? \"White\" : \"#ddd\", \"Icons/Preference.png\", \"Configure logging\", !this.allowConfiguration);\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\t\tif (MouseIn(1815, 190, 90, 90) && this.allowConfiguration) return setSubscreen(new GuiLogConfig(this.character));\n\n\t\tif (this.logData !== null) {\n\n\t\t\t//reset button\n\t\t\tconst elem = document.getElementById(\"BCX_LogFilter\") as HTMLInputElement | undefined;\n\t\t\tif (MouseIn(870, 182, 64, 64) && elem) {\n\t\t\t\telem.value = \"\";\n\t\t\t\tthis.refreshScreen();\n\t\t\t}\n\n\t\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\t\tif (i >= this.logEntries.length) break;\n\t\t\t\tconst e = this.logEntries[i];\n\n\t\t\t\tconst Y = 290 + off * 95;\n\n\t\t\t\tif (this.allowDeletion && MouseIn(1630, Y, 64, 64)) {\n\t\t\t\t\tthis.character.logMessageDelete(e[0]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst field = document.getElementById(\"BCX_NoteField\") as HTMLInputElement | undefined;\n\t\t\tconst msg = field?.value || null;\n\t\t\tlet didPraise = false;\n\n\t\t\t// Praise button\n\t\t\tif (this.allowPraise && MouseIn(950, 815, 150, 64)) {\n\t\t\t\tthis.character.logPraise(1, msg);\n\t\t\t\tdidPraise = true;\n\t\t\t}\n\t\t\t// Leave message button\n\t\t\tif (this.allowLeaveMessage && MouseIn(1150, 815, 200, 64) && msg) {\n\t\t\t\tthis.character.logPraise(0, msg);\n\t\t\t\tdidPraise = true;\n\t\t\t}\n\t\t\t// Scold button\n\t\t\tif (this.allowPraise && MouseIn(1400, 815, 150, 64)) {\n\t\t\t\tthis.character.logPraise(-1, msg);\n\t\t\t\tdidPraise = true;\n\t\t\t}\n\n\t\t\tif (didPraise) {\n\t\t\t\tthis.allowPraise = false;\n\t\t\t\tif (field) {\n\t\t\t\t\tfield.value = \"\";\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Pagination\n\t\t\tconst totalPages = Math.ceil(this.logEntries.length / PER_PAGE_COUNT);\n\t\t\tif (MouseIn(1605, 800, 150, 90)) {\n\t\t\t\tthis.page--;\n\t\t\t\tif (this.page < 0) {\n\t\t\t\t\tthis.page = Math.max(totalPages - 1, 0);\n\t\t\t\t}\n\t\t\t} else if (MouseIn(1755, 800, 150, 90)) {\n\t\t\t\tthis.page++;\n\t\t\t\tif (this.page >= totalPages) {\n\t\t\t\t\tthis.page = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tExit() {\n\t\tsetSubscreen(new GuiMainMenu(this.character));\n\t}\n\n\tUnload() {\n\t\tElementRemove(\"BCX_LogFilter\");\n\t\tElementRemove(\"BCX_NoteField\");\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { setSubscreen } from \"../modules/gui\";\nimport { getVisibleGroupName } from \"../utilsClub\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { GuiCurses } from \"./curses\";\n\nexport class GuiCursesAdd extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\n\tprivate curseData: BCX_curseInfo | null = null;\n\tprivate failed: boolean = false;\n\n\tconstructor(character: ChatroomCharacter) {\n\t\tsuper();\n\t\tthis.character = character;\n\t}\n\n\tLoad() {\n\t\tthis.requestData();\n\t}\n\n\tonChange(sender: number) {\n\t\tif (sender === this.character.MemberNumber) {\n\t\t\tthis.requestData();\n\t\t}\n\t}\n\n\tprivate requestData() {\n\t\tthis.curseData = null;\n\t\tthis.character.curseGetInfo().then(res => {\n\t\t\tthis.curseData = res;\n\t\t}, err => {\n\t\t\tconsole.error(`BCX: Failed to get permission info for ${this.character}`, err);\n\t\t\tthis.failed = true;\n\t\t});\n\t}\n\n\tRun() {\n\t\tMainCanvas.textAlign = \"left\";\n\t\tDrawText(`- Curses: Place new curses on ${this.character.Name} -`, 125, 125, \"Black\", \"Gray\");\n\t\tMainCanvas.textAlign = \"center\";\n\t\tDrawButton(1815, 75, 90, 90, \"\", \"White\", \"Icons/Exit.png\", \"Back\");\n\n\t\tif (this.curseData === null) {\n\t\t\tDrawText(this.failed ? `Failed to get curse data from ${this.character.Name}. Maybe you have no access?` : \"Loading...\", 1000, 480, \"Black\");\n\t\t\treturn;\n\t\t}\n\n\t\t// items\n\t\tMainCanvas.textAlign = \"left\";\n\t\tMainCanvas.beginPath();\n\t\tMainCanvas.rect(105, 165, 830, 64);\n\t\tMainCanvas.fillStyle = \"#cccccc\";\n\t\tMainCanvas.fill();\n\t\tDrawText(`Items`, 120, 165 + 34, \"Black\");\n\t\tMainCanvas.textAlign = \"center\";\n\t\t// TODO: Put back in when logic is ready\n\t\t// DrawButton(440, 173, 265, 48, \"Curse occupied\", \"White\", undefined, \"Curse all items on the body at once\");\n\t\t// DrawButton(720, 173, 200, 48, \"Curse all\", \"White\", undefined, \"Curse all item slots at once\");\n\n\t\tconst AssetGroupItems = AssetGroup.filter(g => g.Category === \"Item\");\n\t\tfor (let i = 0; i < AssetGroupItems.length; i++) {\n\t\t\tconst row = i % 10;\n\t\t\tconst column = Math.floor(i / 10);\n\t\t\tconst group = AssetGroupItems[i];\n\n\t\t\tconst currentItem = InventoryGet(this.character.Character, group.Name);\n\n\t\t\tconst itemIsCursed = this.curseData.curses[group.Name] !== undefined;\n\n\t\t\tDrawButton(106 + 281 * column, 240 + 69 * row, 265, 54, getVisibleGroupName(group),\n\t\t\t\titemIsCursed ? \"#ccc\" : (currentItem ? \"Gold\" : \"White\"), undefined,\n\t\t\t\titemIsCursed ? \"Already cursed\" : (currentItem ? currentItem.Asset.Description : \"Nothing\"), itemIsCursed);\n\t\t}\n\n\t\t// clothing\n\t\tMainCanvas.textAlign = \"left\";\n\t\tMainCanvas.beginPath();\n\t\tMainCanvas.rect(950, 165, 830, 64);\n\t\tMainCanvas.fillStyle = \"#cccccc\";\n\t\tMainCanvas.fill();\n\t\tDrawText(`Clothing`, 965, 165 + 34, \"Black\");\n\t\tMainCanvas.textAlign = \"center\";\n\n\t\t// TODO: Put back in when logic is ready\n\t\t// DrawButton(1285, 173, 265, 48, \"Curse occupied\", \"White\", undefined, \"Curse all clothes on the body at once\");\n\t\t// DrawButton(1565, 173, 200, 48, \"Curse all\", \"White\", undefined, \"Curse all clothing slots at once\");\n\n\t\tconst AssetGroupClothings = AssetGroup.filter(g => g.Category === \"Appearance\" && g.Clothing);\n\t\tfor (let i = 0; i < AssetGroupClothings.length; i++) {\n\t\t\tconst row = i % 10;\n\t\t\tconst column = Math.floor(i / 10);\n\t\t\tconst group = AssetGroupClothings[i];\n\n\t\t\tconst currentItem = InventoryGet(this.character.Character, group.Name);\n\n\t\t\tconst clothingIsCursed = this.curseData.curses[group.Name] !== undefined;\n\n\t\t\tDrawButton(951 + 281 * column, 240 + 69 * row, 265, 54, getVisibleGroupName(group),\n\t\t\t\tclothingIsCursed ? \"#ccc\" : (currentItem ? \"Gold\" : \"White\"), undefined,\n\t\t\t\tclothingIsCursed ? \"Already cursed\" : (currentItem ? currentItem.Asset.Description : \"Nothing\"), clothingIsCursed);\n\t\t}\n\n\t\t//Body\n\t\t// TODO: Actual data\n\n\t\t// const bodyIsCursed = false;\n\t\t// DrawButton(1600, 750, 300, 140, \"Character Body\", bodyIsCursed ? \"#ccc\" : \"White\", undefined,\n\t\t//\tbodyIsCursed ? \"Already cursed\" : \"Size, skin color, eyes, etc.\", bodyIsCursed);\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\n\t\tif (this.curseData === null)\n\t\t\treturn;\n\n\t\t// items\n\n\t\tconst AssetGroupItems = AssetGroup.filter(g => g.Category === \"Item\");\n\t\tfor (let i = 0; i < AssetGroupItems.length; i++) {\n\t\t\tconst row = i % 10;\n\t\t\tconst column = Math.floor(i / 10);\n\t\t\tconst group = AssetGroupItems[i];\n\n\t\t\tconst itemIsCursed = this.curseData.curses[group.Name] !== undefined;\n\n\t\t\tif (MouseIn(106 + 281 * column, 240 + 69 * row, 265, 54) && !itemIsCursed) {\n\t\t\t\tthis.character.curseItem(group.Name, null);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// clothing\n\n\t\tconst AssetGroupClothings = AssetGroup.filter(g => g.Category === \"Appearance\" && g.Clothing);\n\t\tfor (let i = 0; i < AssetGroupClothings.length; i++) {\n\t\t\tconst row = i % 10;\n\t\t\tconst column = Math.floor(i / 10);\n\t\t\tconst group = AssetGroupClothings[i];\n\n\t\t\tconst clothingIsCursed = this.curseData.curses[group.Name] !== undefined;\n\n\t\t\tif (MouseIn(951 + 281 * column, 240 + 69 * row, 265, 54) && !clothingIsCursed) {\n\t\t\t\tthis.character.curseItem(group.Name, null);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tExit() {\n\t\tsetSubscreen(new GuiCurses(this.character));\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { setSubscreen } from \"../modules/gui\";\nimport { GuiMainMenu } from \"./mainmenu\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { GuiCursesAdd } from \"./curses_add\";\nimport { clamp } from \"../utils\";\nimport { getVisibleGroupName, DrawImageEx } from \"../utilsClub\";\n\nconst PER_COLUMN_COUNT = 7;\nconst PER_PAGE_COUNT = PER_COLUMN_COUNT * 2;\n\ninterface CurseEntry {\n\tname: string;\n\tgroup: string;\n\tempty: boolean;\n\ttype: string;\n\tpropertiesCursed?: boolean;\n}\n\nexport class GuiCurses extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\n\tprivate curseEntries: CurseEntry[] = [];\n\tprivate curseData: BCX_curseInfo | null = null;\n\tprivate failed: boolean = false;\n\tprivate page: number = 0;\n\n\tconstructor(character: ChatroomCharacter) {\n\t\tsuper();\n\t\tthis.character = character;\n\t}\n\n\tLoad() {\n\t\tthis.requestData();\n\t}\n\n\tonChange(sender: number) {\n\t\tif (sender === this.character.MemberNumber) {\n\t\t\tthis.requestData();\n\t\t}\n\t}\n\n\tprivate requestData() {\n\t\tthis.curseData = null;\n\t\tthis.rebuildList();\n\t\tthis.character.curseGetInfo().then(res => {\n\t\t\tthis.curseData = res;\n\t\t\tthis.rebuildList();\n\t\t}, err => {\n\t\t\tconsole.error(`BCX: Failed to get curse info for ${this.character}`, err);\n\t\t\tthis.failed = true;\n\t\t});\n\t}\n\n\tprivate rebuildList() {\n\t\tif (!this.active) return;\n\n\t\tthis.curseEntries = [];\n\n\t\tif (this.curseData === null)\n\t\t\treturn;\n\n\t\tfor (const [k, v] of Object.entries(this.curseData.curses)) {\n\t\t\tconst group = AssetGroup.find(g => g.Name === k);\n\t\t\tif (!group) {\n\t\t\t\tconsole.warn(`BCX: Unknown group ${k}`);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (v === null) {\n\t\t\t\tthis.curseEntries.push({\n\t\t\t\t\tgroup: k,\n\t\t\t\t\tname: `Blocked: ${getVisibleGroupName(group)}`,\n\t\t\t\t\tempty: true,\n\t\t\t\t\ttype: group.Clothing ? \"clothing\" : \"item\"\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst item = AssetGet(this.character.Character.AssetFamily, k, v.Name);\n\t\t\t\tthis.curseEntries.push({\n\t\t\t\t\tgroup: k,\n\t\t\t\t\tname: `${item?.Description ?? v.Name} (${getVisibleGroupName(group)})`,\n\t\t\t\t\tempty: false,\n\t\t\t\t\ttype: group.Clothing ? \"clothing\" : \"item\",\n\t\t\t\t\tpropertiesCursed: v.curseProperties\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.page = clamp(this.page, 0, Math.ceil(this.curseEntries.length / PER_PAGE_COUNT));\n\t}\n\n\tRun() {\n\t\tMainCanvas.textAlign = \"left\";\n\t\tDrawText(`- Curses: All active curses on ${this.character.Name} -`, 125, 125, \"Black\", \"Gray\");\n\t\tMainCanvas.textAlign = \"center\";\n\t\tDrawButton(1815, 75, 90, 90, \"\", \"White\", \"Icons/Exit.png\", \"BCX main menu\");\n\n\t\tif (this.curseData === null) {\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawText(this.failed ? `Failed to get curse data from ${this.character.Name}. Maybe you have no access?` : \"Loading...\", 1000, 480, \"Black\");\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\tif (i >= this.curseEntries.length) break;\n\t\t\tconst e = this.curseEntries[i];\n\n\t\t\tconst Y = 170 + (off % PER_COLUMN_COUNT) * 90;\n\t\t\tconst X = 120 + Math.floor(off / PER_COLUMN_COUNT) * 865;\n\n\t\t\t// curse description\n\t\t\tMainCanvas.textAlign = \"left\";\n\t\t\tMainCanvas.beginPath();\n\t\t\tMainCanvas.rect(X, Y, 440, 60);\n\t\t\tMainCanvas.stroke();\n\t\t\tDrawImageEx(e.type === \"clothing\" ? \"Icons/Dress.png\" : \"Assets/Female3DCG/ItemArms/Preview/NylonRope.png\", X + 6, Y + 6, {\n\t\t\t\tHeight: 50,\n\t\t\t\tWidth: 50\n\t\t\t});\n\t\t\tDrawTextFit(e.name, X + 65, Y + 30, 375, \"Black\");\n\n\t\t\t// timer info\n\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\tDrawButton(X + 470, Y, 150, 60, \"∞\", \"White\", \"\", \"Permanent curse\");\n\n\t\t\t// item settings curse\n\t\t\tif (!e.empty) {\n\t\t\t\tconst allowPropertyChange = e.propertiesCursed ? this.curseData.allowLift : this.curseData.allowCurse;\n\n\t\t\t\tDrawButton(X + 650, Y, 60, 60, \"\",\n\t\t\t\t\tallowPropertyChange ? (e.propertiesCursed ? \"Gold\" : \"White\") : \"#ddd\", \"\",\n\t\t\t\t\te.propertiesCursed ? \"Lift curse of item settings only\" : \"Curse the item settings, too\", !allowPropertyChange);\n\t\t\t\tDrawImageEx(e.propertiesCursed ? \"Icons/Lock.png\" : \"Icons/Unlock.png\", X + 655, Y + 5, {\n\t\t\t\t\tHeight: 50,\n\t\t\t\t\tWidth: 50\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// remove curse\n\t\t\tif (this.curseData.allowLift) {\n\t\t\t\tDrawButton(X + 740, Y, 60, 60, \"X\", \"White\", \"\", \"Lift curse\");\n\t\t\t}\n\t\t}\n\n\t\t// Column separator\n\t\tMainCanvas.beginPath();\n\t\tMainCanvas.moveTo(954, 160);\n\t\tMainCanvas.lineTo(954, 780);\n\t\tMainCanvas.stroke();\n\n\t\tMainCanvas.textAlign = \"center\";\n\n\t\tDrawButton(120, 820, 400, 90, \"Add new curse\", this.curseData.allowCurse ? \"White\" : \"#ddd\", \"\",\n\t\t\tthis.curseData.allowCurse ? \"Place new curse on body, items or clothes\" : \"You have no permission to use this\", !this.curseData.allowCurse);\n\n\t\t// Pagination\n\t\tconst totalPages = Math.ceil(this.curseEntries.length / PER_PAGE_COUNT);\n\t\tDrawBackNextButton(1605, 820, 300, 90, `Page ${this.page + 1} / ${Math.max(totalPages, 1)}`, \"White\", \"\", () => \"\", () => \"\");\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\n\t\tif (this.curseData === null)\n\t\t\treturn;\n\n\t\tfor (let off = 0; off < PER_PAGE_COUNT; off++) {\n\t\t\tconst i = this.page * PER_PAGE_COUNT + off;\n\t\t\tif (i >= this.curseEntries.length) break;\n\t\t\tconst e = this.curseEntries[i];\n\n\t\t\tconst Y = 170 + (off % PER_COLUMN_COUNT) * 90;\n\t\t\tconst X = 120 + Math.floor(off / PER_COLUMN_COUNT) * 865;\n\n\t\t\tconst allowPropertyChange = e.propertiesCursed ? this.curseData.allowLift : this.curseData.allowCurse;\n\n\t\t\tif (!e.empty && allowPropertyChange && MouseIn(X + 650, Y, 60, 60)) {\n\t\t\t\tthis.character.curseItem(e.group, !e.propertiesCursed);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.curseData.allowLift && MouseIn(X + 740, Y, 60, 60)) {\n\t\t\t\tthis.character.curseLift(e.group);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t}\n\n\t\tif (this.curseData.allowCurse && MouseIn(120, 820, 400, 90)) {\n\t\t\treturn setSubscreen(new GuiCursesAdd(this.character));\n\t\t}\n\n\t\t// Pagination\n\t\tconst totalPages = Math.ceil(this.curseEntries.length / PER_PAGE_COUNT);\n\t\tif (MouseIn(1605, 800, 150, 90)) {\n\t\t\tthis.page--;\n\t\t\tif (this.page < 0) {\n\t\t\t\tthis.page = Math.max(totalPages - 1, 0);\n\t\t\t}\n\t\t} else if (MouseIn(1755, 800, 150, 90)) {\n\t\t\tthis.page++;\n\t\t\tif (this.page >= totalPages) {\n\t\t\t\tthis.page = 0;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tExit() {\n\t\tsetSubscreen(new GuiMainMenu(this.character));\n\t}\n}\n","import { allowMode, detectOtherMods } from \"../utilsClub\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { hookFunction, patchFunction } from \"../patching\";\nimport { MiscCheat } from \"../constants\";\nimport { modStorage, modStorageSync } from \"./storage\";\n\nexport function cheatIsEnabled(cheat: MiscCheat): boolean {\n\treturn Array.isArray(modStorage.cheats) && modStorage.cheats.includes(cheat);\n}\n\nexport function cheatSetEnabled(cheat: MiscCheat, enabled: boolean) {\n\tif (!Array.isArray(modStorage.cheats)) {\n\t\tconsole.error(`BCX: Attempt to set cheat, while not initalized`);\n\t\treturn;\n\t}\n\n\tif (enabled) {\n\t\tif (!modStorage.cheats.includes(cheat)) {\n\t\t\tmodStorage.cheats.push(cheat);\n\t\t}\n\t} else {\n\t\tmodStorage.cheats = modStorage.cheats.filter(c => c !== cheat);\n\t}\n\tmodStorageSync();\n}\n\nexport function cheatToggle(cheat: MiscCheat) {\n\tcheatSetEnabled(cheat, !cheatIsEnabled(cheat));\n}\n\nexport class ModuleMiscPatches extends BaseModule {\n\tprivate o_Player_CanChange: (typeof Player.CanChange) | null = null;\n\n\tload() {\n\t\tif (!Array.isArray(modStorage.cheats)) {\n\t\t\tmodStorage.cheats = [];\n\t\t} else {\n\t\t\tmodStorage.cheats = modStorage.cheats.filter(c => MiscCheat[c] !== undefined);\n\t\t}\n\n\t\thookFunction(\"AsylumEntranceCanWander\", 0, () => true);\n\n\t\thookFunction(\"ElementIsScrolledToEnd\", 0, (args) => {\n\t\t\tconst element = document.getElementById(args[0]);\n\t\t\treturn element != null && element.scrollHeight - element.scrollTop - element.clientHeight <= 1;\n\t\t});\n\n\t\thookFunction(\"CheatFactor\", 1, (args, next) => {\n\t\t\tconst [CheatName, Factor] = args as [string, number];\n\n\t\t\tif (CheatName === \"CantLoseMistress\" && cheatIsEnabled(MiscCheat.CantLoseMistress)) {\n\t\t\t\treturn Factor;\n\t\t\t} else if (CheatName === \"BlockRandomKidnap\" && cheatIsEnabled(MiscCheat.BlockRandomKidnap)) {\n\t\t\t\treturn Factor;\n\t\t\t}\n\n\t\t\treturn next(args);\n\t\t});\n\n\t\thookFunction(\"PrivateRansomStart\", 0, (args, next) => {\n\t\t\tif (cheatIsEnabled(MiscCheat.BlockRandomKidnap))\n\t\t\t\treturn false;\n\n\t\t\treturn next(args);\n\t\t});\n\n\t\tconst { NMod } = detectOtherMods();\n\n\t\tif (!NMod) {\n\t\t\tpatchFunction(\"LoginMistressItems\", { 'LogQuery(\"ClubMistress\", \"Management\")': \"true\" });\n\t\t\tpatchFunction(\"LoginStableItems\", { 'LogQuery(\"JoinedStable\", \"PonyExam\") || LogQuery(\"JoinedStable\", \"TrainerExam\")': \"true\" });\n\t\t}\n\n\t\t// Cheats\n\n\t\tthis.o_Player_CanChange = Player.CanChange;\n\t\tPlayer.CanChange = () => allowMode || !!(this.o_Player_CanChange?.call(Player));\n\n\t\thookFunction(\"ChatRoomCanLeave\", 0, (args, next) => allowMode || next(args));\n\t}\n\n\trun() {\n\t\tLoginMistressItems();\n\t\tLoginStableItems();\n\t\tServerPlayerInventorySync();\n\t}\n\n\tunload() {\n\t\tif (this.o_Player_CanChange) {\n\t\t\tPlayer.CanChange = this.o_Player_CanChange;\n\t\t}\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { MiscCheat } from \"../constants\";\nimport { setSubscreen } from \"../modules/gui\";\nimport { cheatIsEnabled, cheatToggle } from \"../modules/miscPatches\";\nimport { modStorage, modStorageSync } from \"../modules/storage\";\nimport { GuiMainMenu } from \"./mainmenu\";\nimport { GuiSubscreen } from \"./subscreen\";\n\nexport class GuiMisc extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\n\tconstructor(character: ChatroomCharacter) {\n\t\tsuper();\n\t\tthis.character = character;\n\t}\n\n\n\tRun() {\n\t\tMainCanvas.textAlign = \"left\";\n\t\tDrawText(`- Miscellaneous: Configuration for ${this.character.Name} -`, 125, 125, \"Black\", \"Gray\");\n\n\t\tMainCanvas.textAlign = \"center\";\n\t\tDrawButton(1815, 75, 90, 90, \"\", \"White\", \"Icons/Exit.png\", \"BCX main menu\");\n\n\t\tif (!this.character.isPlayer()) {\n\t\t\tDrawText(`Miscellaneous module configuration is not possible on others`, 1000, 500, \"Black\");\n\t\t\treturn;\n\t\t}\n\n\t\tMainCanvas.textAlign = \"left\";\n\n\t\tDrawCheckbox(125, 200, 64, 64, \"Enable typing indicator\", !!modStorage.typingIndicatorEnable);\n\t\tDrawCheckbox(125, 300, 64, 64, \"Cheat: Prevent kidnappings\", cheatIsEnabled(MiscCheat.BlockRandomKidnap));\n\t\tDrawCheckbox(125, 400, 64, 64, \"Cheat: Prevent loosing Mistress status\", cheatIsEnabled(MiscCheat.CantLoseMistress));\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\n\t\tif (!this.character.isPlayer())\n\t\t\treturn;\n\n\t\tif (MouseIn(125, 200, 64, 64)) {\n\t\t\tmodStorage.typingIndicatorEnable = !modStorage.typingIndicatorEnable;\n\t\t\tmodStorageSync();\n\t\t}\n\n\t\tif (MouseIn(125, 300, 64, 64)) {\n\t\t\tcheatToggle(MiscCheat.BlockRandomKidnap);\n\t\t}\n\n\t\tif (MouseIn(125, 400, 64, 64)) {\n\t\t\tcheatToggle(MiscCheat.CantLoseMistress);\n\t\t}\n\t}\n\n\tExit() {\n\t\tsetSubscreen(new GuiMainMenu(this.character));\n\t}\n}\n","import { ChatroomCharacter } from \"../characters\";\nimport { ModuleCategory, MODULE_ICONS, MODULE_NAMES, TOGGLEABLE_MODULES } from \"../constants\";\nimport { GuiAuthorityPermissions } from \"./authority_permissions\";\nimport { GuiGlobal } from \"./global\";\nimport { GuiLog } from \"./log\";\nimport { GuiCurses } from \"./curses\";\nimport { GuiMisc } from \"./misc\";\nimport { GuiSubscreen } from \"./subscreen\";\nimport { setSubscreen } from \"../modules/gui\";\n\nconst MAIN_MENU_ITEMS: {module: ModuleCategory; onclick: (C: ChatroomCharacter) => void; }[] = [\n\t{\n\t\tmodule: ModuleCategory.Basic,\n\t\tonclick: (C) => {\n\t\t\tsetSubscreen(new GuiGlobal(C));\n\t\t}\n\t},\n\t{\n\t\tmodule: ModuleCategory.Authority,\n\t\tonclick: (C) => {\n\t\t\tsetSubscreen(new GuiAuthorityPermissions(C));\n\t\t}\n\t},\n\t{\n\t\tmodule: ModuleCategory.Log,\n\t\tonclick: (C) => {\n\t\t\tsetSubscreen(new GuiLog(C));\n\t\t}\n\t},\n\t{\n\t\tmodule: ModuleCategory.Curses,\n\t\tonclick: (C) => {\n\t\t\tsetSubscreen(new GuiCurses(C));\n\t\t}\n\t},\n\t{\n\t\tmodule: ModuleCategory.Misc,\n\t\tonclick: (C) => {\n\t\t\tsetSubscreen(new GuiMisc(C));\n\t\t}\n\t}\n];\n\nexport class GuiMainMenu extends GuiSubscreen {\n\n\treadonly character: ChatroomCharacter;\n\n\tprivate disabledModules: readonly ModuleCategory[] = TOGGLEABLE_MODULES;\n\n\tconstructor(character: ChatroomCharacter) {\n\t\tsuper();\n\t\tthis.character = character;\n\t}\n\n\tLoad() {\n\t\tthis.character.getDisabledModules().then(data => {\n\t\t\tthis.disabledModules = data;\n\t\t});\n\t}\n\n\tonChange(source: number) {\n\t\tif (source === this.character.MemberNumber) {\n\t\t\tthis.Load();\n\t\t}\n\t}\n\n\tRun() {\n\t\tDrawText(\"- Bondage Club Extended -\", 125, 125, \"Black\", \"Gray\");\n\t\tDrawButton(1815, 75, 90, 90, \"\", \"White\", \"Icons/Exit.png\");\n\n\t\tfor (let i = 0; i < MAIN_MENU_ITEMS.length; i++) {\n\t\t\tconst e = MAIN_MENU_ITEMS[i];\n\t\t\tconst PX = Math.floor(i / 7);\n\t\t\tconst PY = i % 7;\n\n\t\t\tconst isDisabled = this.disabledModules.includes(e.module);\n\n\t\t\tDrawButton(150 + 420 * PX, 160 + 110 * PY, 400, 90, \"\", isDisabled ? \"#ddd\" : \"White\", MODULE_ICONS[e.module],\n\t\t\t\tisDisabled ? \"Module is deactivated\" : \"\", isDisabled);\n\t\t\tDrawTextFit(MODULE_NAMES[e.module], 250 + 420 * PX, 205 + 110 * PY, 310, \"Black\");\n\t\t}\n\t}\n\n\tClick() {\n\t\tif (MouseIn(1815, 75, 90, 90)) return this.Exit();\n\n\t\tfor (let i = 0; i < MAIN_MENU_ITEMS.length; i++) {\n\t\t\tconst e = MAIN_MENU_ITEMS[i];\n\t\t\tconst PX = Math.floor(i / 7);\n\t\t\tconst PY = i % 7;\n\t\t\tif (MouseIn(150 + 420 * PX, 160 + 110 * PY, 400, 90) && !this.disabledModules.includes(e.module)) {\n\t\t\t\treturn e.onclick(this.character);\n\t\t\t}\n\t\t}\n\t}\n}\n","import { getPlayerCharacter } from \"../characters\";\nimport { setSubscreen } from \"../modules/gui\";\nimport { applyPreset } from \"../modules/presets\";\nimport { icon_OwnerList } from \"../resources\";\nimport { DrawImageEx } from \"../utilsClub\";\nimport { GuiMainMenu } from \"./mainmenu\";\nimport { GuiSubscreen } from \"./subscreen\";\n\nexport class GuiWelcomeSelection extends GuiSubscreen {\n\n\tprivate selectedPreset: number = -1;\n\n\tRun() {\n\t\tMainCanvas.textAlign = \"center\";\n\n\t\tDrawText(`- Welcome to Bondage Club Extended (BCX) -`, 1000, 100, \"Black\", \"Gray\");\n\t\tDrawText(`Please choose a preset, which sets your default experience, permissions and configuration.`, 1000, 150, \"Black\");\n\t\tDrawText(`Note: You can change the defaults, but changing to another preset is not possible without resetting BCX fully.`, 1000, 200, \"FireBrick\");\n\n\t\tconst width = 400;\n\t\tconst texts = [\"Dominant\", \"Switch/Exploring\", \"Submissive\", \"Slave\"];\n\t\tconst images = [\"Icons/Management.png\", \"Icons/Swap.png\", \"Icons/Kneel.png\", icon_OwnerList];\n\n\t\tconst descriptionDominant =\n\t\t\t`This preset is for dominants who\\n` +\n\t\t\t`never intend to submit. Therefore,\\n` +\n\t\t\t`most modules are not loaded at\\n` +\n\t\t\t`start. That said, you can still use\\n` +\n\t\t\t`the BCX graphical user interface\\n` +\n\t\t\t`on other BCX users to use actions,\\n` +\n\t\t\t`you have permission for, on them,\\n` +\n\t\t\t`same as with all other presets.`;\n\n\t\tconst descriptionSwitch =\n\t\t\t`This preset is for switches who\\n` +\n\t\t\t`are sometimes dominant and\\n` +\n\t\t\t`sometimes submissive, enabling\\n` +\n\t\t\t`them to explore BCX slowly, while\\n` +\n\t\t\t`having full control over all of its\\n` +\n\t\t\t`settings and features.`;\n\n\t\tconst descriptionSubmissive =\n\t\t\t`This preset is for submissives,\\n` +\n\t\t\t`who want to give some of their\\n` +\n\t\t\t`control to selected dominants and\\n` +\n\t\t\t`lovers, giving only them authority\\n` +\n\t\t\t`over some of BCX's settings.`;\n\n\t\tconst descriptionSlave =\n\t\t\t`This preset is a much more\\n` +\n\t\t\t`extreme submissive experience,\\n` +\n\t\t\t`not leaving much control over the\\n` +\n\t\t\t`settings and permissions to you,\\n` +\n\t\t\t`thus enabling others to use many\\n` +\n\t\t\t`of BCX's features on you, except\\n` +\n\t\t\t`the most extreme ones, which you\\n` +\n\t\t\t`can still configure to your liking.`;\n\n\t\tconst descriptions = [descriptionDominant, descriptionSwitch, descriptionSubmissive, descriptionSlave];\n\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tconst X = 125 + i * (width + 50);\n\t\t\tif (MouseIn(X, 250, width, 575)) {\n\t\t\t\tDrawRect(X, 250, width, 575, \"#ddd\");\n\t\t\t}\n\t\t\tDrawEmptyRect(X, 250, width, 575, \"Black\");\n\t\t\tif (i === this.selectedPreset) {\n\t\t\t\tconst border = 10;\n\t\t\t\tDrawEmptyRect(X - border, 250 - border, width + 2 * border, 575 + 2 * border, \"Cyan\", 5);\n\t\t\t\tDrawButton(X + 20, 850, width - 40, 65, \"Confirm\", \"White\");\n\t\t\t}\n\t\t\tDrawImageEx(images[i], X + width / 2 - 43, 275);\n\t\t\tDrawText(texts[i], X + width / 2, 400, \"Black\");\n\t\t\tMainCanvas.font = CommonGetFont(24);\n\t\t\tlet texty = 475;\n\t\t\tfor (const line of descriptions[i].split(\"\\n\")) {\n\t\t\t\tDrawText(line, X + width / 2, texty, \"Black\");\n\t\t\t\ttexty += 36;\n\t\t\t}\n\t\t\tif (i === 1) {\n\t\t\t\tDrawText(\"Easily try out all features\", X + width / 2, 775, \"Black\");\n\t\t\t} else if (i === 2) {\n\t\t\t\tDrawText(\"Similar to Ace's Cursed Script\", X+ width / 2, 775, \"Black\");\n\t\t\t}\n\t\t\tMainCanvas.font = CommonGetFont(36);\n\t\t}\n\t}\n\n\tClick() {\n\n\t\tconst width = 400;\n\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tconst X = 125 + i * (width + 50);\n\t\t\tif (MouseIn(X, 250, width, 575)) {\n\t\t\t\tthis.selectedPreset = i;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (i === this.selectedPreset && MouseIn(X + 20, 850, width - 40, 65)) {\n\t\t\t\tapplyPreset(i);\n\t\t\t\tsetSubscreen(new GuiMainMenu(getPlayerCharacter()));\n\t\t\t}\n\t\t}\n\n\t}\n\n\tExit() {\n\t\t// Empty\n\t}\n}\n","import { ChatroomCharacter, getChatroomCharacter } from \"../characters\";\nimport { GuiMainMenu } from \"../gui/mainmenu\";\nimport { GuiSubscreen } from \"../gui/subscreen\";\nimport { GuiWelcomeSelection } from \"../gui/welcome\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { hookFunction, patchFunction } from \"../patching\";\nimport { icon_BCX } from \"../resources\";\nimport { changeHandlers } from \"./messaging\";\nimport { firstTimeInit } from \"./storage\";\n\nexport function getCurrentSubscreen(): GuiSubscreen | null {\n\treturn ModuleGUI.instance && ModuleGUI.instance.currentSubscreen;\n}\n\nexport function setSubscreen(subscreen: GuiSubscreen | null): void {\n\tif (!ModuleGUI.instance) {\n\t\tthrow new Error(\"Attempt to set subscreen before init\");\n\t}\n\tModuleGUI.instance.currentSubscreen = subscreen;\n}\n\nexport class ModuleGUI extends BaseModule {\n\tstatic instance: ModuleGUI | null = null;\n\n\tprivate _currentSubscreen: GuiSubscreen | null = null;\n\n\tget currentSubscreen(): GuiSubscreen | null {\n\t\treturn this._currentSubscreen;\n\t}\n\n\tset currentSubscreen(subscreen: GuiSubscreen | null) {\n\t\tif (this._currentSubscreen) {\n\t\t\tthis._currentSubscreen.Unload();\n\t\t}\n\t\tthis._currentSubscreen = subscreen;\n\t\tif (this._currentSubscreen) {\n\t\t\tthis._currentSubscreen.Load();\n\t\t}\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\t\tif (ModuleGUI.instance) {\n\t\t\tthrow new Error(\"Duplicate initialization\");\n\t\t}\n\t\tModuleGUI.instance = this;\n\t}\n\n\tgetInformationSheetCharacter(): ChatroomCharacter | null {\n\t\tconst C = InformationSheetSelection;\n\t\tif (!C || typeof C.MemberNumber !== \"number\") return null;\n\t\treturn getChatroomCharacter(C.MemberNumber);\n\t}\n\n\tinit() {\n\t\tchangeHandlers.push(source => {\n\t\t\tif (this._currentSubscreen) {\n\t\t\t\tthis._currentSubscreen.onChange(source);\n\t\t\t}\n\t\t});\n\t}\n\n\tload() {\n\t\tpatchFunction(\"InformationSheetRun\", {\n\t\t\t'DrawButton(1815, 765, 90, 90,': 'DrawButton(1815, 800, 90, 90,'\n\t\t});\n\t\tpatchFunction(\"InformationSheetClick\", {\n\t\t\t'MouseIn(1815, 765, 90, 90)': 'MouseIn(1815, 800, 90, 90)'\n\t\t});\n\t\thookFunction(\"InformationSheetRun\", 10, (args, next) => {\n\t\t\tif (this._currentSubscreen) {\n\t\t\t\tMainCanvas.textAlign = \"left\";\n\t\t\t\tthis._currentSubscreen.Run();\n\t\t\t\tMainCanvas.textAlign = \"center\";\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnext(args);\n\t\t\tconst C = this.getInformationSheetCharacter();\n\t\t\tif (firstTimeInit) {\n\t\t\t\tif (C && C.isPlayer()) {\n\t\t\t\t\tDrawButton(1815, 685, 90, 90, \"\", \"White\", icon_BCX);\n\t\t\t\t\tMainCanvas.beginPath();\n\t\t\t\t\tMainCanvas.rect(1300, 685, 500, 90);\n\t\t\t\t\tMainCanvas.fillStyle = \"Black\";\n\t\t\t\t\tMainCanvas.fill();\n\t\t\t\t\tDrawText(`You can find BCX here ►`, 1550, 685 + 45, \"White\");\n\t\t\t\t}\n\t\t\t} else if (C && C.BCXVersion !== null) {\n\t\t\t\tDrawButton(1815, 685, 90, 90, \"\", \"White\", icon_BCX, \"BCX\");\n\t\t\t}\n\t\t});\n\n\t\thookFunction(\"InformationSheetClick\", 10, (args, next) => {\n\t\t\tif (this._currentSubscreen) {\n\t\t\t\treturn this._currentSubscreen.Click();\n\t\t\t}\n\n\t\t\tconst C = this.getInformationSheetCharacter();\n\t\t\tif (MouseIn(1815, 685, 90, 90)) {\n\t\t\t\tif (firstTimeInit) {\n\t\t\t\t\tif (C && C.isPlayer()) {\n\t\t\t\t\t\tServerBeep = {};\n\t\t\t\t\t\tthis.currentSubscreen = new GuiWelcomeSelection();\n\t\t\t\t\t}\n\t\t\t\t} else if (C && C.BCXVersion !== null && MouseIn(1815, 685, 90, 90)) {\n\t\t\t\t\tthis.currentSubscreen = new GuiMainMenu(C);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn next(args);\n\t\t\t}\n\t\t});\n\n\t\thookFunction(\"InformationSheetExit\", 10, (args, next) => {\n\t\t\tif (this._currentSubscreen) {\n\t\t\t\treturn this._currentSubscreen.Exit();\n\t\t\t}\n\n\t\t\treturn next(args);\n\t\t});\n\t}\n\n\tunload() {\n\t\tthis.currentSubscreen = null;\n\t}\n}\n","import { modules_applyPreset, reload_modules } from \"../moduleManager\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { arrayUnique } from \"../utils\";\nimport { InfoBeep } from \"../utilsClub\";\nimport { notifyOfChange } from \"./messaging\";\nimport { finalizeFirstTimeInit, firstTimeInit, modStorage, modStorageSync } from \"./storage\";\nimport { ModuleCategory, Preset, TOGGLEABLE_MODULES } from \"../constants\";\nimport { getCurrentSubscreen } from \"./gui\";\n\nconst PRESET_DISABLED_MODULES: Record<Preset, ModuleCategory[]> = {\n\t[Preset.dominant]: [ModuleCategory.Log, ModuleCategory.Curses],\n\t[Preset.switch]: [],\n\t[Preset.submissive]: [],\n\t[Preset.slave]: []\n};\n\nexport function getCurrentPreset(): Preset {\n\treturn modStorage.preset ?? Preset.switch;\n}\n\nexport function applyPreset(preset: Preset) {\n\tmodStorage.preset = preset;\n\tmodules_applyPreset(preset);\n\tsetDisabledModules(PRESET_DISABLED_MODULES[preset]);\n\n\tfinalizeFirstTimeInit();\n}\n\nexport function setDisabledModules(modules: ModuleCategory[]): boolean {\n\tif (!Array.isArray(modStorage.disabledModules)) {\n\t\tconsole.error(\"BCX: Attempt to set disabled modules before initializetion\");\n\t\treturn false;\n\t}\n\n\tmodules = arrayUnique(modules.filter(i => TOGGLEABLE_MODULES.includes(i)));\n\n\tif (CommonArraysEqual(modules, modStorage.disabledModules))\n\t\treturn true;\n\n\tmodStorage.disabledModules = modules;\n\n\tif (reload_modules()) {\n\t\tmodStorageSync();\n\t\tnotifyOfChange();\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function getDisabledModules(): ModuleCategory[] {\n\treturn Array.isArray(modStorage.disabledModules) ? modStorage.disabledModules.slice() : [];\n}\n\nexport function moduleIsEnabled(module: ModuleCategory): boolean {\n\tif (!TOGGLEABLE_MODULES.includes(module))\n\t\treturn true;\n\n\treturn Array.isArray(modStorage.disabledModules) ? !modStorage.disabledModules.includes(module) : true;\n}\n\nexport class ModulePresets extends BaseModule {\n\tload() {\n\t\tif (typeof modStorage.preset !== \"number\" || Preset[modStorage.preset] === undefined) {\n\t\t\tmodStorage.preset = Preset.switch;\n\t\t}\n\n\t\tif (!Array.isArray(modStorage.disabledModules)) {\n\t\t\tmodStorage.disabledModules = [];\n\t\t} else {\n\t\t\tmodStorage.disabledModules = modStorage.disabledModules.filter(i => TOGGLEABLE_MODULES.includes(i));\n\t\t}\n\t}\n\n\trun() {\n\t\tif (firstTimeInit) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (firstTimeInit && getCurrentSubscreen() === null) {\n\t\t\t\t\tInfoBeep(`Please visit your profile to finish BCX setup`, Infinity);\n\t\t\t\t}\n\t\t\t}, 2000);\n\t\t}\n\t}\n}\n","import type { BaseModule } from \"./modules/_BaseModule\";\nimport { ModuleInitPhase, Preset } from \"./constants\";\nimport { getCurrentPreset } from \"./modules/presets\";\n\nexport let moduleInitPhase: ModuleInitPhase = ModuleInitPhase.construct;\nconst modules: BaseModule[] = [];\n\nexport function registerModule<T extends BaseModule>(module: T): T {\n\tif (moduleInitPhase !== ModuleInitPhase.construct) {\n\t\tthrow new Error(\"Modules can be registered only before initialization\");\n\t}\n\tmodules.push(module);\n\tconsole.debug(`BCX: Registered module ${module.constructor.name}`);\n\treturn module;\n}\n\nexport function init_modules() {\n\tmoduleInitPhase = ModuleInitPhase.init;\n\tfor (const m of modules) {\n\t\tm.init();\n\t}\n\tmoduleInitPhase = ModuleInitPhase.load;\n\tfor (const m of modules) {\n\t\tm.load(getCurrentPreset());\n\t}\n\tmoduleInitPhase = ModuleInitPhase.ready;\n\tfor (const m of modules) {\n\t\tm.run();\n\t}\n}\n\nexport function unload_modules() {\n\tmoduleInitPhase = ModuleInitPhase.destroy;\n\tfor (const m of modules) {\n\t\tm.unload();\n\t}\n}\n\nexport function reload_modules(): boolean {\n\tif (moduleInitPhase !== ModuleInitPhase.ready) {\n\t\tconsole.error(\"BCX: Attempt to reload modules, while not ready\");\n\t\treturn false;\n\t}\n\tfor (const m of modules) {\n\t\tm.reload(getCurrentPreset());\n\t}\n\treturn true;\n}\n\nexport function modules_applyPreset(preset: Preset): boolean {\n\tif (moduleInitPhase !== ModuleInitPhase.ready) {\n\t\tconsole.error(\"BCX: Attempt to apply preset to modules, while not ready\");\n\t\treturn false;\n\t}\n\tfor (const m of modules) {\n\t\tm.applyPreset(preset);\n\t}\n\treturn true;\n}\n","import { detectOtherMods, InfoBeep } from \"./utilsClub\";\nimport { VERSION } from \"./config\";\nimport { init_modules, unload_modules } from \"./moduleManager\";\nimport { unload_patches } from \"./patching\";\n\nexport function loginInit(C: any) {\n\tif (window.BCX_Loaded) return;\n\tinit();\n}\n\nfunction clearCaches() {\n\tif (typeof DrawRunMap !== \"undefined\") {\n\t\tDrawRunMap.clear();\n\t\tDrawScreen = \"\";\n\t}\n\tif (typeof CurrentScreenFunctions !== \"undefined\") {\n\t\tconst w = window as any;\n\t\tCurrentScreenFunctions = {\n\t\t\tRun: w[`${CurrentScreen}Run`],\n\t\t\tClick: w[`${CurrentScreen}Click`],\n\t\t\tLoad: typeof w[`${CurrentScreen}Load`] === \"function\" ? w[`${CurrentScreen}Load`] : undefined,\n\t\t\tUnload: typeof w[`${CurrentScreen}Unload`] === \"function\" ? w[`${CurrentScreen}Unload`] : undefined,\n\t\t\tResize: typeof w[`${CurrentScreen}Resize`] === \"function\" ? w[`${CurrentScreen}Resize`] : undefined,\n\t\t\tKeyDown: typeof w[`${CurrentScreen}KeyDown`] === \"function\" ? w[`${CurrentScreen}KeyDown`] : undefined,\n\t\t\tExit: typeof w[`${CurrentScreen}Exit`] === \"function\" ? w[`${CurrentScreen}Exit`] : undefined\n\t\t};\n\t}\n}\n\nexport function init() {\n\n\tinit_modules();\n\n\t// Loading into already loaded club - clear some caches\n\tclearCaches();\n\n\t//#region Other mod compatability\n\n\tconst { BondageClubTools } = detectOtherMods();\n\n\tif (BondageClubTools) {\n\t\tconsole.warn(\"BCX: Bondage Club Tools detected!\");\n\t\tif ((window as any).BCX_BondageClubToolsPatch === true) {\n\t\t\tconsole.info(\"BCX: Bondage Club Tools already patched, skip!\");\n\t\t} else {\n\t\t\t(window as any).BCX_BondageClubToolsPatch = true;\n\t\t\tconst ChatRoomMessageForwarder = ServerSocket.listeners(\"ChatRoomMessage\").find(i => i.toString().includes(\"window.postMessage\"));\n\t\t\tconst AccountBeepForwarder = ServerSocket.listeners(\"AccountBeep\").find(i => i.toString().includes(\"window.postMessage\"));\n\t\t\tconsole.assert(ChatRoomMessageForwarder !== undefined && AccountBeepForwarder !== undefined);\n\t\t\tServerSocket.off(\"ChatRoomMessage\");\n\t\t\tServerSocket.on(\"ChatRoomMessage\", data => {\n\t\t\t\tif (data?.Type !== \"Hidden\" || data.Content !== \"BCXMsg\" || typeof data.Sender !== \"number\") {\n\t\t\t\t\tChatRoomMessageForwarder!(data);\n\t\t\t\t}\n\t\t\t\treturn ChatRoomMessage(data);\n\t\t\t});\n\t\t\tServerSocket.off(\"AccountBeep\");\n\t\t\tServerSocket.on(\"AccountBeep\", data => {\n\t\t\t\tif (typeof data?.BeepType !== \"string\" || !data.BeepType.startsWith(\"Jmod:\")) {\n\t\t\t\t\tAccountBeepForwarder!(data);\n\t\t\t\t}\n\t\t\t\treturn ServerAccountBeep(data);\n\t\t\t});\n\t\t}\n\t}\n\n\t//#endregion\n\n\twindow.BCX_Loaded = true;\n\tInfoBeep(`BCX loaded! Version: ${VERSION}`);\n}\n\nexport function unload(): true {\n\tunload_patches();\n\tunload_modules();\n\n\t// clear some caches\n\tclearCaches();\n\n\tdelete window.BCX_Loaded;\n\tconsole.log(\"BCX: Unloaded.\");\n\treturn true;\n}\n","import { allowMode, detectOtherMods, isBind, isCloth } from \"../utilsClub\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { hookFunction } from \"../patching\";\nimport { clipboardAvailable } from \"../utils\";\n\nexport function j_WardrobeExportSelectionClothes(includeBinds: boolean = false): string {\n\tif (!CharacterAppearanceSelection) return \"\";\n\tconst save = CharacterAppearanceSelection.Appearance\n\t\t.filter(a => isCloth(a, true) || (includeBinds && isBind(a)))\n\t\t.map(WardrobeAssetBundle);\n\treturn LZString.compressToBase64(JSON.stringify(save));\n}\n\nexport function j_WardrobeImportSelectionClothes(data: string | ItemBundle[], includeBinds: boolean, force: boolean = false): string | true {\n\tif (typeof data !== \"string\" || data.length < 1) return \"No data\";\n\ttry {\n\t\tif (data[0] !== \"[\") {\n\t\t\tconst decompressed = LZString.decompressFromBase64(data);\n\t\t\tif (!decompressed) return \"Bad data\";\n\t\t\tdata = decompressed;\n\t\t}\n\t\tdata = JSON.parse(data) as ItemBundle[];\n\t\tif (!Array.isArray(data)) return \"Bad data\";\n\t} catch (error) {\n\t\tconsole.warn(error);\n\t\treturn \"Bad data\";\n\t}\n\tconst C = CharacterAppearanceSelection;\n\tif (!C) {\n\t\treturn \"No character\";\n\t}\n\n\tif (includeBinds && !force && C.Appearance.some(a => isBind(a) && a.Property?.Effect?.includes(\"Lock\"))) {\n\t\treturn \"Character is bound\";\n\t}\n\n\tconst Allow = (a: Item | Asset) => isCloth(a, CharacterAppearanceSelection!.ID === 0) || (includeBinds && isBind(a));\n\n\tC.Appearance = C.Appearance.filter(a => !Allow(a));\n\tfor (const cloth of data) {\n\t\tif (C.Appearance.some(a => a.Asset.Group.Name === cloth.Group)) continue;\n\t\tconst A = Asset.find(a => a.Group.Name === cloth.Group && a.Name === cloth.Name && Allow(a));\n\t\tif (A != null) {\n\t\t\tCharacterAppearanceSetItem(C, cloth.Group, A, cloth.Color, 0, undefined, false);\n\t\t\tconst item = InventoryGet(C, cloth.Group);\n\t\t\tif (cloth.Property && item) {\n\t\t\t\tif (item.Property == null) item.Property = {};\n\t\t\t\tObject.assign(item.Property, cloth.Property);\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(`Clothing not found: `, cloth);\n\t\t}\n\t}\n\tCharacterRefresh(C);\n\treturn true;\n}\n\nlet j_WardrobeIncludeBinds = false;\n\nfunction PasteListener(ev: ClipboardEvent) {\n\tif (CurrentScreen === \"Appearance\" && CharacterAppearanceMode === \"Wardrobe\") {\n\t\tev.preventDefault();\n\t\tev.stopImmediatePropagation();\n\t\tconst data = (ev.clipboardData || (window as any).clipboardData).getData(\"text\");\n\t\tconst res = j_WardrobeImportSelectionClothes(data, j_WardrobeIncludeBinds, allowMode);\n\t\tCharacterAppearanceWardrobeText = res !== true ? `Import error: ${res}` : \"Imported!\";\n\t}\n}\n\nexport class ModuleWardrobe extends BaseModule {\n\n\tload() {\n\t\tconst { NMod } = detectOtherMods();\n\n\t\thookFunction(\"AppearanceRun\", 0, (args, next) => {\n\t\t\tnext(args);\n\t\t\tif ((CharacterAppearanceMode === \"Wardrobe\" || NMod && AppearanceMode === \"Wardrobe\") && clipboardAvailable) {\n\t\t\t\tconst Y = NMod ? 265 : 125;\n\t\t\t\tDrawButton(1457, Y, 50, 50, \"\", \"White\", j_WardrobeIncludeBinds ? \"Icons/Checked.png\" : \"\", \"Include restraints\");\n\t\t\t\tDrawButton(1534, Y, 207, 50, \"Export\", \"White\", \"\");\n\t\t\t\tDrawButton(1768, Y, 207, 50, \"Import\", \"White\", \"\");\n\t\t\t}\n\t\t});\n\n\t\thookFunction(\"AppearanceClick\", 0, (args, next) => {\n\t\t\tif ((CharacterAppearanceMode === \"Wardrobe\" || NMod && AppearanceMode === \"Wardrobe\") && clipboardAvailable) {\n\t\t\t\tconst Y = NMod ? 265 : 125;\n\t\t\t\t// Restraints toggle\n\t\t\t\tif (MouseIn(1457, Y, 50, 50)) {\n\t\t\t\t\tj_WardrobeIncludeBinds = !j_WardrobeIncludeBinds;\n\t\t\t\t}\n\t\t\t\t// Export\n\t\t\t\tif (MouseIn(1534, Y, 207, 50)) {\n\t\t\t\t\tsetTimeout(async () => {\n\t\t\t\t\t\tawait navigator.clipboard.writeText(j_WardrobeExportSelectionClothes(j_WardrobeIncludeBinds));\n\t\t\t\t\t\tCharacterAppearanceWardrobeText = \"Copied to clipboard!\";\n\t\t\t\t\t}, 0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Import\n\t\t\t\tif (MouseIn(1768, Y, 207, 50)) {\n\t\t\t\t\tsetTimeout(async () => {\n\t\t\t\t\t\tif (typeof navigator.clipboard.readText !== \"function\") {\n\t\t\t\t\t\t\tCharacterAppearanceWardrobeText = \"Please press Ctrl+V\";\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst data = await navigator.clipboard.readText();\n\t\t\t\t\t\tconst res = j_WardrobeImportSelectionClothes(data, j_WardrobeIncludeBinds, allowMode);\n\t\t\t\t\t\tCharacterAppearanceWardrobeText = res !== true ? `Import error: ${res}` : \"Imported!\";\n\t\t\t\t\t}, 0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tnext(args);\n\t\t});\n\n\t\tdocument.addEventListener(\"paste\", PasteListener);\n\t}\n\n\tunload() {\n\t\tdocument.removeEventListener(\"paste\", PasteListener);\n\t}\n}\n","import { allowMode, detectOtherMods, developmentMode, setAllowMode, setDevelopmentMode } from \"../utilsClub\";\nimport { hookFunction, patchFunction } from \"../patching\";\nimport { j_WardrobeExportSelectionClothes, j_WardrobeImportSelectionClothes } from \"./wardrobe\";\nimport { InvisibilityEarbuds } from \"./clubUtils\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { unload } from \"../main\";\nimport { modStorage } from \"./storage\";\nimport { sendQuery } from \"./messaging\";\n\nexport let antigarble = 0;\n\nclass ConsoleInterface {\n\tget isAllow(): boolean {\n\t\treturn allowMode;\n\t}\n\n\tAllowCheats(allow?: boolean) {\n\t\tif (typeof allow !== \"boolean\" && allow !== undefined) {\n\t\t\treturn false;\n\t\t}\n\t\tif (allowMode === allow)\n\t\t\treturn true;\n\t\tif (allow === undefined) {\n\t\t\tallow = !allowMode;\n\t\t}\n\t\treturn setAllowMode(allow);\n\t}\n\n\tget isDevel(): boolean {\n\t\treturn developmentMode;\n\t}\n\n\tDevel(devel?: boolean) {\n\t\tif (typeof devel !== \"boolean\" && devel !== undefined) {\n\t\t\treturn false;\n\t\t}\n\t\tif (developmentMode === devel)\n\t\t\treturn true;\n\t\tif (devel === undefined) {\n\t\t\tdevel = !developmentMode;\n\t\t}\n\t\treturn setDevelopmentMode(devel);\n\t}\n\n\tget antigarble(): number {\n\t\treturn antigarble;\n\t}\n\n\tset antigarble(value: number) {\n\t\tif (![0, 1, 2].includes(value)) {\n\t\t\tthrow new Error(\"Bad antigarble value, expected 0/1/2\");\n\t\t}\n\t\tantigarble = value;\n\t}\n\n\tj_WardrobeExportSelectionClothes(includeBinds: boolean = false): string {\n\t\treturn j_WardrobeExportSelectionClothes(includeBinds);\n\t}\n\n\tj_WardrobeImportSelectionClothes(data: string | ItemBundle[], includeBinds: boolean, force: boolean = false): string | true {\n\t\treturn j_WardrobeImportSelectionClothes(data, includeBinds, force);\n\t}\n\n\tToggleInvisibilityEarbuds(): void {\n\t\treturn InvisibilityEarbuds();\n\t}\n\n\tUnload() {\n\t\treturn unload();\n\t}\n\n\tget storage(): any {\n\t\tif (!developmentMode) {\n\t\t\treturn \"Development mode required\";\n\t\t}\n\t\treturn modStorage;\n\t}\n\n\tdevSendQuery(target: number, query: string, data: any): boolean {\n\t\tif (!developmentMode || typeof target !== \"number\" || typeof query !== \"string\")\n\t\t\treturn false;\n\n\t\tsendQuery(query as keyof BCX_queries, data, target).then(\n\t\t\tresult => {\n\t\t\t\tconsole.info(`Query ${query} to ${target} resolved:`, result);\n\t\t\t},\n\t\t\terror => {\n\t\t\t\tconsole.warn(`Query ${query} to ${target} failed:`, error);\n\t\t\t}\n\t\t);\n\n\t\treturn true;\n\t}\n}\n\nexport const consoleInterface: ConsoleInterface = Object.freeze(new ConsoleInterface());\n\nexport class ModuleConsole extends BaseModule {\n\tload() {\n\t\t(window as any).bcx = consoleInterface;\n\n\t\tconst { NMod } = detectOtherMods();\n\n\t\tpatchFunction(\"ChatRoomMessage\", NMod ? {\n\t\t\t\"A.DynamicDescription(Source).toLowerCase()\": `( bcx.isDevel ? A.Description : A.DynamicDescription(Source).toLowerCase() )`,\n\t\t\t\"G.Description.toLowerCase()\": `( bcx.isDevel ? G.Description : G.Description.toLowerCase() )`\n\t\t} : {\n\t\t\t\"Asset[A].DynamicDescription(SourceCharacter || Player).toLowerCase()\": `( bcx.isDevel ? Asset[A].Description : Asset[A].DynamicDescription(SourceCharacter || Player).toLowerCase() )`,\n\t\t\t\"AssetGroup[A].Description.toLowerCase()\": `( bcx.isDevel ? AssetGroup[A].Description : AssetGroup[A].Description.toLowerCase() )`\n\t\t});\n\n\t\tpatchFunction(\"ExtendedItemDraw\", {\n\t\t\t\"DialogFindPlayer(DialogPrefix + Option.Name)\": `( bcx.isDevel ? JSON.stringify(Option.Property.Type) : DialogFindPlayer(DialogPrefix + Option.Name) )`\n\t\t});\n\n\t\thookFunction(\"DialogDrawItemMenu\", 0, (args, next) => {\n\t\t\tif (developmentMode) {\n\t\t\t\tDialogTextDefault = (args[0] as Character).FocusGroup?.Description || \"\";\n\t\t\t}\n\t\t\treturn next(args);\n\t\t});\n\n\t\tpatchFunction(\"DialogDrawPoseMenu\", {\n\t\t\t'\"Icons/Poses/\" + PoseGroup[P].Name + \".png\"': `\"Icons/Poses/\" + PoseGroup[P].Name + \".png\", ( bcx.isDevel ? PoseGroup[P].Name : undefined )`\n\t\t});\n\n\t\thookFunction(\"DialogDrawExpressionMenu\", 0, (args, next) => {\n\t\t\tnext(args);\n\t\t\tif (developmentMode) {\n\t\t\t\tfor (let I = 0; I < DialogFacialExpressions.length; I++) {\n\t\t\t\t\tconst FE = DialogFacialExpressions[I];\n\t\t\t\t\tconst OffsetY = 185 + 100 * I;\n\n\t\t\t\t\tif (MouseIn(20, OffsetY, 90, 90)) {\n\t\t\t\t\t\tDrawText(JSON.stringify(FE.Group), 300, 950, \"White\");\n\t\t\t\t\t}\n\n\t\t\t\t\tif (I === DialogFacialExpressionsSelected) {\n\t\t\t\t\t\tfor (let j = 0; j < FE.ExpressionList.length; j++) {\n\t\t\t\t\t\t\tconst EOffsetX = 155 + 100 * (j % 3);\n\t\t\t\t\t\t\tconst EOffsetY = 185 + 100 * Math.floor(j / 3);\n\t\t\t\t\t\t\tif (MouseIn(EOffsetX, EOffsetY, 90, 90)) {\n\t\t\t\t\t\t\t\tDrawText(JSON.stringify(FE.ExpressionList[j]), 300, 950, \"White\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tDialogSelfMenuOptions.forEach(opt => {\n\t\t\tif (opt.Name === \"Pose\") {\n\t\t\t\topt.IsAvailable = () => true;\n\t\t\t\topt.Draw = function () { return DialogDrawPoseMenu(); };\n\t\t\t} else if (opt.Name === \"Expression\") {\n\t\t\t\topt.Draw = function () { return DialogDrawExpressionMenu(); };\n\t\t\t}\n\t\t});\n\n\t\thookFunction(\"SpeechGarble\", 0, (args, next) => {\n\t\t\tif (antigarble === 2) return args[1];\n\t\t\tlet res = next(args);\n\t\t\tif (typeof res === \"string\" && res !== args[1] && antigarble === 1) res += ` <> ${args[1]}`;\n\t\t\treturn res;\n\t\t});\n\t}\n\n\tunload() {\n\t\tdelete (window as any).bcx;\n\t}\n}","import { ChatRoomActionMessage, ChatRoomSendLocal, isBind } from \"../utilsClub\";\nimport { ChatroomCharacter, getAllCharactersInRoom } from \"../characters\";\nimport { hookFunction } from \"../patching\";\nimport { consoleInterface } from \"./console\";\nimport { arrayUnique, longestCommonPrefix } from \"../utils\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { firstTimeInit } from \"./storage\";\n\ninterface ICommandInfo {\n\tdescription: string | null;\n}\n\ntype CommandHandlerRaw = (args: string) => boolean;\ntype CommandHandlerParsed = (argv: string[]) => boolean;\ntype CommandAutocompleterRaw = (args: string) => string[];\ntype CommandAutocompleterParsed = (argv: string[]) => string[];\n\ninterface ICommandRaw extends ICommandInfo {\n\tparse: false;\n\tcallback: CommandHandlerRaw;\n\tautocomplete: CommandAutocompleterRaw | null;\n}\n\ninterface ICommandParsed extends ICommandInfo {\n\tparse: true;\n\tcallback: CommandHandlerParsed;\n\tautocomplete: CommandAutocompleterParsed | null;\n}\n\nconst commands: Map<string, ICommandRaw | ICommandParsed> = new Map();\n\nexport function registerCommand(name: string, description: string | null, callback: CommandHandlerRaw, autocomplete: CommandAutocompleterRaw | null = null) {\n\tname = name.toLocaleLowerCase();\n\tif (commands.has(name)) {\n\t\tthrow new Error(`Command \"${name}\" already registered!`);\n\t}\n\tcommands.set(name, {\n\t\tparse: false,\n\t\tcallback,\n\t\tautocomplete,\n\t\tdescription\n\t});\n}\n\nexport function aliasCommand(originalName: string, alias: string): void {\n\toriginalName = originalName.toLocaleLowerCase();\n\talias = alias.toLocaleLowerCase();\n\tconst original = commands.get(originalName);\n\tif (!original) {\n\t\tthrow new Error(`Command \"${originalName}\" to alias not found`);\n\t}\n\tif (original.parse) {\n\t\tcommands.set(alias, {\n\t\t\tparse: true,\n\t\t\tdescription: null,\n\t\t\tcallback: original.callback,\n\t\t\tautocomplete: original.autocomplete\n\t\t});\n\t} else {\n\t\tcommands.set(alias, {\n\t\t\tparse: false,\n\t\t\tdescription: null,\n\t\t\tcallback: original.callback,\n\t\t\tautocomplete: original.autocomplete\n\t\t});\n\t}\n}\n\nexport function registerCommandParsed(name: string, description: string | null, callback: CommandHandlerParsed, autocomplete: CommandAutocompleterParsed | null = null) {\n\tname = name.toLocaleLowerCase();\n\tif (commands.has(name)) {\n\t\tthrow new Error(`Command \"${name}\" already registered!`);\n\t}\n\tcommands.set(name, {\n\t\tparse: true,\n\t\tcallback,\n\t\tautocomplete,\n\t\tdescription\n\t});\n}\n\nfunction CommandParse(msg: string): [string, string] {\n\tmsg = msg.trimStart();\n\tconst commandMatch = /^(\\S+)(?:\\s|$)(.*)$/.exec(msg);\n\tif (!commandMatch) {\n\t\treturn [\"\", \"\"];\n\t}\n\treturn [(commandMatch[1] || \"\").toLocaleLowerCase(), commandMatch[2]];\n}\n\nfunction CommandParseArguments(args: string): string[] {\n\treturn [...args.matchAll(/\".*?(?:\"|$)|'.*?(?:'|$)|[^ ]+/g)]\n\t\t.map(a => a[0])\n\t\t.map(a => a[0] === '\"' || a[0] === \"'\" ? a.substring(1, a[a.length - 1] === a[0] ? a.length - 1 : a.length) : a);\n}\n\nfunction CommandHasEmptyArgument(args: string): boolean {\n\tconst argv = CommandParseArguments(args);\n\treturn argv.length === 0 || !args.endsWith(argv[argv.length - 1]);\n}\n\nfunction CommandQuoteArgument(arg: string): string {\n\tif (arg.startsWith(`\"`)) {\n\t\treturn `'${arg}'`;\n\t} else if (arg.startsWith(`'`)) {\n\t\treturn `\"${arg}\"`;\n\t} else if (arg.includes(\" \")) {\n\t\treturn arg.includes('\"') ? `'${arg}'` : `\"${arg}\"`;\n\t}\n\treturn arg;\n}\n\nfunction RunCommand(msg: string): boolean {\n\tconst [command, args] = CommandParse(msg);\n\n\tconst commandInfo = commands.get(command);\n\tif (!commandInfo) {\n\t\t// Command not found\n\t\tChatRoomSendLocal(\n\t\t\t`Unknown command \"${command}\"\\n` +\n\t\t\t`To see list of valid commands whisper '!help'`,\n\t\t\t15000\n\t\t);\n\t\treturn false;\n\t}\n\tif (commandInfo.parse) {\n\t\treturn commandInfo.callback(CommandParseArguments(args));\n\t} else {\n\t\treturn commandInfo.callback(args);\n\t}\n}\n\nfunction CommandAutocomplete(msg: string): string {\n\tmsg = msg.trimStart();\n\tconst [command, args] = CommandParse(msg);\n\n\tif (msg.length === command.length) {\n\t\tconst prefixes = Array.from(commands.entries()).filter(c => c[1].description !== null && c[0].startsWith(command)).map(c => c[0] + \" \");\n\t\tif (prefixes.length === 0)\n\t\t\treturn msg;\n\t\tconst best = longestCommonPrefix(prefixes);\n\t\tif (best === msg) {\n\t\t\tChatRoomSendLocal(prefixes.slice().sort().join(\"\\n\"), 10_000);\n\t\t}\n\t\treturn best;\n\t}\n\n\tconst commandInfo = commands.get(command);\n\tif (commandInfo && commandInfo.autocomplete) {\n\t\tif (commandInfo.parse) {\n\t\t\tconst argv = CommandParseArguments(args);\n\t\t\tif (CommandHasEmptyArgument(args)) {\n\t\t\t\targv.push(\"\");\n\t\t\t}\n\t\t\tconst lastOptions = commandInfo.autocomplete(argv);\n\t\t\tif (lastOptions.length > 0) {\n\t\t\t\tconst best = longestCommonPrefix(lastOptions);\n\t\t\t\tif (lastOptions.length > 1 && best === argv[argv.length - 1]) {\n\t\t\t\t\tChatRoomSendLocal(lastOptions.slice().sort().join(\"\\n\"), 10_000);\n\t\t\t\t}\n\t\t\t\targv[argv.length - 1] = best;\n\t\t\t}\n\t\t\treturn `${command} ` +\n\t\t\t\targv.map(CommandQuoteArgument).join(\" \") +\n\t\t\t\t(lastOptions.length === 1 ? \" \" : \"\");\n\t\t} else {\n\t\t\tconst possibleArgs = commandInfo.autocomplete(args);\n\t\t\tif (possibleArgs.length === 0) {\n\t\t\t\treturn msg;\n\t\t\t}\n\t\t\tconst best = longestCommonPrefix(possibleArgs);\n\t\t\tif (possibleArgs.length > 1 && best === args) {\n\t\t\t\tChatRoomSendLocal(possibleArgs.slice().sort().join(\"\\n\"), 10_000);\n\t\t\t}\n\t\t\treturn `${command} ${best}`;\n\t\t}\n\t}\n\n\treturn \"\";\n}\n\nexport function Command_selectCharacter(selector: string): ChatroomCharacter | string {\n\tconst characters = getAllCharactersInRoom();\n\tif (/^[0-9]+$/.test(selector)) {\n\t\tconst MemberNumber = Number.parseInt(selector, 10);\n\t\tconst target = characters.find(c => c.MemberNumber === MemberNumber);\n\t\tif (!target) {\n\t\t\treturn `Player #${MemberNumber} not found in the room.`;\n\t\t}\n\t\treturn target;\n\t}\n\tlet targets = characters.filter(c => c.Name === selector);\n\tif (targets.length === 0)\n\t\ttargets = characters.filter(c => c.Name.toLocaleLowerCase() === selector.toLocaleLowerCase());\n\n\tif (targets.length === 1) {\n\t\treturn targets[0];\n\t} else if (targets.length === 0) {\n\t\treturn `Player \"${selector}\" not found in the room.`;\n\t} else {\n\t\treturn `Multiple players match \"${selector}\". Please use Member Number instead.`;\n\t}\n}\n\nexport function Command_selectCharacterAutocomplete(selector: string): string[] {\n\tconst characters = getAllCharactersInRoom();\n\tif (/^[0-9]+$/.test(selector)) {\n\t\treturn characters.map(c => c.MemberNumber?.toString(10)).filter(n => n != null && n.startsWith(selector)) as string[];\n\t}\n\treturn characters.map(c => c.Name).filter(n => n.toLocaleLowerCase().startsWith(selector.toLocaleLowerCase()));\n}\n\nexport function Command_selectWornItem(character: ChatroomCharacter, selector: string): Item | string {\n\tconst items = character.Character.Appearance.filter(isBind);\n\tlet targets = items.filter(A => A.Asset.Group.Name.toLocaleLowerCase() === selector.toLocaleLowerCase());\n\tif (targets.length === 0)\n\t\ttargets = items.filter(A => A.Asset.Group.Description.toLocaleLowerCase() === selector.toLocaleLowerCase());\n\tif (targets.length === 0)\n\t\ttargets = items.filter(A => A.Asset.Name.toLocaleLowerCase() === selector.toLocaleLowerCase());\n\tif (targets.length === 0)\n\t\ttargets = items.filter(A => A.Asset.Description.toLocaleLowerCase() === selector.toLocaleLowerCase());\n\n\tif (targets.length === 1) {\n\t\treturn targets[0];\n\t} else if (targets.length === 0) {\n\t\treturn `Item \"${selector}\" not found on character ${character}.`;\n\t} else {\n\t\treturn `Multiple items match, please use group name instead. (eg. arms)`;\n\t}\n}\n\nexport function Command_selectWornItemAutocomplete(character: ChatroomCharacter, selector: string): string[] {\n\tconst items = character.Character.Appearance.filter(isBind);\n\n\tlet possible = arrayUnique(\n\t\titems.map(A => A.Asset.Group.Description)\n\t\t\t.concat(items.map(A => A.Asset.Description))\n\t).filter(i => i.toLocaleLowerCase().startsWith(selector.toLocaleLowerCase()));\n\n\tif (possible.length === 0) {\n\t\tpossible = arrayUnique(\n\t\t\titems.map(A => A.Asset.Group.Name)\n\t\t\t\t.concat(items.map(A => A.Asset.Name))\n\t\t).filter(i => i.toLocaleLowerCase().startsWith(selector.toLocaleLowerCase()));\n\t}\n\n\treturn possible;\n}\n\nexport class ModuleCommands extends BaseModule {\n\tload() {\n\t\thookFunction(\"ChatRoomSendChat\", 10, (args, next) => {\n\t\t\tconst chat = document.getElementById(\"InputChat\") as HTMLTextAreaElement | null;\n\t\t\tif (chat && !firstTimeInit) {\n\t\t\t\tconst msg = chat.value.trim();\n\t\t\t\tif (msg.startsWith(\"..\")) {\n\t\t\t\t\tchat.value = msg.substr(1);\n\t\t\t\t} else if (msg.startsWith(\".\")) {\n\t\t\t\t\tif (RunCommand(msg.substr(1))) {\n\t\t\t\t\t\tchat.value = \"\";\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn next(args);\n\t\t});\n\n\t\thookFunction(\"ChatRoomKeyDown\", 10, (args, next) => {\n\t\t\tconst chat = document.getElementById(\"InputChat\") as HTMLTextAreaElement | null;\n\t\t\t// Tab for command completion\n\t\t\tif (KeyPress === 9 && chat && chat.value.startsWith(\".\") && !chat.value.startsWith(\"..\") && !firstTimeInit) {\n\t\t\t\tconst e = args[0] as KeyboardEvent ?? event;\n\t\t\t\te?.preventDefault();\n\n\t\t\t\tchat.value = \".\" + CommandAutocomplete(chat.value.substr(1));\n\t\t\t} else {\n\t\t\t\treturn next(args);\n\t\t\t}\n\t\t});\n\n\t\tregisterCommand(\"help\", \"- display this help [alias: . ]\", () => {\n\t\t\tChatRoomSendLocal(\n\t\t\t\t`Available commands:\\n` +\n\t\t\t\tArray.from(commands.entries())\n\t\t\t\t\t.filter(c => c[1].description !== null)\n\t\t\t\t\t.map(c => `.${c[0]}` + (c[1].description ? ` ${c[1].description}` : \"\"))\n\t\t\t\t\t.sort()\n\t\t\t\t\t.join(\"\\n\")\n\t\t\t);\n\t\t\treturn true;\n\t\t});\n\t\taliasCommand(\"help\", \"\");\n\n\t\tregisterCommand(\"action\", \"- send custom (action) [alias: .a ]\", (msg) => {\n\t\t\tChatRoomActionMessage(msg);\n\t\t\treturn true;\n\t\t});\n\t\taliasCommand(\"action\", \"a\");\n\n\t\tconst ANTIGARBLE_LEVELS: Record<string, number> = {\n\t\t\t\"0\": 0,\n\t\t\t\"1\": 1,\n\t\t\t\"2\": 2,\n\t\t\t\"normal\": 0,\n\t\t\t\"both\": 1,\n\t\t\t\"ungarbled\": 2\n\t\t};\n\n\t\tconst ANTIGARBLE_LEVEL_NAMES: string[] = Object.keys(ANTIGARBLE_LEVELS).filter(k => k.length > 1);\n\n\t\tregisterCommand(\"antigarble\", \"<level> - set garble prevention to show [normal|both|ungarbled] messages (only affects received messages!)\", value => {\n\t\t\tconst val = ANTIGARBLE_LEVELS[value || \"\"];\n\t\t\tif (val !== undefined) {\n\t\t\t\tconsoleInterface.antigarble = val;\n\t\t\t\tChatRoomSendLocal(`Antigarble set to ${ANTIGARBLE_LEVEL_NAMES[val]}`);\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tChatRoomSendLocal(`Invalid antigarble level; use ${ANTIGARBLE_LEVEL_NAMES.join(\"/\")}`);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, value => {\n\t\t\treturn ANTIGARBLE_LEVEL_NAMES.filter(k => k.length > 1 && k.startsWith(value));\n\t\t});\n\t}\n\n\tunload() {\n\t\tcommands.clear();\n\t}\n}\n","import { Command_selectCharacter, Command_selectCharacterAutocomplete, Command_selectWornItem, Command_selectWornItemAutocomplete, registerCommandParsed } from \"./commands\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { ChatRoomSendLocal } from \"../utilsClub\";\n\nexport function InvisibilityEarbuds() {\n\tif (InventoryGet(Player, \"ItemEars\")?.Asset.Name === \"BluetoothEarbuds\") {\n\t\tInventoryRemove(Player, \"ItemEars\");\n\t} else {\n\t\tconst asset = Asset.find(A => A.Name === \"BluetoothEarbuds\");\n\t\tif (!asset) return;\n\t\tPlayer.Appearance = Player.Appearance.filter(A => A.Asset.Group.Name !== \"ItemEars\");\n\t\tPlayer.Appearance.push({\n\t\t\tAsset: asset,\n\t\t\tColor: \"Default\",\n\t\t\tDifficulty: -100,\n\t\t\tProperty: {\n\t\t\t\tType: \"Light\",\n\t\t\t\tEffect: [],\n\t\t\t\tHide: AssetGroup.map(A => A.Name).filter(A => A !== \"ItemEars\")\n\t\t\t}\n\t\t});\n\t\tCharacterRefresh(Player);\n\t}\n\tChatRoomCharacterUpdate(Player);\n}\n\nexport class ModuleClubUtils extends BaseModule {\n\tload() {\n\t\tregisterCommandParsed(\"colour\", \"<source> <item> <target> - Copies color of certain item from source character to target character\",\n\t\t\t(argv) => {\n\t\t\t\tif (argv.length !== 3) {\n\t\t\t\t\tChatRoomSendLocal(`Expected three arguments: <source> <item> <target>`);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst source = Command_selectCharacter(argv[0]);\n\t\t\t\tif (typeof source === \"string\") {\n\t\t\t\t\tChatRoomSendLocal(source);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst target = Command_selectCharacter(argv[2]);\n\t\t\t\tif (typeof target === \"string\") {\n\t\t\t\t\tChatRoomSendLocal(target);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst item = Command_selectWornItem(source, argv[1]);\n\t\t\t\tif (typeof item === \"string\") {\n\t\t\t\t\tChatRoomSendLocal(item);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst targetItem = target.Character.Appearance.find(A => A.Asset === item.Asset);\n\t\t\t\tif (!targetItem) {\n\t\t\t\t\tChatRoomSendLocal(`Target must be wearing the same item`);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\ttargetItem.Color = Array.isArray(item.Color) ? item.Color.slice() : item.Color;\n\t\t\t\tCharacterRefresh(target.Character);\n\t\t\t\tChatRoomCharacterUpdate(target.Character);\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\t(argv) => {\n\t\t\t\tif (argv.length === 1) {\n\t\t\t\t\treturn Command_selectCharacterAutocomplete(argv[0]);\n\t\t\t\t} else if (argv.length === 2) {\n\t\t\t\t\tconst source = Command_selectCharacter(argv[0]);\n\t\t\t\t\tif (typeof source !== \"string\") {\n\t\t\t\t\t\treturn Command_selectWornItemAutocomplete(source, argv[1]);\n\t\t\t\t\t}\n\t\t\t\t} else if (argv.length === 3) {\n\t\t\t\t\treturn Command_selectCharacterAutocomplete(argv[2]);\n\t\t\t\t}\n\t\t\t\treturn [];\n\t\t\t}\n\t\t);\n\t\tregisterCommandParsed(\"allowactivities\", \"<character> <item> - Modifies item to not block activities\",\n\t\t\t(argv) => {\n\t\t\t\tif (argv.length !== 2) {\n\t\t\t\t\tChatRoomSendLocal(`Expected two arguments: <charcater> <item>`);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst char = Command_selectCharacter(argv[0]);\n\t\t\t\tif (typeof char === \"string\") {\n\t\t\t\t\tChatRoomSendLocal(char);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst item = Command_selectWornItem(char, argv[1]);\n\t\t\t\tif (typeof item === \"string\") {\n\t\t\t\t\tChatRoomSendLocal(item);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!item.Property) {\n\t\t\t\t\titem.Property = {};\n\t\t\t\t}\n\t\t\t\titem.Property.AllowActivityOn = AssetGroup.map(A => A.Name);\n\t\t\t\tCharacterRefresh(char.Character);\n\t\t\t\tChatRoomCharacterUpdate(char.Character);\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\t(argv) => {\n\t\t\t\tif (argv.length === 1) {\n\t\t\t\t\treturn Command_selectCharacterAutocomplete(argv[0]);\n\t\t\t\t} else if (argv.length === 2) {\n\t\t\t\t\tconst source = Command_selectCharacter(argv[0]);\n\t\t\t\t\tif (typeof source !== \"string\") {\n\t\t\t\t\t\treturn Command_selectWornItemAutocomplete(source, argv[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn [];\n\t\t\t}\n\t\t);\n\t}\n}\n","import { VERSION, VERSION_CHECK_BOT } from \"../config\";\nimport { hiddenBeepHandlers, sendHiddenBeep } from \"./messaging\";\nimport { BaseModule } from \"./_BaseModule\";\nimport { isObject } from \"../utils\";\n\nlet nextCheckTimer: number | null = null;\n\nfunction sendVersionCheckBeep(): void {\n\tif (nextCheckTimer !== null) {\n\t\tclearTimeout(nextCheckTimer);\n\t\tnextCheckTimer = null;\n\t}\n\n\tsendHiddenBeep(\"versionCheck\", {\n\t\tversion: VERSION,\n\t\tUA: window.navigator.userAgent\n\t}, VERSION_CHECK_BOT, true);\n\n\t// Set check retry timer to 5 minutes\n\tnextCheckTimer = setTimeout(sendVersionCheckBeep, 5 * 60_000);\n}\n\nexport class ModuleVersionCheck extends BaseModule {\n\tload() {\n\t\thiddenBeepHandlers.set(\"versionResponse\", (sender, message: BCX_beep_versionResponse) => {\n\t\t\tif (sender !== VERSION_CHECK_BOT) {\n\t\t\t\tconsole.warn(`BCX: got versionResponse from unexpected sender ${sender}, ignoring`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!isObject(message) || typeof message.status !== \"string\") {\n\t\t\t\tconsole.warn(`BCX: bad versionResponse`, message);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Got valid version response, reset timer to 15 minutes\n\t\t\tif (nextCheckTimer !== null) {\n\t\t\t\tclearTimeout(nextCheckTimer);\n\t\t\t}\n\t\t\tnextCheckTimer = setTimeout(sendVersionCheckBeep, 15 * 60_000);\n\n\t\t\tif (message.status === \"current\") {\n\t\t\t\treturn;\n\t\t\t} else if (message.status === \"newAvailable\") {\n\t\t\t\t// TODO\n\t\t\t} else if (message.status === \"deprecated\") {\n\t\t\t\t// TODO\n\t\t\t} else if (message.status === \"unsupported\") {\n\t\t\t\t// TODO\n\t\t\t} else {\n\t\t\t\tconsole.warn(`BCX: bad versionResponse status \"${message.status}\"`);\n\t\t\t}\n\t\t});\n\t}\n\n\trun() {\n\t\tsendVersionCheckBeep();\n\t}\n\n\tunload() {\n\t\tif (nextCheckTimer !== null) {\n\t\t\tclearTimeout(nextCheckTimer);\n\t\t\tnextCheckTimer = null;\n\t\t}\n\t}\n}\n","import { registerModule } from \"./moduleManager\";\n\nimport { ModuleAuthority } from \"./modules/authority\";\nimport { ModuleChatroom } from \"./modules/chatroom\";\nimport { ModuleClubUtils } from \"./modules/clubUtils\";\nimport { ModuleCommands } from \"./modules/commands\";\nimport { ModuleConsole } from \"./modules/console\";\nimport { ModuleCurses } from \"./modules/curses\";\nimport { ModuleGUI } from \"./modules/gui\";\nimport { ModuleLog } from \"./modules/log\";\nimport { ModuleMessaging } from \"./modules/messaging\";\nimport { ModuleMiscPatches } from \"./modules/miscPatches\";\nimport { ModulePresets } from \"./modules/presets\";\nimport { ModuleStorage } from \"./modules/storage\";\nimport { ModuleVersionCheck } from \"./modules/versionCheck\";\nimport { ModuleWardrobe } from \"./modules/wardrobe\";\n\nregisterModule(new ModuleAuthority());\nregisterModule(new ModuleChatroom());\nregisterModule(new ModuleClubUtils());\nregisterModule(new ModuleCommands());\nregisterModule(new ModuleConsole());\nregisterModule(new ModuleCurses());\nregisterModule(new ModuleGUI());\nregisterModule(new ModuleLog());\nregisterModule(new ModuleMessaging());\nregisterModule(new ModuleMiscPatches());\nregisterModule(new ModulePresets());\nregisterModule(new ModuleStorage());\nregisterModule(new ModuleVersionCheck());\nregisterModule(new ModuleWardrobe());\n","import { InfoBeep } from \"./utilsClub\";\nimport { hookFunction } from \"./patching\";\nimport { init, loginInit } from \"./main\";\n\nimport \"./modules\";\n\nasync function initWait() {\n\tif (CurrentScreen == null || CurrentScreen === \"Login\") {\n\t\thookFunction(\"LoginResponse\", 0, (args, next) => {\n\t\t\tnext(args);\n\t\t\tloginInit(args[0]);\n\t\t});\n\t\tInfoBeep(`BCX Ready!`);\n\t} else {\n\t\tinit();\n\t}\n}\n\ninitWait();\n"],"names":["PER_PAGE_COUNT"],"mappings":"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"}